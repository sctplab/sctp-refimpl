cscope 15 $HOME/Rserpool/enrp-server/src               0000307520
	@asap.c

37 
	~<¡ršg.h
>

39 
	~"a§p.h
"

40 
	~"·¿m‘”s.h
"

41 
	~"£rv”poŞ.h
"

42 
	~"»gi¡¿r£rv”.h
"

43 
	~"ut.h
"

44 
	~"’½.h
"

45 
	~"debug.h
"

48 
	$£ndA§pAÂounûMsg
(*
buf
, 
size_t
 
Ën
) {

49 
	`logDebug
("not implemented yet");

52 
	}
}

55 
	$£ndA§pMsg
(*
buf
, 
size_t
 
Ën
, 
sùp_assoc_t
 
assocId
, 
ªnounûm’t
) {

56 
sùp_¢drcvšfo
 
sšfo
;

57 
£ÁL’
 = 0;

59 ià(!
buf
) {

60 
	`logDebug
("buf is NULL");

64 ià(
Ën
 < 8) {

65 
	`logDebug
("abÜtšg,†’ i toØsm®l: %d", (è
Ën
);

69 ià(
ªnounûm’t
) {

70 
	`logDebug
("sending‡s‡nnouncement");

71  
	`£ndA§pAÂounûMsg
(
buf
, 
Ën
);

80 
	`mem£t
(&
sšfo
, 0, (sinfo));

81 
sšfo
.
sšfo_assoc_id
 = 
assocId
;

82 
sšfo
.
sšfo_µid
 = 
	`htÚl
(
ASAP_SCTP_PPID
);

84 ià((
£ÁL’
 = 
	`sùp_£nd
(
’½SùpFd
, (*)
buf
, 
Ën
, &
sšfo
, 0)) < 0) {

85 
	`logDebug
("sùp_£ndØ%d faed", 
assocId
);

86 
	`³¼Ü
("sctp_send");

90 
	`logDebug
("£Á msg vŸ‡ssocid %d. sùp_£nd„‘uºed: %d", 
assocId
, 
£ÁL’
);

92 
	}
}

99 
	$hªdËA§pRegi¡¿tiÚ
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

100 
a§pRegi¡¿tiÚ
 *
msg
;

101 
·¿mPoŞHªdË
 *
phªdË
;

102 
·¿mPoŞEËm’t
 *
pEËm
;

103 
PoŞEËm’t
 
–em’t
;

104 
S”v”PoŞ
 
poŞ
;

105 *
off£t
;

106 
size_t
 
bufSize
;

107 
poŞHªdË
[
POOLHANDLE_SIZE
 + 1];

108 
ušt16
 
Ëngth
;

109 
poŞC»©ed
 = 0;

111 
–em’t
 = 
NULL
;

112 
	`mem£t
(
poŞHªdË
, 0, (poolHandle));

113 
msg
 = (
a§pRegi¡¿tiÚ
 *è
buf
;

114 
Ëngth
 = 
	`Áohs
(
msg
->length);

115 
bufSize
 = 
Ëngth
 - (
a§pRegi¡¿tiÚ
);

116 
off£t
 = (*è
msg
 + (
a§pRegi¡¿tiÚ
);

118 ià(
	`checkTLV
(
off£t
, 
bufSize
è=ğ
PARAM_POOL_HANDLE
) {

119 
phªdË
 = (
·¿mPoŞHªdË
 *è
off£t
;

120 
Ëngth
 = 
	`Áohs
(
phªdË
->
hdr
.length);

121 
	`¡ºıy
(
poŞHªdË
, ((*è
phªdË
 + 4), 
Ëngth
 - 4);

122 ià(
Ëngth
 % 4 != 0)

123 
Ëngth
 += 4 - (length % 4);

125 
off£t
 +ğ
Ëngth
;

126 
bufSize
 -ğ
Ëngth
;

127 
	`logDebug
("poŞHªdË: '%s'", 
poŞHªdË
);

129 
	`logDebug
("malformed…acket,…oolhandle…arameter");

133 ià(
	`checkTLV
(
off£t
, 
bufSize
è=ğ
PARAM_POOL_ELEMENT
) {

134 
pEËm
 = (
·¿mPoŞEËm’t
 *è
off£t
;

135 
Ëngth
 = 
	`Áohs
(
pEËm
->
hdr
.length);

136 
–em’t
 = 
	`£ndBufãrToPoŞEËm’t
(
off£t
, &
bufSize
);

137 
–em’t
->
³A§pAssocId
 = 
assocId
;

138 ià(
bufSize
 > 0) {

139 
	`logDebug
("malformed…acket,…oolƒlement…arameter");

143 ià(
–em’t
 =ğ
NULL
) {

144 
	`logDebug
("malformed…acket, unparseable…oolƒlement…arameter");

148 
	`logDebug
("malformed…acket,…oolƒlement…arameter");

152 ià((
poŞ
 = 
	`£rv”PoŞLi¡G‘PoŞ
(
poŞHªdË
)è=ğ
NULL
) {

153 
poŞ
 = 
	`£rv”PoŞNew
(
poŞHªdË
);

154 
poŞC»©ed
 = 1;

155 
	`£rv”PoŞLi¡AddPoŞ
(
poŞ
);

158 ià(!
	`pŞicyCheck
(
poŞ
->
¥PŞicy
, 
–em’t
)) {

159 
	`logDebug
("pool…olicy does‚ot matchƒlement…olicy");

161 ià(
poŞC»©ed
) {

162 
	`£rv”PoŞLi¡RemovePoŞ
(
poŞ
->
¥HªdË
);

163 
	`£rv”PoŞD–‘e
(
poŞ
);

170 
	`£rv”PoŞAddPoŞEËm’t
(
poŞ
, 
–em’t
);

171 
	`»gi¡¿rS”v”AddPoŞEËm’t
(
this
, 
–em’t
);

173 
	`£ndEÄpHªdËUpd©e
(
poŞ
, 
–em’t
, 
ENRP_UPDATE_ACTION_ADD_PE
);

175 
	`£ndA§pRegi¡¿tiÚRe¥Ú£
(
assocId
, 0, 
poŞ
, 
–em’t
->
³Id’tif›r
);

182 
	}
}

189 
	$hªdËA§pD”egi¡¿tiÚ
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

190 
a§pD”egi¡¿tiÚ
 *
msg
;

191 
·¿mPoŞHªdË
 *
phªdË
;

192 
·¿mPeId’tif›r
 *
³Id’t
;

193 
PoŞEËm’t
 
–em’t
 = 
NULL
;

194 
ušt32
 
³Id
 = 0;

195 
S”v”PoŞ
 
poŞ
 = 
NULL
;

196 
Regi¡¿rS”v”
 
»gi¡¿r
 = 
NULL
;

197 *
off£t
;

198 
size_t
 
bufSize
;

199 
poŞHªdË
[
POOLHANDLE_SIZE
 + 1];

200 
Ëngth
 = 0;

202 
msg
 = (
a§pD”egi¡¿tiÚ
 *è
buf
;

203 
	`mem£t
(
poŞHªdË
, 0, (poolHandle));

204 
Ëngth
 = 
	`Áohs
(
msg
->length);

206 
bufSize
 = 
Ëngth
 - (
a§pRegi¡¿tiÚ
);

207 
off£t
 = (*è
msg
 + (
a§pRegi¡¿tiÚ
);

209 ià(
	`checkTLV
(
off£t
, 
bufSize
è=ğ
PARAM_POOL_HANDLE
) {

210 
phªdË
 = (
·¿mPoŞHªdË
 *è
off£t
;

211 
Ëngth
 = 
	`Áohs
(
phªdË
->
hdr
.length);

212 
	`¡ºıy
(
poŞHªdË
, ((*è
phªdË
 + 4), 
Ëngth
 - 4);

213 ià(
Ëngth
 % 4 != 0)

214 
Ëngth
 += 4 - (length % 4);

215 
off£t
 +ğ
Ëngth
;

216 
bufSize
 -ğ
Ëngth
;

217 
	`logDebug
("poŞHªdË: '%s'", 
poŞHªdË
);

218 
poŞ
 = 
	`£rv”PoŞLi¡G‘PoŞ
(
poŞHªdË
);

220 ià(
poŞ
 =ğ
NULL
) {

221 
	`logDebug
("unknown…oolHandle,‡borting deregistration");

226 ià(
	`checkTLV
(
off£t
, 
bufSize
è=ğ
PARAM_PE_IDENTIFIER
) {

227 
³Id’t
 = (
·¿mPeId’tif›r
 *è
off£t
;

228 
³Id
 = 
	`Áohl
(
³Id’t
->
³Id’tif›r
);

229 
–em’t
 = 
	`£rv”PoŞG‘PoŞEËm’tById
(
poŞ
, 
³Id
);

231 ià(
–em’t
 =ğ
NULL
) {

232 
	`logDebug
("unknowÀpoŞƒËm’ˆ0x%08x,‡bÜtšg d”egi¡¿tiÚ", 
³Id
);

238 
»gi¡¿r
 = (
Regi¡¿rS”v”
è
–em’t
->
³Regi¡¿rS”v”
;

240 ià(
»gi¡¿r
 !ğ
this
) {

241 
	`logDebug
("poŞƒËm’ˆi owÃd by 0x%08x,‡bÜtšg d”egi¡¿tiÚ‡‹m±", 
»gi¡¿r
->
rsId’tif›r
);

245 
	`»gi¡¿rS”v”RemovePoŞEËm’t
(
»gi¡¿r
, 
–em’t
);

246 
	`£rv”PoŞRemovePoŞEËm’t
(
poŞ
, 
³Id
);

248 
	`£ndEÄpHªdËUpd©e
(
poŞ
, 
–em’t
, 
ENRP_UPDATE_ACTION_DEL_PE
);

249 
	`£ndA§pD”egi¡¿tiÚRe¥Ú£
(
assocId
, 
poŞ
, 
³Id
);

258 
	}
}

264 
size_t


265 
	$š™A§pRegi¡¿tiÚRe¥Ú£
(
a§pRegi¡¿tiÚRe¥Ú£
 *
msg
, 
»jeùFÏg
) {

266 
msg
->
ty³
 = 
ASAP_REGISTRATION_RESPONSE
;

267 
msg
->
æags
 = (
»jeùFÏg
 == 1) ? 0x1 : 0x0;

268 
msg
->
Ëngth
 = 
	`htÚs
(4);

271 
	}
}

274 
	$£ndA§pRegi¡¿tiÚRe¥Ú£
(
sùp_assoc_t
 
assocId
, 
»jeùFÏg
, 
S”v”PoŞ
 
poŞ
, 
ušt32
 
³Id’tif›r
) {

275 
a§pRegi¡¿tiÚRe¥Ú£
 *
msg
;

276 
·¿mPoŞHªdË
 *
pHªdË
;

277 
·¿mPeId’tif›r
 *
³Id’t
;

278 
buf
[
BUFFER_SIZE
];

279 *
off£t
;

280 
Ëngth
 = 0;

281 
msgL’
 = 0;

282 
»t
 = 0;

284 ià(
poŞ
 =ğ
NULL
) {

285 
	`logDebug
("pool is NULL");

289 
	`mem£t
(
buf
, 0, (buf));

290 
off£t
 = 
buf
;

292 
msg
 = (
a§pRegi¡¿tiÚRe¥Ú£
 *è
buf
;

293 
Ëngth
 = 
	`š™A§pRegi¡¿tiÚRe¥Ú£
(
msg
, 
»jeùFÏg
);

294 
off£t
 +ğ(
a§pRegi¡¿tiÚRe¥Ú£
);

296 
pHªdË
 = (
·¿mPoŞHªdË
 *è
off£t
;

297 
Ëngth
 +ğ
	`š™P¬amPoŞHªdË
(
pHªdË
, 
poŞ
->
¥HªdË
);

299 
³Id’t
 = (
·¿mPeId’tif›r
 *è
off£t
;

300 
Ëngth
 +ğ
	`š™P¬amPeId’tif›r
(
³Id’t
, 
³Id’tif›r
);

302 
msgL’
 = 
off£t
 - 
buf
;

303 
msg
->
Ëngth
 = 
	`htÚs
(
msgL’
);

305 
	`´štBuf
(
buf
, 
msgL’
, "asap„egistration„esponse send buffer");

307 
»t
 = 
	`£ndA§pMsg
(
buf
, 
msgL’
, 
assocId
, 0);

308 
	`logDebug
("sent‡sap„egistration„esponse");

310  (
»t
 =ğ()
msgL’
) ? 1 : -1;

311 
	}
}

317 
size_t


318 
	$š™A§pD”egi¡¿tiÚRe¥Ú£
(
a§pD”egi¡¿tiÚRe¥Ú£
 *
msg
) {

319 
msg
->
ty³
 = 
ASAP_DEREGISTRATION_RESPONSE
;

320 
msg
->
æags
 = 0;

321 
msg
->
Ëngth
 = 
	`htÚs
(4);

324 
	}
}

327 
	$£ndA§pD”egi¡¿tiÚRe¥Ú£
(
sùp_assoc_t
 
assocId
, 
S”v”PoŞ
 
poŞ
, 
ušt32
 
³Id’tif›r
) {

328 
a§pD”egi¡¿tiÚRe¥Ú£
 *
msg
;

329 
·¿mPoŞHªdË
 *
pHªdË
;

330 
·¿mPeId’tif›r
 *
³Id’t
;

331 
buf
[
BUFFER_SIZE
];

332 *
off£t
;

333 
Ëngth
 = 0;

334 
msgL’
 = 0;

335 
»t
 = 0;

337 
	`mem£t
(
buf
, 0, (buf));

338 
off£t
 = 
buf
;

340 
msg
 = (
a§pD”egi¡¿tiÚRe¥Ú£
 *è
buf
;

341 
Ëngth
 = 
	`š™A§pD”egi¡¿tiÚRe¥Ú£
(
msg
);

342 
off£t
 +ğ(
a§pD”egi¡¿tiÚRe¥Ú£
);

344 
pHªdË
 = (
·¿mPoŞHªdË
 *è
off£t
;

345 
Ëngth
 +ğ
	`š™P¬amPoŞHªdË
(
pHªdË
, 
poŞ
->
¥HªdË
);

347 
³Id’t
 = (
·¿mPeId’tif›r
 *è
off£t
;

348 
Ëngth
 +ğ
	`š™P¬amPeId’tif›r
(
³Id’t
, 
³Id’tif›r
);

350 
msgL’
 = 
off£t
 - 
buf
;

351 
msg
->
Ëngth
 = 
	`htÚs
(
msgL’
);

353 
	`´štBuf
(
buf
, 
msgL’
, "asap„egistration„esponse send buffer");

355 
»t
 = 
	`£ndA§pMsg
(
buf
, 
msgL’
, 
assocId
, 0);

356 
	`logDebug
("sent‡sap„egistration„esponse");

358  (
»t
 =ğ()
msgL’
) ? 1 : -1;

359 
	}
}

366 
	$hªdËA§pHªdËResŞutiÚ
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

367 
	`logDebug
("not implemented yet");

370 
	}
}

376 
size_t


377 
	$š™A§pHªdËResŞutiÚRe¥Ú£
(
a§pHªdËResŞutiÚRe¥Ú£
 *
msg
, 
acû±Upd©esFÏg
) {

378 
msg
->
ty³
 = 
ASAP_HANDLE_RESOLUTION_RESPONSE
;

379 
msg
->
æags
 = (
acû±Upd©esFÏg
 == 1) ? 0x1 : 0x0;

380 
msg
->
Ëngth
 = 
	`htÚs
(4);

383 
	}
}

386 
	$£ndA§pHªdËResŞutiÚRe¥Ú£
(
acû±Upd©esFÏg
, 
sùp_assoc_t
 
assocId
) {

387 
a§pHªdËResŞutiÚRe¥Ú£
 *
msg
;

388 
buf
[
BUFFER_SIZE
];

389 
Ëngth
 = 0;

390 
»t
 = 0;

391 
msgL’
 = 0;

392 *
off£t
;

394 
	`mem£t
(
buf
, 0, (buf));

395 
msg
 = (
a§pHªdËResŞutiÚRe¥Ú£
 *è
buf
;

396 
Ëngth
 = 
	`š™A§pHªdËResŞutiÚRe¥Ú£
(
msg
, 
acû±Upd©esFÏg
);

397 
off£t
 = (*è
buf
;

399 
msgL’
 = 
off£t
 - 
buf
;

400 
msg
->
Ëngth
 = 
	`htÚs
(
msgL’
);

402 
»t
 = 
	`£ndA§pMsg
(
buf
, 
msgL’
, 
assocId
, 0);

403 
	`logDebug
("sent‡sap handle„esolution„esponse");

405  (
»t
 =ğ()
msgL’
) ? 1 : -1;

406 
	}
}

412 
size_t


413 
	$š™A§pEndpoštK“pAlive
(
a§pEndpoštK“pAlive
 *
msg
, 
ušt32
 
£rv”Id
, 
homeFÏg
) {

414 
msg
->
ty³
 = 
ASAP_ENDPOINT_KEEP_ALIVE
;

415 
msg
->
æags
 = (
homeFÏg
 == 1) ? 0x1 : 0x0;

416 
msg
->
Ëngth
 = 
	`htÚs
(8);

417 
msg
->
£rv”Id
 = 
	`htÚl
(serverId);

420 
	}
}

423 
	$£ndA§pEndpoštK“pAlive
(
PoŞEËm’t
 
–em’t
, 
homeFÏg
) {

424 
a§pEndpoštK“pAlive
 *
msg
;

425 
·¿mPoŞHªdË
 *
pHªdË
;

426 
S”v”PoŞ
 
poŞ
;

427 *
off£t
;

428 
buf
[
BUFFER_SIZE
];

429 
Ëngth
 = 0;

430 
»t
 = 0;

431 
msgL’
 = 0;

433 ià(
–em’t
 =ğ
NULL
) {

434 
	`logDebug
("element is NULL");

438 
poŞ
 = (
S”v”PoŞ
è
–em’t
->
³S”v”PoŞ
;

440 ià(
poŞ
 =ğ
NULL
) {

441 
	`logDebug
("pool is NULL");

445 
	`mem£t
(
buf
, 0, (buf));

446 
off£t
 = 
buf
;

447 
msg
 = (
a§pEndpoštK“pAlive
 *è
buf
;

448 
Ëngth
 = 
	`š™A§pEndpoštK“pAlive
(
msg
, 
ownId
, 
homeFÏg
);

449 
off£t
 +ğ
Ëngth
;

451 
pHªdË
 = (
·¿mPoŞHªdË
 *è
buf
;

452 
Ëngth
 = 
	`š™P¬amPoŞHªdË
(
pHªdË
, 
poŞ
->
¥HªdË
);

453 
off£t
 +ğ
Ëngth
;

455 
msgL’
 = 
off£t
 - 
buf
;

456 
msg
->
Ëngth
 = 
	`htÚs
(
msgL’
);

458 
»t
 = 
	`£ndA§pMsg
(
buf
, 
msgL’
, 
–em’t
->
³A§pAssocId
, 0);

459 
	`logDebug
("sent‡sapƒndpoint keep‡live");

461  (
»t
 =ğ(è
msgL’
) ? 1 : -1;

462 
	}
}

468 
	$hªdËA§pEndpoštK“pAliveAck
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

470 
	}
}

477 
	$hªdËA§pEndpoštUÄ—chabË
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

478 
	`logDebug
("not implemented yet");

481 
	}
}

487 
size_t


488 
	$š™A§pS”v”AÂounû
(
a§pS”v”AÂounû
 *
msg
, 
ušt32
 
£rv”Id
) {

489 
msg
->
ty³
 = 
ASAP_SERVER_ANNOUNCE
;

490 
msg
->
æags
 = 0;

491 
msg
->
Ëngth
 = 
	`htÚs
(8);

492 
msg
->
£rv”Id
 = 
	`htÚl
(serverId);

495 
	}
}

498 
	$£ndA§pS”v”AÂounû
() {

499 
a§pS”v”AÂounû
 *
msg
;

500 
buf
[
BUFFER_SIZE
];

501 *
off£t
;

502 
Ëngth
 = 0;

503 
size_t
 
msgL’
, 
£ÁL’
;

505 
	`mem£t
(
buf
, 0, (buf));

506 
off£t
 = (*è&
buf
;

507 
msg
 = (
a§pS”v”AÂounû
 *è
buf
;

509 
	`š™A§pS”v”AÂounû
(
msg
, 
ownId
);

510 
off£t
 +ğ(*
msg
);

512 
Ëngth
 = 
	`Œª¥ÜtAdd»s£sToS’dBufãr
(
off£t
, 
this
->
rsEÄpAddr
,his->
rsEÄpPÜt
, 
TRANSPORT_USE_DATA_ONLY
, 
IPPROTO_SCTP
);

513 
	`logDebug
("Ëngth oàŒª¥Üˆadd»s ·¿m‘” i %d", 
Ëngth
);

515 ià(
Ëngth
 == -1) {

516 
	`logDebug
("addresso buffer conversion failed,‡nyransport information");

519 
off£t
 +ğ
Ëngth
;

520 
msgL’
 = 
off£t
 - 
buf
;

521 
msg
->
Ëngth
 = 
	`htÚs
(
msgL’
);

524 
	`´štBuf
(
buf
, 
msgL’
, "asap server‡nnounce send buffer");

526 
£ÁL’
 = 
	`£ndA§pMsg
(
buf
, 
Ëngth
, 0, 1);

527 
	`logDebug
("sent‡sap server‡nnounce");

529  (
£ÁL’
 =ğ
msgL’
) ? 1 : 0;

530 
	}
}

536 
size_t


537 
	$š™A§pE¼Ü
(
a§pE¼Ü
 *
msg
) {

538 
msg
->
ty³
 = 
ASAP_ERROR
;

539 
msg
->
æags
 = 0;

540 
msg
->
Ëngth
 = 
	`htÚs
(4);

543 
	}
}

546 
	$£ndA§pE¼Ü
() {

547 
	`logDebug
("not implemented yet");

550 
	}
}

553 
	$hªdËA§pE¼Ü
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

554 
	`logDebug
("not implemented yet");

557 
	}
}

	@asap.h

36 #iâdeà
_ASAP_H


37 
	#_ASAP_H
 1

	)

39 
	~"·¿m‘”s.h
"

40 
	~"£rv”poŞ.h
"

41 
	~"poŞ–em’t.h
"

45 #´agm¨
·ck
(1)

49 
	#ASAP_REGISTRATION
 0x01

	)

50 
	#ASAP_DEREGISTRATION
 0x02

	)

51 
	#ASAP_REGISTRATION_RESPONSE
 0x03

	)

52 
	#ASAP_DEREGISTRATION_RESPONSE
 0x04

	)

53 
	#ASAP_HANDLE_RESOLUTION
 0x05

	)

54 
	#ASAP_HANDLE_RESOLUTION_RESPONSE
 0x06

	)

55 
	#ASAP_ENDPOINT_KEEP_ALIVE
 0x07

	)

56 
	#ASAP_ENDPOINT_KEEP_ALIVE_ACK
 0x08

	)

57 
	#ASAP_ENDPOINT_UNREACHABLE
 0x09

	)

58 
	#ASAP_SERVER_ANNOUNCE
 0x0a

	)

59 
	#ASAP_COOKIE
 0x0b

	)

60 
	#ASAP_COOKIE_ECHO
 0x0c

	)

61 
	#ASAP_BUSINESS_CARD
 0x0d

	)

62 
	#ASAP_ERROR
 0x0e

	)

65 
	#ASAP_SERVER_ANNOUNCE_TIMEOUT
 2000

	)

67 
	#BUFFER_SIZE
 (1<<16)

	)

70 
£ndA§pAÂounûMsg
(*
buf
, 
size_t
 
Ën
);

73 
£ndA§pMsg
(*
buf
, 
size_t
 
Ën
, 
sùp_assoc_t
 
assocId
, 
ªnounûm’t
);

79 
	sa§pRegi¡¿tiÚ
 {

80 
ušt8
 
	mty³
;

81 
ušt8
 
	mæags
;

82 
ušt16
 
	mËngth
;

86 
hªdËA§pRegi¡¿tiÚ
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

92 
	sa§pD”egi¡¿tiÚ
 {

93 
ušt8
 
	mty³
;

94 
ušt8
 
	mæags
;

95 
ušt16
 
	mËngth
;

99 
hªdËA§pD”egi¡¿tiÚ
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

105 
	sa§pRegi¡¿tiÚRe¥Ú£
 {

106 
ušt8
 
	mty³
;

107 
ušt8
 
	mæags
;

108 
ušt16
 
	mËngth
;

111 
size_t


112 
š™A§pRegi¡¿tiÚRe¥Ú£
(
a§pRegi¡¿tiÚRe¥Ú£
 *
msg
, 
»jeùFÏg
);

115 
£ndA§pRegi¡¿tiÚRe¥Ú£
(
sùp_assoc_t
 
assocId
, 
»jeùFÏg
, 
S”v”PoŞ
 
poŞ
, 
ušt32
 
³Id’tif›r
);

121 
	sa§pD”egi¡¿tiÚRe¥Ú£
 {

122 
ušt8
 
	mty³
;

123 
ušt8
 
	mæags
;

124 
ušt16
 
	mËngth
;

127 
size_t


128 
š™A§pD”egi¡¿tiÚRe¥Ú£
(
a§pD”egi¡¿tiÚRe¥Ú£
 *
msg
);

131 
£ndA§pD”egi¡¿tiÚRe¥Ú£
(
sùp_assoc_t
 
assocId
, 
S”v”PoŞ
 
poŞ
, 
ušt32
 
³Id’tif›r
);

138 
	sa§pHªdËResŞutiÚ
 {

139 
ušt8
 
	mty³
;

140 
ušt8
 
	mæags
;

141 
ušt16
 
	mËngth
;

145 
hªdËA§pHªdËResŞutiÚ
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

151 
	sa§pHªdËResŞutiÚRe¥Ú£
 {

152 
ušt8
 
	mty³
;

153 
ušt8
 
	mæags
;

154 
ušt16
 
	mËngth
;

157 
size_t


158 
š™A§pHªdËResŞutiÚRe¥Ú£
(
a§pHªdËResŞutiÚRe¥Ú£
 *
msg
, 
acû±Upd©esFÏg
);

161 
£ndA§pHªdËResŞutiÚRe¥Ú£
(
acû±Upd©esFÏg
, 
sùp_assoc_t
 
assocId
);

167 
	sa§pEndpoštK“pAlive
 {

168 
ušt8
 
	mty³
;

169 
ušt8
 
	mæags
;

170 
ušt16
 
	mËngth
;

171 
ušt32
 
	m£rv”Id
;

174 
size_t


175 
š™A§pEndpoštK“pAlive
(
a§pEndpoštK“pAlive
 *
msg
, 
ušt32
 
£rv”Id
, 
homeFÏg
);

178 
£ndA§pEndpoštK“pAlive
(
PoŞEËm’t
 
–em’t
, 
homeFÏg
);

184 
	sa§pEndpoštK“pAliveAck
 {

185 
ušt8
 
	mty³
;

186 
ušt8
 
	mæags
;

187 
ušt16
 
	mËngth
;

191 
hªdËA§pEndpoštK“pAliveAck
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

197 
	sa§pEndpoštUÄ—chabË
 {

198 
ušt8
 
	mty³
;

199 
ušt8
 
	mæags
;

200 
ušt16
 
	mËngth
;

204 
hªdËA§pEndpoštUÄ—chabË
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

210 
	sa§pS”v”AÂounû
 {

211 
ušt8
 
	mty³
;

212 
ušt8
 
	mæags
;

213 
ušt16
 
	mËngth
;

214 
ušt32
 
	m£rv”Id
;

217 
size_t


218 
š™A§pS”v”AÂounû
(
a§pS”v”AÂounû
 *
msg
, 
ušt32
 
£rv”Id
);

221 
£ndA§pS”v”AÂounû
();

227 
	sa§pE¼Ü
 {

228 
ušt8
 
	mty³
;

229 
ušt8
 
	mæags
;

230 
ušt16
 
	mËngth
;

233 
size_t


234 
š™A§pE¼Ü
(
a§pE¼Ü
 *
msg
);

237 
£ndA§pE¼Ü
();

240 
hªdËA§pE¼Ü
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

	@backend.c

36 
	~<¡dlib.h
>

37 
	~<¡dio.h
>

38 
	~<¡ršg.h
>

39 
	~<sys/ty³s.h
>

40 
	~<sys/sock‘.h
>

41 
	~<Ãtš‘/š.h
>

42 
	~<¬·/š‘.h
>

44 
	~"cblib.h
"

45 
	~"debug.h
"

46 
	~"’½.h
"

47 
	~"back’d.h
"

48 
	~"ÿÎbacks.h
"

49 
	~"»gi¡¿r£rv”.h
"

50 
	~"£rv”poŞ.h
"

51 
	~"keov”.h
"

54 
	g»gi¡¿rS‹
;

55 
ušt32
 
	gm’tÜS”v”Id
;

56 
ušt32
 
	gownId
;

58 
	gu£Ipv6
;

59 
	gu£Loİback
;

61 
	g’½SùpFd
;

62 
	g’½UdpFd
;

63 
	g’½UdpS’dFd
;

64 
	gu£EÄpAÂounûm’ts
;

66 
	ga§pSùpFd
;

67 
	ga§pTıFd
;

68 
	ga§pUdpFd
;

69 
	ga§pUdpS’dFd
;

70 
	gu£A§pAÂounûm’ts
;

72 
ušt16
 
	g’½LoÿlPÜt
;

73 
Add»ss
 
	g’½AÂounûAddr
;

74 
ušt16
 
	g’½AÂounûPÜt
;

75 
Tim”
 
	g’½AÂounûTim”
;

77 
ušt16
 
	ga§pLoÿlPÜt
;

78 
Add»ss
 
	ga§pAÂounûAddr
;

79 
ušt16
 
	ga§pAÂounûPÜt
;

80 
Tim”
 
	ga§pAÂounûTim”
;

82 
	g£rv”HuÁCÁ
;

83 
Tim”
 
	g£rv”HuÁTim”
;

85 #ifdeà
DEBUG


86 
Tim”
 
	g’dTim”
;

91 
	$š™Glob®s
() {

92 
’½SùpFd
 = -1;

93 
’½UdpFd
 = -1;

94 
’½UdpS’dFd
 = -1;

95 
a§pSùpFd
 = -1;

96 
a§pUdpFd
 = -1;

97 
a§pUdpS’dFd
 = -1;

98 
a§pTıFd
 = -1;

99 
u£Ipv6
 = 0;

100 
u£Loİback
 = 1;

101 
’½LoÿlPÜt
 = 
ENRP_SCTP_PORT
;

102 
a§pLoÿlPÜt
 = 
ASAP_SCTP_PORT
;

103 
u£EÄpAÂounûm’ts
 = 1;

104 
u£A§pAÂounûm’ts
 = 0;

105 
’½AÂounûAddr
.
ty³
 = 
AF_INET
;

106 
’½AÂounûAddr
.
addr
.
š4
.
s_addr
 = 
	`š‘_addr
(
ENRP_ANNOUNCE_ADDR
);

107 
’½AÂounûPÜt
 = 
ENRP_UDP_PORT
;

108 
a§pAÂounûAddr
.
ty³
 = 
AF_INET
;

109 
a§pAÂounûAddr
.
addr
.
š4
.
s_addr
 = 
	`š‘_addr
(
ASAP_ANNOUNCE_ADDR
);

110 
a§pAÂounûPÜt
 = 
ASAP_UDP_PORT
;

111 
»gi¡¿rS‹
 = 
INITIALIZING
;

112 
m’tÜS”v”Id
 = 0;

113 
»gi¡¿rS”v”Li¡
 = 
NULL
;

114 
£rv”PoŞLi¡
 = 
NULL
;

115 
keov”Li¡
 = 
NULL
;

117 #ifdeà
DEBUG


118 
’dTim”
 = 
NULL
;

122 
	}
}

	@backend.h

36 #iâdeà
_BACKEND_H_


37 
	#_BACKEND_H_
 1

	)

39 
	~<sys/ty³s.h
>

40 
	~<Ãtš‘/š.h
>

41 
	~<Ãtš‘/sùp.h
>

43 
	~"cblib.h
"

45 #´agm¨
·ck
(1)

47 
	#OPERATION_SCOPE_SIZE
 32

	)

48 
	#SERVER_DESCRIPTION_SIZE
 32

	)

49 
	#MAX_ADDR_CNT
 32

	)

50 
	#POLICY_DESCRIPTION_SIZE
 255

	)

52 
	#ENRP_ANNOUNCE_ADDR
 "239.0.0.1"

	)

53 
	#ASAP_ANNOUNCE_ADDR
 "239.0.0.1"

	)

56 
	#ENRP_SCTP_PPID
 12

	)

57 
	#ENRP_UDP_PORT
 9901

	)

58 
	#ENRP_SCTP_PORT
 9901

	)

59 
	#ENRP_SCTP_TLS_PORT
 9902

	)

61 
	#ASAP_SCTP_PPID
 11

	)

62 
	#ASAP_TCP_PORT
 3863

	)

63 
	#ASAP_UDP_PORT
 3863

	)

64 
	#ASAP_SCTP_PORT
 3863

	)

65 
	#ASAP_TCP_TLS_PORT
 3864

	)

66 
	#ASAP_SCTP_TLS_PORT
 3864

	)

68 
ušt8_t
 
	tušt8
;

69 
ušt16_t
 
	tušt16
;

70 
ušt32_t
 
	tušt32
;

72 
št8_t
 
	tšt8
;

73 
št16_t
 
	tšt16
;

74 
št32_t
 
	tšt32
;

76 
	ersS‹
 {

77 
	mINITIALIZING
 = 0,

78 
	mSERVICING
,

79 
	mSYNCHRONIZING


82 
add»ss_¡ruù
 
	tAdd»ss
;

83 
	sadd»ss_¡ruù
 {

84 
	mty³
;

86 
š_addr
 
	mš4
;

87 
š6_addr
 
	mš6
;

88 } 
	maddr
;

91 
	smsgH—d”
 {

92 
ušt8
 
	mty³
;

93 
ušt8
 
	mæags
;

94 
ušt16
 
	mËngth
;

98 
»gi¡¿rS‹
;

99 
ušt32
 
m’tÜS”v”Id
;

100 
ušt32
 
ownId
;

102 
u£Ipv6
;

103 
u£Loİback
;

105 
’½SùpFd
;

106 
’½UdpFd
;

107 
’½UdpS’dFd
;

108 
u£EÄpAÂounûm’ts
;

110 
a§pSùpFd
;

111 
a§pTıFd
;

112 
a§pUdpFd
;

113 
a§pUdpS’dFd
;

114 
u£A§pAÂounûm’ts
;

116 
ušt16
 
’½LoÿlPÜt
;

117 
Add»ss
 
’½AÂounûAddr
;

118 
ušt16
 
’½AÂounûPÜt
;

119 
Tim”
 
’½AÂounûTim”
;

121 
ušt16
 
a§pLoÿlPÜt
;

122 
Add»ss
 
a§pAÂounûAddr
;

123 
ušt16
 
a§pAÂounûPÜt
;

124 
Tim”
 
a§pAÂounûTim”
;

126 
£rv”HuÁCÁ
;

127 
Tim”
 
£rv”HuÁTim”
;

129 #ifdeà
DEBUG


130 
Tim”
 
’dTim”
;

134 
š™Glob®s
();

	@callbacks.c

37 
	~<¡ršg.h
>

38 
	~<¡dio.h
>

39 
	~<¡dlib.h
>

40 
	~<sys/ty³s.h
>

41 
	~<sys/time.h
>

42 
	~<sys/sock‘.h
>

43 
	~<Ãtš‘/š.h
>

44 
	~<Ãtš‘/sùp.h
>

45 
	~<uni¡d.h
>

46 
	~<¬·/š‘.h
>

48 
	~"ÿÎbacks.h
"

49 
	~"debug.h
"

50 
	~"maš.h
"

51 
	~"back’d.h
"

52 
	~"’½.h
"

53 
	~"a§p.h
"

54 
	~"ut.h
"

55 
	~"»gi¡¿r£rv”.h
"

56 
	~"keov”.h
"

67 
ušt32
 
	gassocs
[10];

68 
	gš™
 = 0;

71 
	$put
(
ušt32
 
id
) {

72 
i
 = 0;

74 ; 
i
 < 10; i++) {

75 ià(
assocs
[
i
] == 0) {

76 
assocs
[
i
] = 
id
;

87 
	}
}

90 
	$hªdËSùpEv’t
(*
buf
, 
size_t
 
Ën
) {

91 
sùp_nÙifiÿtiÚ
 *
¢
;

92 
sùp_assoc_chªge
 *
§c
;

93 
sùp_£nd_çed
 *
ssf
;

94 
sùp_·ddr_chªge
 *
¥c
;

96 
sockaddr_š
 *
š4
;

97 
sockaddr_š6
 *
š6
;

98 *
assocSŒ
 = 
NULL
;

99 
addrBuf
[
INET6_ADDRSTRLEN
];

101 ià(
š™
 == 0) {

102 
	`mem£t
(
assocs
, 0, 32);

103 
š™
 = 1;

106 
¢
 = (
sùp_nÙifiÿtiÚ
 *)
buf
;

107 
¢
->
¢_h—d”
.
¢_ty³
) {

108 
SCTP_ASSOC_CHANGE
:

109 
§c
 = &
¢
->
¢_assoc_chªge
;

110 
	`logDebug
("assoc change");

111 
	`logDebug
("assocId: %d", 
§c
->
§c_assoc_id
);

114 
	`put
(
§c
->
§c_assoc_id
);

117 
§c
->
§c_¡©e
) {

118 
SCTP_COMM_UP
:

119 
assocSŒ
 = "SCTP_COMM_UP";

121 
SCTP_COMM_LOST
:

122 
assocSŒ
 = "SCTP_COMM_LOST";

124 
SCTP_RESTART
:

125 
assocSŒ
 = "SCTP_RESTART";

127 
SCTP_SHUTDOWN_COMP
:

128 
assocSŒ
 = "SCTP_SHUTDOWN_COMP";

130 
SCTP_CANT_STR_ASSOC
:

131 
assocSŒ
 = "SCTP_CANT_STR_ASSOC";

133 
	`logDebug
("¡©e: %s", 
assocSŒ
);

134 
	`logDebug
("”rÜ: %hu", 
§c
->
§c_”rÜ
);

135 
	`logDebug
("š¡r: %hu", 
§c
->
§c_šbound_¡»ams
);

136 
	`logDebug
("out¡r: %hu", 
§c
->
§c_outbound_¡»ams
);

139 
SCTP_SEND_FAILED
:

140 
ssf
 = &
¢
->
¢_£nd_çed
;

141 
	`logDebug
("send failed");

142 
	`logDebug
("Ëngth: %hu", 
ssf
->
ssf_Ëngth
);

143 
	`logDebug
("”rÜ: %hu", 
ssf
->
ssf_”rÜ
);

146 
SCTP_PEER_ADDR_CHANGE
:

147 
¥c
 = &
¢
->
¢_·ddr_chªge
;

148 
	`logDebug
("peer‡ddress change");

149 ià(
¥c
->
¥c_¯ddr
.
ss_çmy
 =ğ
AF_INET
) {

150 
š4
 = (
sockaddr_š
 *è&
¥c
->
¥c_¯ddr
;

151 
	`logDebug
("%s", 
	`š‘_Áİ
(
AF_INET
, &
š4
->
sš_addr
, 
addrBuf
, 
INET6_ADDRSTRLEN
));

153 
š6
 = (
sockaddr_š6
 *è&
¥c
->
¥c_¯ddr
;

154 
	`logDebug
("%s", 
	`š‘_Áİ
(
AF_INET6
, &
š6
->
sš6_addr
, 
addrBuf
, 
INET6_ADDRSTRLEN
));

156 
	`logDebug
("¡©e: %d", 
¥c
->
¥c_¡©e
);

157 
	`logDebug
("”rÜ: %d", 
¥c
->
¥c_”rÜ
);

160 
SCTP_SHUTDOWN_EVENT
:

161 
	`logDebug
("shutdownƒvent");

165 
	`logDebug
("unsuµÜ‹dƒv’ˆty³: %hu", 
¢
->
¢_h—d”
.
¢_ty³
);

170 
	}
}

173 
	$’½SùpC®lback
(*
¬g
) {

174 
ssize_t
 
Ën
;

175 
buf
[
BUFFER_SIZE
];

176 
addrBuf
[
INET6_ADDRSTRLEN
];

177 
sùp_¢drcvšfo
 
sšfo
;

178 
sockaddr_š6
 
³”
;

179 
sockËn_t
 
³”L’
;

180 
ušt8
 
ty³
;

181 
æags
;

182 
sùp_assoc_t
 
assocId
;

184 
	`mem£t
(
buf
, 0, (buf));

185 
	`mem£t
(
addrBuf
, 0, (addrBuf));

186 
	`mem£t
(&
³”
, 0, (peer));

187 
	`mem£t
(&
sšfo
, 0, (sinfo));

189 
³”L’
 = (
³”
);

191 
Ën
 = 
	`sùp_»cvmsg
(
’½SùpFd
,

192 (*è&
buf
, (buf),

193 (
sockaddr
 *è&
³”
, &
³”L’
,

194 (
sùp_¢drcvšfo
 *è&
sšfo
, &
æags
);

196 ià(
æags
 & 
MSG_NOTIFICATION
) {

197 
	`logDebug
("received‡‚otification");

198 
	`hªdËSùpEv’t
(
buf
, 
Ën
);

202 
assocId
 = 
sšfo
.
sšfo_assoc_id
;

204 
ty³
 = 
	`checkAndId’tifyMsg
(
buf
, 
Ën
, 
assocId
);

205 ià(
ty³
 == 0) {

206 
	`logDebug
("received msg is‚ot valid");

210 ià(
³”
.
sš6_çmy
 =ğ
AF_INET6
)

211 
	`š‘_Áİ
(
AF_INET6
, (*è&
³”
.
sš6_addr
, 
addrBuf
, (addrBuf));

212 ià(
³”
.
sš6_çmy
 =ğ
AF_INET
)

213 
	`š‘_Áİ
(
AF_INET
, (*è&((
sockaddr_š
 *è&
³”
)->
sš_addr
, 
addrBuf
, (addrBuf));

215 
	`logDebug
("»ûived oÀassoc: %d", 
assocId
);

216 
	`logDebug
("»ûived from: %s:%d", 
addrBuf
, 
	`Áohs
(
³”
.
sš6_pÜt
));

217 
	`logDebug
("»ûivedy³: %d", 
ty³
);

218 
	`logDebug
("»ûived†’gth: %d", ()
Ën
);

220 
ty³
) {

221 
ENRP_PRESENCE
:

222 
	`logDebug
("GÙ P»£nû Mes§gÚ‡ssoøId: %d", 
assocId
);

223 
	`hªdËEÄpP»£nû
(
buf
, 
Ën
, 
assocId
);

226 
ENRP_HANDLE_TABLE_REQUEST
:

227 
	`logDebug
("GÙ HªdË TabË Reque¡ Mes§gÚ‡ssoøId: %d", 
assocId
);

228 
	`hªdËEÄpHªdËTabËReque¡
(
buf
, 
Ën
, 
assocId
);

231 
ENRP_HANDLE_TABLE_RESPONSE
:

232 
	`logDebug
("GÙ HªdË TabË Re¥Ú£ Mes§gÚ‡ssoøId: %d", 
assocId
);

233 
	`hªdËEÄpHªdËTabËRe¥Ú£
(
buf
, 
Ën
, 
assocId
);

236 
ENRP_HANDLE_UPDATE
:

237 
	`logDebug
("GÙ HªdË Upd©Mes§gÚ‡ssoøId: %d", 
assocId
);

238 
	`hªdËEÄpHªdËUpd©e
(
buf
, 
Ën
, 
assocId
);

241 
ENRP_LIST_REQUEST
:

242 
	`logDebug
("GÙ Li¡ Reque¡ Mes§gÚ‡ssoøId: %d", 
assocId
);

243 
	`hªdËEÄpLi¡Reque¡
(
buf
, 
Ën
, 
assocId
);

246 
ENRP_LIST_RESPONSE
:

247 
	`logDebug
("GÙ Li¡ Re¥Ú£ Mes§gÚ‡ssoøId: %d", 
assocId
);

248 
	`hªdËEÄpLi¡Re¥Ú£
(
buf
, 
Ën
, 
assocId
);

251 
ENRP_INIT_TAKEOVER
:

252 
	`logDebug
("GÙ In™ Takeov” Mes§gÚ‡ssoøId: %d", 
assocId
);

253 
	`hªdËEÄpIn™Takeov”
(
buf
, 
Ën
, 
assocId
);

256 
ENRP_INIT_TAKEOVER_ACK
:

257 
	`logDebug
("GÙ In™ Takeov” ACK Mes§gÚ‡ssoøId: %d", 
assocId
);

258 
	`hªdËEÄpIn™Takeov”Ack
(
buf
, 
Ën
, 
assocId
);

261 
ENRP_TAKEOVER_SERVER
:

262 
	`logDebug
("GÙ Takeov” Mes§gÚ‡ssoøId: %d", 
assocId
);

263 
	`hªdËEÄpTakeov”S”v”
(
buf
, 
Ën
, 
assocId
);

266 
ENRP_ERROR
:

267 
	`logDebug
("GÙ E¼Ü Mes§gÚ‡ssoøId: %d", 
assocId
);

268 
	`logDebug
("This Message Type is‚ot supported yet!!");

272 
	`logDebug
("GÙ %d Mes§gTy³ oÀassoøId: %d", 
ty³
, 
assocId
);

273 
	`´štBuf
(
buf
, 
Ën
, "unknown message buffer");

274 
	`logDebug
("This Message Type is‚ot supported!!");

278 
	}
}

281 
	$’½UdpC®lback
(*
¬g
) {

282 
msgH—d”
 *
hdr
;

283 
ssize_t
 
Ën
;

284 
ušt8
 
ty³
;

285 
buf
[
BUFFER_SIZE
];

286 
addrBuf
[
INET6_ADDRSTRLEN
];

287 
sockaddr_š6
 
³”
;

288 
sockËn_t
 
³”L’
;

290 
	`mem£t
(
buf
, 0, (buf));

291 
³”L’
 = (
sockaddr_š6
);

292 
Ën
 = 
	`»cväom
(
’½UdpFd
, (*)
buf
, (buf), 0, (
sockaddr
 *è&
³”
, &
³”L’
);

294 ià(
Ën
 < 4) {

295 
	`logDebug
("msg waso short");

299 
hdr
 = (
msgH—d”
 *è
buf
;

300 
ty³
 = 
hdr
->type;

302 ià(
³”
.
sš6_çmy
 =ğ
AF_INET6
)

303 
	`š‘_Áİ
(
AF_INET6
, (*è&
³”
.
sš6_addr
, 
addrBuf
, (addrBuf));

304 ià(
³”
.
sš6_çmy
 =ğ
AF_INET
)

305 
	`š‘_Áİ
(
AF_INET
, (*è&((
sockaddr_š
 *è&
³”
)->
sš_addr
, 
addrBuf
, (addrBuf));

306 
	`logDebug
("gÙ mes§gäom: %s:%d", 
addrBuf
, 
	`Áohs
(
³”
.
sš6_pÜt
));

308 
ty³
) {

309 
ENRP_PRESENCE
:

310 
	`hªdËEÄpP»£nû
(
buf
, 
Ën
, 0);

313 
ENRP_HANDLE_TABLE_REQUEST
:

314 
	`logDebug
("discarding handleable„equest message via multicast");

317 
ENRP_HANDLE_TABLE_RESPONSE
:

318 
	`logDebug
("discarding handleable„esponse message via multicast");

321 
ENRP_HANDLE_UPDATE
:

322 
	`logDebug
("discarding handleable update message via multicast");

325 
ENRP_LIST_REQUEST
:

326 
	`logDebug
("discarding†ist„equest message via multicast");

329 
ENRP_LIST_RESPONSE
:

330 
	`logDebug
("discarding†ist„esponse message via multicast");

333 
ENRP_INIT_TAKEOVER
:

334 
	`hªdËEÄpIn™Takeov”
(
buf
, 
Ën
, 0);

337 
ENRP_INIT_TAKEOVER_ACK
:

338 
	`hªdËEÄpIn™Takeov”Ack
(
buf
, 
Ën
, 0);

341 
ENRP_TAKEOVER_SERVER
:

342 
	`hªdËEÄpTakeov”S”v”
(
buf
, 
Ën
, 0);

345 
ENRP_ERROR
:

346 
	`logDebug
("discardingƒrror message via multicast");

350 
	`logDebug
("disÿrdšg unknowÀmes§g%d vŸ muÉiÿ¡", 
ty³
);

353 
	}
}

356 
	$£rv”HuÁTimeout
(*
¬g
) {

357 ià(
»gi¡¿rS‹
 =ğ
INITIALIZING
) {

358 
	`logDebug
("initializing mode");

359 ià(
£rv”HuÁCÁ
 < 
MAX_NUMBER_SERVER_HUNT
) {

360 
	`£ndEÄpP»£nû
(0, 1, 1, 0);

361 
	`tim”S¹
(
£rv”HuÁTim”
, 
TIMEOUT_SERVER_HUNT
);

362 
£rv”HuÁCÁ
++;

366 
	`logDebug
("server hunt finished:ƒntering‚ormal servicing mode");

367 
	`tim”D–‘e
(
£rv”HuÁTim”
);

368 
»gi¡¿rS‹
 = 
SERVICING
;

369 
£rv”HuÁTim”
 = 
NULL
;

370 
	`tim”S¹
(
’½AÂounûTim”
, 
PEER_HEARTBEAT_CYCLE
);

374 
	`logDebug
("this statement should‚ot have been„eached,‡borting");

375 
	`ex™
(-1);

378 
	}
}

381 
	$’½AÂounûTimeout
(*
¬g
) {

383 
	`logDebug
("sending…eer‡nnouncement");

384 
	`£ndEÄpP»£nû
(0, 0, 1, 0);

387 
	`logDebug
("restarting‡nnounceimer");

388 
	`tim”S¹
(
’½AÂounûTim”
, 
PEER_HEARTBEAT_CYCLE
);

390 
	}
}

393 
	$³”La¡H—rdTimeout
(*
¬g
) {

394 
ušt32
 *
£rv”Id
 = (ušt32 *è
¬g
;

395 
Regi¡¿rS”v”
 
£rv”
 = 
NULL
;

396 
Takeov”
 
keov”
;

398 
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(*
£rv”Id
);

399 ià(
£rv”
 =ğ
NULL
) {

400 
	`logDebug
("callback without server");

404 
	`logDebug
("³” 0x%08ximed out,imeouˆcouÁ” i %d", 
£rv”
->
rsId’tif›r
, s”v”->
rsLa¡H—rdTimeoutCÁ
);

406 
£rv”
->
rsLa¡H—rdTimeoutCÁ
++;

407 
	`tim”S¹
(
£rv”
->
rsLa¡H—rdTimeout
, 
MAX_TIME_LAST_HEARD
);

409 ià(
£rv”
->
rsLa¡H—rdTimeoutCÁ
 =ğ
MAX_TIME_NO_RESPONSE
) {

410 ià(
£rv”
->
rsAùive
 == 1) {

411 
	`logDebug
("³” 0x%08ximed out, in™Ÿtšgakeov”…roûss", 
£rv”
->
rsId’tif›r
);

412 
keov”
 = 
	`keov”New
(
£rv”
->
rsId’tif›r
);

413 
	`£ndEÄpIn™Takeov”
(0, 
£rv”
->
rsId’tif›r
, 0);

415 
	`logDebug
("server is‡lready inactive");

419 
	`£ndEÄpP»£nû
(
£rv”
->
rsId’tif›r
, 0, 1, s”v”->
rsEÄpAssocId
);

422 
	}
}

425 
	$a§pUdpC®lback
(*
¬g
) {

426 
	`logDebug
("not implemented yet");

428 
	}
}

431 
	$a§pSùpC®lback
(*
¬g
) {

432 
ssize_t
 
Ën
;

433 
buf
[
BUFFER_SIZE
];

434 
addrBuf
[
INET6_ADDRSTRLEN
];

435 
sùp_¢drcvšfo
 
sšfo
;

436 
sockaddr_š6
 
³”
;

437 
msgH—d”
 *
hdr
;

438 
sockËn_t
 
³”L’
;

439 
ušt8
 
ty³
;

440 
æags
;

441 
sùp_assoc_t
 
assocId
;

443 
	`mem£t
(
buf
, 0, (buf));

444 
	`mem£t
(
addrBuf
, 0, (addrBuf));

445 
	`mem£t
(&
³”
, 0, (peer));

446 
	`mem£t
(&
sšfo
, 0, (sinfo));

448 
³”L’
 = (
³”
);

450 
Ën
 = 
	`sùp_»cvmsg
(
a§pSùpFd
,

451 (*è&
buf
, (buf),

452 (
sockaddr
 *è&
³”
, &
³”L’
,

453 (
sùp_¢drcvšfo
 *è&
sšfo
, &
æags
);

455 ià(
æags
 & 
MSG_NOTIFICATION
) {

456 
	`logDebug
("received‡‚otification");

457 
	`hªdËSùpEv’t
(
buf
, 
Ën
);

462 
assocId
 = 
sšfo
.
sšfo_assoc_id
;

464 ià(
Ën
 < 4) {

465 
	`logDebug
("message isoo short");

470 
hdr
 = (
msgH—d”
 *è
buf
;

471 
ty³
 = 
hdr
->type;

473 ià(
³”
.
sš6_çmy
 =ğ
AF_INET6
)

474 
	`š‘_Áİ
(
AF_INET6
, (*è&
³”
.
sš6_addr
, 
addrBuf
, (addrBuf));

475 ià(
³”
.
sš6_çmy
 =ğ
AF_INET
)

476 
	`š‘_Áİ
(
AF_INET
, (*è&((
sockaddr_š
 *è&
³”
)->
sš_addr
, 
addrBuf
, (addrBuf));

478 
	`logDebug
("»ûived oÀassoc: %d", 
assocId
);

479 
	`logDebug
("»ûived from: %s:%d", 
addrBuf
, 
	`Áohs
(
³”
.
sš6_pÜt
));

480 
	`logDebug
("»ûivedy³: %d", 
ty³
);

481 
	`logDebug
("»ûived†’gth: %d", (è
Ën
);

483 
ty³
) {

484 
ASAP_REGISTRATION
:

485 
	`logDebug
("gÙ‡§°»gi¡¿tiÚ oÀassoøid: %d", 
assocId
);

486 
	`hªdËA§pRegi¡¿tiÚ
(
buf
, 
Ën
, 
assocId
);

490 
	`logDebug
("gÙ unknowÀÜ unsuµÜ‹d %d mes§gty³ oÀassoøid: %d", 
ty³
, 
assocId
);

491 
	`´štBuf
(
buf
, 
Ën
, "unknown message buffer");

492 
	`logDebug
("This Message Type is‚ot supported!!");

496 
	}
}

499 
	$a§pAÂounûTimeout
(*
¬g
) {

500 
	`logDebug
("sending‡sap‡nnounceimeout");

501 
	`£ndA§pS”v”AÂounû
();

502 
	`tim”S¹
(
a§pAÂounûTim”
, 
ASAP_SERVER_ANNOUNCE_TIMEOUT
);

505 
	}
}

507 #ifdeà
DEBUG


509 
	$’dTimeout
(*
¬g
) {

510 
	`logDebug
("endimerimed out,ƒnding server");

511 
	`tim”Li¡Pršt
();

512 
	`keov”Li¡Pršt
();

518 
	`ex™
(-1);

519 
	}
}

	@callbacks.h

36 #iâdeà
_CALLBACKS_H


37 
	#_CALLBACKS_H
 1

	)

40 
hªdËSùpEv’t
(*
buf
, 
size_t
 
Ën
);

43 
’½SùpC®lback
(*
¬g
);

46 
’½UdpC®lback
(*
¬g
);

49 
£rv”HuÁTimeout
(*
¬g
);

52 
’½AÂounûTimeout
(*
¬g
);

55 
³”La¡H—rdTimeout
(*
¬g
);

58 
a§pUdpC®lback
(*
¬g
);

61 
a§pSùpC®lback
(*
¬g
);

64 
a§pAÂounûTimeout
(*
¬g
);

66 #ifdeà
DEBUG


68 
’dTimeout
(*
¬g
);

	@cblib.c

37 
	~<¡ršg.h
>

38 
	~<¡dlib.h
>

39 
	~<sys/ty³s.h
>

40 
	~<sys/time.h
>

41 
	~<uni¡d.h
>

43 
	~"debug.h
"

44 
	~"cblib.h
"

46 
	scb¬g
 {

47 
	mfd
;

48 *
	m¬g
;

49 (*
	mÿÎback
) (*);

50 } 
	gcb
[
FD_SETSIZE
];

52 
Tim”
 
	gtim”Li¡
 = 
NULL
;

53 
fd_£t
 
	g»ad_fds
;

56 
	$dummy
 (*
¬g
) {

57 
fd
;

59 
fd
 = *(*)
¬g
;

61 
	`logDebug
("thi funùiÚ should‚Ù havb“ÀÿÎed. cË¬šg fd %u", 
fd
);

62 
	`FD_CLR
(
fd
, &
»ad_fds
);

64  
¬g
;

65 
	}
}

68 
	$š™Cblib
() {

69 
fd
;

71 
	`FD_ZERO
(&
»ad_fds
);

72 
fd
 = 0; fd < 
FD_SETSIZE
; fd++) {

73 
cb
[
fd
].fd = fd;

74 
cb
[
fd
].
ÿÎback
 = ((*)(*)è
dummy
;

75 
cb
[
fd
].
¬g
 = (*) (&cb[fd].fd);

79 
	}
}

82 
tim”Regi¡”FdC®lback
(
fd
, (*
ÿÎback
)(*), *
¬g
) {

83 ià((
fd
 <ğ0è|| (fd >ğ
FD_SETSIZE
è|| (
ÿÎback
 =ğ
NULL
)) {

84 
	`logDebug
("invalid‡rguments");

88 
cb
[
fd
].
¬g
 =‡rg;

89 
cb
[
fd
].
ÿÎback
 = callback;

90 
	`FD_SET
(
fd
, &
»ad_fds
);

91 
	}
}

94 
im”Regi¡”StdšC®lback
((*
ÿÎback
)(*), *
¬g
) {

95 ià(
ÿÎback
 =ğ
NULL
) {

96 
	`logDebug
("invalid‡rgument, callback is NULL");

100 
cb
[0].
ÿÎback
 = callback;

101 
cb
[0].
¬g
 =‡rg;

102 
	`FD_SET
(0, &
»ad_fds
);

103 
	}
}

105 
Tim”


106 
tim”C»©e
((*
ÿÎback
)(*), *
¬g
, *
desütiÚ
) {

107 
Tim”
 
tim”
;

109 ià(
ÿÎback
 =ğ
NULL
) {

110 
	`logDebug
("callback is NULL");

111  
NULL
;

114 ià(
desütiÚ
 =ğ
NULL
) {

115 
	`logDebug
("description is NULL");

116  
NULL
;

119 
tim”
 = (
Tim”
è
	`m®loc
((*timer));

121 ià(
tim”
) {

122 
	`mem£t
((*)
tim”
, 0, (*timer));

123 
	`¡ºıy
(
tim”
->
desütiÚ
, desütiÚ, 
TIMER_DESCRIPTION_LENGTH
);

124 
tim”
->
ÿÎback
 = callback;

125 
tim”
->
¬g
 =‡rg;

127 
	`logDebug
("could‚ot‡llocate memory");

129 
	`logDebug
("ü—‹dim”: %.*s", 
TIMER_DESCRIPTION_LENGTH
, 
tim”
->
desütiÚ
);

131  
tim”
;

132 
	}
}

135 
	$tim”D–‘e
(
Tim”
 
tim”
) {

136 ià(
tim”
 =ğ
NULL
) {

137 
	`logDebug
("timer is NULL");

141 ià((
tim”
->
Ãxt
 !ğ
NULL
è|| (tim”->
´ev
 != NULL) ||

142 (
tim”
->
¡¬t_time
.
tv_£c
 !ğ0è|| (tim”->¡¬t_time.
tv_u£c
 != 0) ||

143 (
tim”
->
¡İ_time
.
tv_£c
 !ğ0è|| (tim”->¡İ_time.
tv_u£c
 != 0)) {

144 
	`logDebug
("tim” %.* nÙ stİ³d", 
TIMER_DESCRIPTION_LENGTH
, 
tim”
->
desütiÚ
);

145 
	`tim”Stİ
(
tim”
);

148 
	`as£¹
(
tim”
->
Ãxt
 =ğ
NULL
);

149 
	`as£¹
(
tim”
->
´ev
 =ğ
NULL
);

150 
	`as£¹
(
tim”Li¡
 !ğ
tim”
);

152 
	`mem£t
(
tim”
, 0, (*timer));

153 
	`ä“
((*è
tim”
);

154 
	}
}

157 
	$timev®BefÜe
(
timev®
 *
tv1
, timev® *
tv2
) {

158 ià(
tv1
 =ğ
NULL
) {

159 
	`logDebug
("inalid‡rgument:v1 is NULL");

163 ià(
tv2
 =ğ
NULL
) {

164 
	`logDebug
("inalid‡rgument:v2 is NULL");

168 ià((
tv1
->
tv_£c
 < 
tv2
->tv_£cè|| (Ñv1->tv_£ø=ğtv2->tv_£cè&& (tv1->
tv_u£c
 <v2->tv_usec)))

172 
	}
}

175 
	$g‘Time
(
timev®
 *
tv
) {

176 
	`mem£t
((*)
tv
, 0, (
timev®
));

178 ià(
	`g‘timeofday
(
tv
, 
NULL
) < 0)

179 
	`logDebug
("currentime unknown");

180 
	}
}

183 
	$tim”S¹
(
Tim”
 
tim”ToS¹
, 
timeout
) {

184 
timev®
 
now
;

185 
Tim”
 
tim”
;

187 
	`logDebug
("tim”‚ame: %s", 
tim”ToS¹
->
desütiÚ
);

189 ià(
tim”ToS¹
 =ğ
NULL
) {

190 
	`logDebug
("invalid‡rgument:imerToStart is NULL");

195 
	`g‘Time
(&
now
);

196 ià((
tim”ToS¹
->
Ãxt
 !ğ
NULL
è|| (tim”ToS¹->
´ev
 != NULL) ||

197 (
tim”ToS¹
->
¡¬t_time
.
tv_£c
 !ğ0è|| (tim”ToS¹->¡¬t_time.
tv_u£c
 != 0) ||

198 (
tim”ToS¹
->
¡İ_time
.
tv_£c
 !ğ0è|| (tim”ToS¹->¡İ_time.
tv_u£c
 != 0)) {

199 
	`logDebug
("tim” i ®»ady s¹ed: %.*s", 
TIMER_DESCRIPTION_LENGTH
, 
tim”ToS¹
->
desütiÚ
);

204 
tim”ToS¹
->
¡¬t_time
.
tv_£c
 = 
now
.tv_sec;

205 
tim”ToS¹
->
¡¬t_time
.
tv_u£c
 = 
now
.tv_usec;

206 
tim”ToS¹
->
¡İ_time
.
tv_£c
 = 
now
.tv_£ø+ (
timeout
 / 1000);

207 
tim”ToS¹
->
¡İ_time
.
tv_u£c
 = 
now
.tv_u£ø+ 1000 * (
timeout
 % 1000);

208 ià(
tim”ToS¹
->
¡İ_time
.
tv_u£c
 >= 1000000) {

209 
tim”ToS¹
->
¡İ_time
.
tv_£c
++;

210 
tim”ToS¹
->
¡İ_time
.
tv_u£c
 -= 1000000;

214 ià(
tim”Li¡
 =ğ
NULL
) {

215 
tim”Li¡
 = 
tim”ToS¹
;

216 
	`tim”Li¡Pršt
();

221 
tim”
 = 
tim”Li¡
;

222 ià(
	`timev®BefÜe
(&
tim”ToS¹
->
¡İ_time
, &
tim”
->stop_time)) {

223 
tim”ToS¹
->
Ãxt
 = 
tim”
;

224 
tim”
->
´ev
 = 
tim”ToS¹
;

225 
tim”Li¡
 = 
tim”ToS¹
;

226 
	`tim”Li¡Pršt
();

231 
tim”
 = 
tim”Li¡
;im”->
Ãxt
;imer =imer->next)

232 ià(
	`timev®BefÜe
(&
tim”ToS¹
->
¡İ_time
, &
tim”
->
Ãxt
->stop_time))

235 
tim”ToS¹
->
Ãxt
 = 
tim”
->next;

236 
tim”ToS¹
->
´ev
 = 
tim”
;

237 ià(
tim”
->
Ãxt
) {

238 
tim”
->
Ãxt
->
´ev
 = 
tim”ToS¹
;

240 
tim”
->
Ãxt
 = 
tim”ToS¹
;

242 
	`tim”Li¡Pršt
();

243 
	}
}

246 
	$tim”Re¡¬t
(
Tim”
 
tim”
, 
timeout
) {

247 ià(
tim”
 =ğ
NULL
) {

248 
	`logDebug
("timer is NULL");

252 
	`tim”Stİ
(
tim”
);

253 
	`tim”S¹
(
tim”
, 
timeout
);

256 
	}
}

259 
	$tim”Stİ
(
Tim”
 
tim”ToStİ
) {

260 
Tim”
 
tim”
 = 
NULL
;

262 ià(
tim”ToStİ
 =ğ
NULL
) {

263 
	`logDebug
("timerToStop is NULL");

267 
	`logDebug
("tim”‚ame: %s", 
tim”ToStİ
->
desütiÚ
);

268 
	`tim”Li¡Pršt
();

271 
tim”
 = 
tim”Li¡
;im”;im” =im”->
Ãxt
)

272 ià(
tim”
 =ğ
tim”ToStİ
)

275 ià(
tim”
 =ğ
NULL
) {

276 
	`logDebug
("tim”ToStİ %°i nÙ iÀtim”Li¡", (*)
tim”ToStİ
);

280 
	`as£¹
(
tim”
 =ğ
tim”ToStİ
);

281 ià(
tim”
->
´ev
) {

282 
tim”
->
´ev
->
Ãxt
 =imer->next;

284 ià(
tim”
->
Ãxt
) {

285 
tim”
->
Ãxt
->
´ev
 =imer->prev;

287 ià(
tim”Li¡
 =ğ
tim”
) {

288 
tim”Li¡
 = 
tim”
->
Ãxt
;

289 
	`as£¹
((
tim”Li¡
 =ğ
NULL
è|| (tim”Li¡->
´ev
 == NULL));

292 
tim”ToStİ
->
´ev
 = 
NULL
;

293 
tim”ToStİ
->
Ãxt
 = 
NULL
;

294 
tim”ToStİ
->
¡¬t_time
.
tv_£c
 = 0;

295 
tim”ToStİ
->
¡¬t_time
.
tv_u£c
 = 0;

296 
tim”ToStİ
->
¡İ_time
.
tv_£c
 = 0;

297 
tim”ToStİ
->
¡İ_time
.
tv_u£c
 = 0;

300 
	}
}

303 
	$tim”Pršt
(
Tim”
 
tim”
) {

304 ià(
tim”
 =ğ
NULL
) {

305 
	`logDebug
("timer is NULL");

309 
	`logDebug
("s: %u:%u cb: (%9pèp: %8°n: %8°- %.*s", (è
tim”
->
¡İ_time
.
tv_£c
, (ètim”->¡İ_time.
tv_u£c
,im”->
¬g
, (*éim”->
´ev
, (*éim”->
Ãxt
, 
TIMER_DESCRIPTION_LENGTH
,im”->
desütiÚ
);

310 
	}
}

313 
	$tim”Li¡Pršt
() {

314 #ifdeà
DEBUG


315 
Tim”
 
tim”
;

317 
tim”
 = 
tim”Li¡
;im”;im” =im”->
Ãxt
)

318 
	`tim”Pršt
(
tim”
);

321 
	}
}

324 
	$hªdËEv’t
() {

325 
fd
, 
n
;

326 
Tim”
 
tim”
;

327 
timev®
 
now
;

328 
timev®
 
timeout
;

329 
timev®
 *
timeout_±r
;

330 
fd_£t
 
r£t
;

332 
	`logDebug
("being called,imer†ist");

333 
	`tim”Li¡Pršt
();

335 
	`g‘Time
(&
now
);

337 
tim”
 = 
tim”Li¡
;

338 ià((
tim”Li¡
è&& (
	`timev®BefÜe
(&
tim”
->
¡İ_time
, &
now
))) {

339 
	`logDebug
("hªdlšgim”ƒv’ˆ(%.*sèwhich should hav®»ady b“ÀhªdËd", 
TIMER_DESCRIPTION_LENGTH
, 
tim”
->
desütiÚ
);

340 
	`tim”Stİ
(
tim”
);

341 (*
tim”
->
ÿÎback
)Ñim”->
¬g
);

345 ià(
tim”Li¡
) {

346 
tim”
 = 
tim”Li¡
;

347 
timeout
.
tv_£c
 = 
tim”
->
¡İ_time
.tv_£ø- 
now
.tv_sec;

348 
timeout
.
tv_u£c
 = 
tim”
->
¡İ_time
.tv_u£ø- 
now
.tv_usec;

349 ià(
timeout
.
tv_u£c
 < 0) {

350 
timeout
.
tv_£c
--;

351 
timeout
.
tv_u£c
 += 1000000;

353 
timeout_±r
 = &
timeout
;

355 
timeout_±r
 = 
NULL
;

357 
r£t
 = 
»ad_fds
;

358 
n
 = 
	`£Ëù
(
FD_SETSIZE
, &
r£t
, 
NULL
, NULL, 
timeout_±r
);

360 ià(
n
 == 0) {

361 
tim”
 = 
tim”Li¡
;

362 
	`tim”Stİ
(
tim”
);

363 
	`logDebug
("hªdlšgim”ƒv’t: %.*s", 
TIMER_DESCRIPTION_LENGTH
, 
tim”
->
desütiÚ
);

364 (*
tim”
->
ÿÎback
)Ñim”->
¬g
);

366 
fd
 = 0; fd < 
FD_SETSIZE
; fd++) {

367 ià(
	`FD_ISSET
(
fd
, &
r£t
)) {

368 
	`logDebug
("hªdlšg fdƒv’ˆfÜ fd: %d", 
fd
);

369 (*(
cb
[
fd
].
ÿÎback
))(cb[fd].
¬g
);

375 
	}
}

378 
	$hªdËEv’ts
() {

380 
	`hªdËEv’t
();

381 
	}
}

	@cblib.h

37 #iâdeà
_CBLIB_H


38 
	#_CBLIB_H
 1

	)

40 
	~<sys/time.h
>

42 #´agm¨
·ck
(1)

44 
	#TIMER_DESCRIPTION_LENGTH
 100

	)

46 
tim”_¡ruù
 *
	tTim”
;

47 
	stim”_¡ruù
 {

48 
Tim”
 
	m´ev
;

49 
Tim”
 
	mÃxt
;

50 
timev®
 
	m¡¬t_time
;

51 
timev®
 
	m¡İ_time
;

52 
	mdesütiÚ
[
TIMER_DESCRIPTION_LENGTH
 + 1];

53 *
	m¬g
;

54 (*
	mÿÎback
) (*);

57 
Tim”


58 
tim”C»©e
((*
ÿÎback
)(*), *
¬g
, *
desütiÚ
);

61 
	`tim”D–‘e
(
Tim”
 
tim”
);

64 
	`tim”S¹
(
Tim”
 
tim”
, 
timeout
);

67 
	`tim”Re¡¬t
(
Tim”
 
tim”
, 
timeout
);

70 
	`tim”Stİ
(
Tim”
 
tim”
);

73 
	`tim”Regi¡”FdC®lback
(
fd
, (*
ÿÎback
)(*), *
¬g
);

76 
	`tim”Regi¡”StdšC®lback
((*
ÿÎback
)(*), *
¬g
);

79 
	`tim”Pršt
(
Tim”
 
tim”
);

82 
	`tim”Li¡Pršt
();

85 
	`hªdËEv’ts
();

88 
	`š™Cblib
();

91 
	`timev®BefÜe
(
timev®
 *
tv1
, timev® *
tv2
);

94 
	`g‘Time
(
timev®
 *
tv
);

	@checksum.c

36 
	~"checksum.h
"

37 
	~"·¿m‘”s.h
"

39 
checksumTy³


40 
	$checksumCompu‹
(
checksumTy³
 
sum
, cÚ¡ * 
buf
, 
size_t
 
size
) {

41 
ušt16
 *
±r
 = (ušt16 *è
buf
;

43 
size
 >ğ(*
±r
)) {

44 
sum
 +ğ*
±r
++;

45 
size
 -ğ(*
±r
);

49 ià(
size
 > 0)

50 
sum
 +ğ* (
ušt8
 *è
±r
;

52 (
sum
);

53 
	}
}

55 
checksumTy³


56 
	$checksumAdd
(cÚ¡ 
checksumTy³
 
a
, cÚ¡ checksumTy³ 
b
) {

57  
a
 + 
b
;

58 
	}
}

60 
checksumTy³


61 
	$checksumSub
(cÚ¡ 
checksumTy³
 
a
, cÚ¡ checksumTy³ 
b
) {

62  
a
 - 
b
;

63 
	}
}

65 
checksumTy³FŞded


66 
	$checksumFŞd
(
checksumTy³
 
sum
) {

67 
sum
 >> 16)

68 
sum
 = (sum & 0xffff) + (sum >> 16);

70  (
ušt16
è~
sum
;

71 
	}
}

	@checksum.h

36 #iâdeà
_CHECKSUM_H


37 
	#_CHECKSUM_H
 1

	)

39 
	~"back’d.h
"

41 
ušt32
 
	tchecksumTy³
;

42 
ušt16
 
	tchecksumTy³FŞded
;

44 
checksumTy³


45 
checksumCompu‹
(
checksumTy³
 
sum
, cÚ¡ * 
buf
, 
size_t
 
size
);

47 
checksumTy³


48 
checksumAdd
(cÚ¡ 
checksumTy³
 
a
, cÚ¡ checksumTy³ 
b
);

50 
checksumTy³


51 
checksumSub
(cÚ¡ 
checksumTy³
 
a
, cÚ¡ checksumTy³ 
b
);

53 
checksumTy³FŞded


54 
checksumFŞd
(
checksumTy³
 
sum
);

	@debug.c

37 
	~"debug.h
"

	@debug.h

36 #iâdeà
_DEBUG_H


37 
	#_DEBUG_H
 1

	)

39 
	~<¡dio.h
>

40 
	~<sys/time.h
>

41 
	~<as£¹.h
>

43 
	#DEBUG
 1

	)

45 #ià
DEBUG
 == 1

46 
	#logDebug
(
fmt
...)\

48 
timev®
 
now
;\

49 
	`g‘timeofday
(&
now
, 
NULL
);\

50 
	`årštf
(
¡dout
, "%ld:%06d ", 
now
.
tv_£c
, (ènow.
tv_u£c
);\

51 
	`årštf
(
¡dout
, "%s:%d:% - ", 
__FILE__
, 
__LINE__
, 
__FUNCTION__
);\

52 
	`årštf
(
¡dout
, 
fmt
);\

53 
	`årštf
(
¡dout
, "\n");\

54 }

	)

56 
	#´štBuf
(
buf
, 
size
, 
bufãrName
)\

58 
i
 = 0;\

59 
	`logDebug
(
bufãrName
);\

60 
	`årštf
(
¡dout
, "0000 ");\

62 ià(
i
 % 8 == 0 && i != 0)\

63 
	`årštf
(
¡dout
, "\n%.4hx ", 
i
);\

64 ià(
i
 % 4 == 0 && i != 0)\

65 
	`årštf
(
¡dout
, " ");\

66 
	`årštf
(
¡dout
, "%x", (((
buf
)[
i
] >> 4) & 0x0f));\

67 
	`årštf
(
¡dout
, "%x", ((
buf
)[
i
] & 0x0f));\

68 
	`årštf
(
¡dout
, " ");\

69 } ++
i
 < (è
size
);\

70 
	`årštf
(
¡dout
, "\n");\

71 }

	)

74 
	#logDebug
(
fmt
...è{}

	)

75 
	#´štBuf
(
buf
, 
size
, 
bufãrName
è{}

	)

	@enrp.c

37 
	~<¡ršg.h
>

38 
	~<¡dio.h
>

39 
	~<¡dlib.h
>

40 
	~<sys/ty³s.h
>

41 
	~<sys/sock‘.h
>

42 
	~<Ãtš‘/š.h
>

43 
	~<Ãtš‘/sùp.h
>

44 
	~<¬·/š‘.h
>

46 
	~"debug.h
"

47 
	~"’½.h
"

48 
	~"back’d.h
"

49 
	~"·¿m‘”s.h
"

50 
	~"checksum.h
"

51 
	~"»gi¡¿r£rv”.h
"

52 
	~"poŞ–em’t.h
"

53 
	~"£rv”poŞ.h
"

54 
	~"keov”.h
"

55 
	~"ut.h
"

57 
size_t


58 
	$š™EÄpP»£nû
(
’½P»£nû
 *
msg
, 
ušt32
 
»ûiv”Id
, 
»¶yReqB™
) {

59 
msg
->
hdr
.
ty³
 = 
ENRP_PRESENCE
;

60 
msg
->
hdr
.
æags
 = (
»¶yReqB™
 > 0) ? 0x01 : 0x00;

61 
msg
->
hdr
.
Ëngth
 = 
	`htÚs
(20);

62 
msg
->
£nd”S”v”Id
 = 
	`htÚl
(
ownId
);

63 
msg
->
»ûiv”S”v”Id
 = 
	`htÚl
(
»ûiv”Id
);

65 
	}
}

67 
size_t


68 
	$š™EÄpLi¡Reque¡
(
’½Li¡Reque¡
 *
msg
, 
ušt32
 
»ûiv”Id
) {

69 
msg
->
hdr
.
ty³
 = 
ENRP_LIST_REQUEST
;

70 
msg
->
hdr
.
æags
 = 0;

71 
msg
->
hdr
.
Ëngth
 = 
	`htÚs
(12);

72 
msg
->
£nd”S”v”Id
 = 
	`htÚl
(
ownId
);

73 
msg
->
»ûiv”S”v”Id
 = 
	`htÚl
(
»ûiv”Id
);

75 
	}
}

77 
size_t


78 
	$š™EÄpLi¡Re¥Ú£
(
’½Li¡Re¥Ú£
 *
msg
, 
ušt32
 
»ûiv”Id
, 
»jeùB™
) {

79 
msg
->
hdr
.
ty³
 = 
ENRP_LIST_RESPONSE
;

80 
msg
->
hdr
.
æags
 = (
»jeùB™
 > 0) ? 0x01 : 0x00;

81 
msg
->
hdr
.
Ëngth
 = 
	`htÚs
(12);

82 
msg
->
£nd”S”v”Id
 = 
	`htÚl
(
ownId
);

83 
msg
->
»ûiv”S”v”Id
 = 
	`htÚl
(
»ûiv”Id
);

85 
	}
}

87 
size_t


88 
	$š™EÄpHªdËTabËReque¡
(
’½HªdËTabËReque¡
 *
msg
, 
ušt32
 
»ûiv”Id
, 
ownB™
) {

89 
msg
->
hdr
.
ty³
 = 
ENRP_HANDLE_TABLE_REQUEST
;

90 
msg
->
hdr
.
æags
 = (
ownB™
 > 0) ? 0x01 : 0x00;

91 
msg
->
hdr
.
Ëngth
 = 
	`htÚs
(12);

92 
msg
->
£nd”S”v”Id
 = 
	`htÚl
(
ownId
);

93 
msg
->
»ûiv”S”v”Id
 = 
	`htÚl
(
»ûiv”Id
);

95 
	}
}

97 
size_t


98 
	$š™EÄpHªdËTabËRe¥Ú£
(
’½HªdËTabËRe¥Ú£
 *
msg
, 
ušt32
 
»ûiv”Id
, 
mÜeB™
, 
»jeùB™
) {

99 
msg
->
hdr
.
ty³
 = 
ENRP_HANDLE_TABLE_RESPONSE
;

100 
msg
->
hdr
.
æags
 = 0x00 | ((
mÜeB™
 > 0è? 0x02 : 0x00è| ((
»jeùB™
 > 0) ? 0x01 : 0x00);

101 
msg
->
hdr
.
Ëngth
 = 
	`htÚs
(12);

102 
msg
->
£nd”S”v”Id
 = 
	`htÚl
(
ownId
);

103 
msg
->
»ûiv”S”v”Id
 = 
	`htÚl
(
»ûiv”Id
);

105 
	}
}

107 
size_t


108 
	$š™EÄpHªdËUpd©e
(
’½HªdËUpd©e
 *
msg
, 
ušt32
 
»ûiv”Id
, 
ušt16
 
upd©eAùiÚ
) {

109 
msg
->
hdr
.
ty³
 = 
ENRP_HANDLE_UPDATE
;

110 
msg
->
hdr
.
æags
 = 0;

111 
msg
->
hdr
.
Ëngth
 = 
	`htÚs
(16);

112 
msg
->
£nd”S”v”Id
 = 
	`htÚl
(
ownId
);

113 
msg
->
»ûiv”S”v”Id
 = 
	`htÚl
(
»ûiv”Id
);

114 
msg
->
upd©eAùiÚ
 = 
	`htÚs
(updateAction);

115 
msg
->
»£rved
 = 0;

117 
	}
}

119 
size_t


120 
	$š™EÄpIn™Takeov”
(
’½In™Takeov”
 *
msg
, 
ušt32
 
»ûiv”Id
, ušt32 
rg‘Id
) {

121 
msg
->
hdr
.
ty³
 = 
ENRP_INIT_TAKEOVER
;

122 
msg
->
hdr
.
æags
 = 0;

123 
msg
->
hdr
.
Ëngth
 = 
	`htÚs
(16);

124 
msg
->
£nd”S”v”Id
 = 
	`htÚl
(
ownId
);

125 
msg
->
»ûiv”S”v”Id
 = 
	`htÚl
(
»ûiv”Id
);

126 
msg
->
rg‘S”v”Id
 = 
	`htÚl
(
rg‘Id
);

128 
	}
}

130 
size_t


131 
	$š™EÄpIn™Takeov”Ack
(
’½In™Takeov”Ack
 *
msg
, 
ušt32
 
»ûiv”Id
, ušt32 
rg‘Id
) {

132 
msg
->
hdr
.
ty³
 = 
ENRP_INIT_TAKEOVER_ACK
;

133 
msg
->
hdr
.
æags
 = 0;

134 
msg
->
hdr
.
Ëngth
 = 
	`htÚs
(16);

135 
msg
->
£nd”S”v”Id
 = 
	`htÚl
(
ownId
);

136 
msg
->
»ûiv”S”v”Id
 = 
	`htÚl
(
»ûiv”Id
);

137 
msg
->
rg‘S”v”Id
 = 
	`htÚl
(
rg‘Id
);

139 
	}
}

141 
size_t


142 
	$š™EÄpTakeov”S”v”
(
’½Takeov”S”v”
 *
msg
, 
ušt32
 
»ûiv”Id
, ušt32 
rg‘Id
) {

143 
msg
->
hdr
.
ty³
 = 
ENRP_TAKEOVER_SERVER
;

144 
msg
->
hdr
.
æags
 = 0;

145 
msg
->
hdr
.
Ëngth
 = 
	`htÚs
(16);

146 
msg
->
£nd”S”v”Id
 = 
	`htÚl
(
ownId
);

147 
msg
->
»ûiv”S”v”Id
 = 
	`htÚl
(
»ûiv”Id
);

148 
msg
->
rg‘S”v”Id
 = 
	`htÚl
(
rg‘Id
);

150 
	}
}

153 
	$hªdËLiãtimeExpœy
(* 
d©a
) {

154 
PoŞEËm’t
 
³Ëm’t
 = (PoŞEËm’tè
d©a
;

155 
S”v”PoŞ
 
poŞ
 = (S”v”PoŞè
³Ëm’t
->
³S”v”PoŞ
;

156 
Regi¡¿rS”v”
 
»gi¡¿rS”v”
 = (Regi¡¿rS”v”è
³Ëm’t
->
³Regi¡¿rS”v”
;

158 
	`logDebug
("Liãtimha expœed fÜ…oŞƒËm’ˆ0x%08x", 
³Ëm’t
->
³Id’tif›r
);

160 
	`»gi¡¿rS”v”RemovePoŞEËm’t
(
»gi¡¿rS”v”
, 
³Ëm’t
);

161 
	`£rv”PoŞRemovePoŞEËm’t
(
poŞ
, 
³Ëm’t
->
³Id’tif›r
);

162 
	}
}

165 
	$hªdËEÄpMsg
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

166 
	`logDebug
("not implemented yet");

169 
	}
}

172 
	$hªdËEÄpP»£nû
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

173 
’½P»£nû
 *
´es
;

174 
·¿mS”v”InfÜm©iÚ
 *
¤vInfo
;

175 
Regi¡¿rS”v”
 
£rv”
 = 
NULL
;

176 
Takeov”
 
keov”
 = 
NULL
;

177 
Add»ss
 
addrs
[
MAX_ADDR_CNT
];

178 *
off£t
;

179 
size_t
 
bufL’
;

180 
sùp_assoc_t
 
ÃwAssocId
;

181 
checksumTy³FŞded
 
checksum
;

182 
ušt32
 
£nd”S”v”Id
;

183 
ušt16
 
Ëngth
;

184 
ušt16
 
pÜt
;

185 
ušt16
 
Œª¥ÜtU£
;

186 
ušt8
 
´ÙocŞ
;

187 
£ndR•ly
 = 0;

188 
addrCÁ
 = 0;

189 
isNew
 = 0;

190 
»t
;

191 
i
;

193 
´es
 = (
’½P»£nû
 *è
buf
;

194 
£nd”S”v”Id
 = 
	`Áohl
(
´es
->senderServerId);

195 
Ëngth
 = 
	`Áohs
(
´es
->
hdr
.length);

196 
checksum
 = 
	`Áohs
(
´es
->
³Checksum
.checksum);

197 
bufL’
 = 
Ëngth
;

199 ià(
´es
->
hdr
.
æags
 & 0x01)

200 
£ndR•ly
 = 1;

202 ià(
£nd”S”v”Id
 =ğ
ownId
) {

203 
	`logDebug
("discarding own…resence message");

207 
	`logDebug
("gotƒnrp…resence msg");

208 
	`logDebug
("assocId: %d", 
assocId
);

210 ià(
Ëngth
 !ğ
Ën
) {

211 
	`logDebug
("buffer†entgh does‚ot match…acket†ength");

215 ià(
bufL’
 > (
’½P»£nû
)) {

216 
off£t
 = (*è
buf
 + (
’½P»£nû
);

217 
bufL’
 -ğ(
’½P»£nû
);

219 ià(
	`checkTLV
(
off£t
, 
bufL’
è=ğ
PARAM_SERVER_INFORMATION
) {

220 
¤vInfo
 = (
·¿mS”v”InfÜm©iÚ
 *è
off£t
;

221 
off£t
 +ğ(
·¿mS”v”InfÜm©iÚ
);

222 
bufL’
 -ğ(
·¿mS”v”InfÜm©iÚ
);

224 
	`mem£t
(
addrs
, 0, (addrs));

225 
»t
 = 
	`£ndBufãrToT¿n¥ÜtAdd»s£s
(
off£t
, &
bufL’
, 
addrs
, &
addrCÁ
, &
pÜt
, &
Œª¥ÜtU£
, &
´ÙocŞ
);

226 ià(
»t
 =ğ-1 || 
´ÙocŞ
 !ğ
IPPROTO_SCTP
) {

227 
	`logDebug
("msg does‚ot contain‡…roper sctpransport…arameter");

231 
	`logDebug
("th”wa ¨·¿m‘”ƒ¼Ü:y³ =ğ%d", 
	`checkTLV
(
off£t
, 
bufL’
));

237 
	`logDebug
("there was‡ messageƒrror");

243 
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
£nd”S”v”Id
);

244 ià(
£rv”
 !ğ
NULL
) {

245 
	`logDebug
("found 0x%08x iÀ³”†i¡", 
£nd”S”v”Id
);

246 
	`»gi¡¿rS”v”Re£tTim”
(
£rv”
);

247 ià(
£rv”
->
rsAùive
 == 0) {

248 
	`logDebug
("server is‡ctive‡gain");

249 
£rv”
->
rsAùive
 = 1;

250 
keov”
 = 
	`keov”Lookup
(
£rv”
->
rsId’tif›r
);

251 ià(
keov”
 !ğ
NULL
) {

252 
	`logDebug
("deletingakeover");

253 
	`keov”D–‘e
(
keov”
);

260 
	`logDebug
("0x%08x i nÙ iÀ³”†i¡", 
£nd”S”v”Id
);

261 
£rv”
 = 
	`»gi¡¿rS”v”New
(
£nd”S”v”Id
);

262 ià(
£rv”
 =ğ
NULL
) {

265 
	`»gi¡¿rS”v”Li¡AddS”v”
(
£rv”
);

266 
£rv”
->
rsChecksum
 = 
checksum
;

267 
£rv”
->
rsEÄpPÜt
 = 
pÜt
;

268 
i
 = 0; i < 
MAX_ADDR_CNT
; i++) {

269 
£rv”
->
rsEÄpAddr
[
i
] = 
addrs
[i];

271 
	`logDebug
("added 0x%08xØ³”†i¡", 
£nd”S”v”Id
);

272 
isNew
 = 1;

275 ià(
assocId
 =ğ0 && (
isNew
 =ğ1 && 
addrCÁ
 > 0)) {

276 
»t
 = 
	`ü—‹AssocToP“r
(
’½SùpFd
, 
addrs
, 
addrCÁ
, 
pÜt
, 
£nd”S”v”Id
, &
ÃwAssocId
);

277 ià(
»t
 == -1) {

278 
	`logDebug
("couldn'ˆe¡ablish‡Àsù°assocŸtiÚ w™h 0x%08x", 
£nd”S”v”Id
);

282 
£rv”
->
rsEÄpAssocId
 = 
ÃwAssocId
;

284 
ÃwAssocId
 = 
assocId
;

287 ià(
»gi¡¿rS‹
 =ğ
INITIALIZING
) {

288 
	`logDebug
("usšg 0x%08x‡ m’tÜ…“r", 
£nd”S”v”Id
);

289 
m’tÜS”v”Id
 = 
£nd”S”v”Id
;

290 
»gi¡¿rS‹
 = 
SERVICING
;

291 
	`£ndEÄpP»£nû
(
m’tÜS”v”Id
, 1, 1, 
ÃwAssocId
);

292 
	`£ndEÄpLi¡Reque¡
(
m’tÜS”v”Id
, 
ÃwAssocId
);

293 
	`£ndEÄpHªdËTabËReque¡
(
m’tÜS”v”Id
, 0, 
ÃwAssocId
);

298 
	`tim”Stİ
(
£rv”HuÁTim”
);

299 
	`tim”D–‘e
(
£rv”HuÁTim”
);

300 
	`tim”S¹
(
’½AÂounûTim”
, 
PEER_HEARTBEAT_CYCLE
);

304 ià(
£ndR•ly
) {

305 
	`logDebug
("ªsw”šg 0x%08x oÀ»¶y„equœed b™, usšg‡ssocId %d", 
£nd”S”v”Id
, 
ÃwAssocId
);

306 
	`£ndEÄpP»£nû
(
£nd”S”v”Id
, 0, 1, 
ÃwAssocId
);

310 
	}
}

313 
	$hªdËEÄpLi¡Reque¡
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

314 
»jeùB™
 = 0;

315 
’½Li¡Reque¡
 *
li¡
;

316 
Regi¡¿rS”v”
 
£rv”
;

317 
ušt32
 
£nd”S”v”Id
;

319 
	`logDebug
("gotƒnrp†ist„equest msg");

321 
li¡
 = (
’½Li¡Reque¡
 *è
buf
;

322 
£nd”S”v”Id
 = 
	`Áohl
(
li¡
->senderServerId);

323 ià(
£nd”S”v”Id
 =ğ
ownId
) {

324 
	`logDebug
("discarding own†ist„equest message");

328 ià(
»gi¡¿rS‹
 =ğ
INITIALIZING
)

329 
»jeùB™
 = 1;

331 ià((
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
£nd”S”v”Id
)è!ğ
NULL
)

332 
	`»gi¡¿rS”v”Re£tTim”
(
£rv”
);

334 
	`logDebug
("couldn'ˆfšd s”v” iÀ³”†i¡: 0x%08x", 
£nd”S”v”Id
);

338 
	`£ndEÄpLi¡Re¥Ú£
(
£nd”S”v”Id
, 
»jeùB™
, 
assocId
);

341 
	}
}

344 
	$hªdËEÄpLi¡Re¥Ú£
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

345 
’½Li¡Re¥Ú£
 *
li¡
;

346 
Regi¡¿rS”v”
 
£rv”
;

347 
·¿mS”v”InfÜm©iÚ
 *
¤vInfo
;

348 *
off£t
;

349 
size_t
 
bufSize
;

350 
ušt16
 
·¿mty³
;

351 
³”CÁ
 = 0;

352 
Add»ss
 
addrs
[
MAX_ADDR_CNT
];

353 
addrCÁ
;

354 
ušt16
 
pÜt
;

355 
ušt16
 
Œª¥ÜtU£
;

356 
ušt8
 
´ÙocŞ
;

357 
»t
;

358 
ušt32
 
£nd”S”v”Id
;

359 
ušt32
 
¤vInfoS”v”Id
;

361 
	`logDebug
("gotƒnrp†ist„esponse msg");

363 
li¡
 = (
’½Li¡Re¥Ú£
 *è
buf
;

364 
£nd”S”v”Id
 = 
	`Áohl
(
li¡
->senderServerId);

365 ià(
£nd”S”v”Id
 =ğ
ownId
) {

366 
	`logDebug
("discarding own†ist„equest message");

370 ià((
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
£nd”S”v”Id
)è!ğ
NULL
)

371 
	`»gi¡¿rS”v”Re£tTim”
(
£rv”
);

373 
	`logDebug
("couldn'ˆfšd s”v” iÀ³”†i¡: 0x%08x", 
£nd”S”v”Id
);

377 ià(
li¡
->
hdr
.
æags
 & 0x01) {

378 
	`logDebug
("li¡„eque¡ from 0x%08x wa »jeùed", 
£nd”S”v”Id
);

382 
off£t
 = (*è
buf
 + (
’½Li¡Re¥Ú£
);

383 
bufSize
 = 
	`Áohs
(
li¡
->
hdr
.
Ëngth
è- (
’½Li¡Re¥Ú£
);

385 (
·¿mty³
 = 
	`checkTLV
(
off£t
, 
bufSize
)è=ğ
PARAM_SERVER_INFORMATION
) {

386 
¤vInfo
 = (
·¿mS”v”InfÜm©iÚ
 *è
off£t
;

387 
off£t
 +ğ(
·¿mS”v”InfÜm©iÚ
);

388 
bufSize
 +ğ(
·¿mS”v”InfÜm©iÚ
);

389 
¤vInfoS”v”Id
 = 
	`Áohl
(
¤vInfo
->
£rv”Id
);

391 ià((
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
¤vInfoS”v”Id
)è=ğ
NULL
) {

392 ià(
¤vInfoS”v”Id
 !ğ
ownId
) {

393 
£rv”
 = 
	`»gi¡¿rS”v”New
(
¤vInfoS”v”Id
);

394 
	`»gi¡¿rS”v”Li¡AddS”v”
(
£rv”
);

396 
	`logDebug
("do‚ot‡dd own serverid");

399 
	`mem£t
(&
addrs
, 0, (addrs));

400 
addrCÁ
 = 0;

401 
pÜt
 = 0;

402 
Œª¥ÜtU£
 = 0;

403 
´ÙocŞ
 = 0;

405 
»t
 = 
	`£ndBufãrToT¿n¥ÜtAdd»s£s
(
off£t
, &
bufSize
, 
addrs
, &
addrCÁ
, &
pÜt
, &
Œª¥ÜtU£
, &
´ÙocŞ
);

406 ià(
»t
 < 0) {

409 ià(
´ÙocŞ
 =ğ
IPPROTO_SCTP
 && 
addrCÁ
 > 0) {

413 
	`memıy
(&
£rv”
->
rsEÄpAddr
, 
addrs
, (
Add»ss
è* 
addrCÁ
);

416 
³”CÁ
++;

420 
	}
}

423 
	$hªdËEÄpHªdËTabËReque¡
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

424 
ownB™
 = 0;

425 
»jeùB™
 = 0;

426 
’½HªdËTabËReque¡
 *
hªdË
;

427 
Regi¡¿rS”v”
 
£rv”
;

428 
ušt32
 
£nd”S”v”Id
;

429 
	`logDebug
("gotƒnrp handleable„equest msg");

431 
hªdË
 = (
’½HªdËTabËReque¡
 *è
buf
;

432 
£nd”S”v”Id
 = 
	`Áohl
(
hªdË
->senderServerId);

433 ià(
£nd”S”v”Id
 =ğ
ownId
) {

434 
	`logDebug
("discarding own handleabele„equest message");

438 ià(
»gi¡¿rS‹
 =ğ
INITIALIZING
)

439 
»jeùB™
 = 1;

441 ià(
hªdË
->
hdr
.
æags
 & 0x01)

442 
ownB™
 = 1;

444 ià((
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
£nd”S”v”Id
)è!ğ
NULL
)

445 
	`»gi¡¿rS”v”Re£tTim”
(
£rv”
);

447 
	`logDebug
("couldn'ˆfšd s”v” iÀ³”†i¡: 0x%08x\n", 
£nd”S”v”Id
);

451 
	`£ndEÄpHªdËTabËRe¥Ú£
(
£nd”S”v”Id
, 
ownB™
, 
»jeùB™
, 
assocId
);

453 
	}
}

456 
	$hªdËEÄpHªdËTabËRe¥Ú£
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

457 
’½HªdËTabËRe¥Ú£
 *
hªdË
;

458 
Regi¡¿rS”v”
 
£rv”
;

459 
PoŞEËm’t
 
³Ëm’t
;

460 
·¿mPoŞHªdË
 *
phªdË
;

461 
S”v”PoŞ
 
poŞ
;

462 *
off£t
;

463 
size_t
 
bufSize
;

464 
poŞhªdË
[
POOLHANDLE_SIZE
 + 1];

465 
ušt16
 
Ëngth
;

466 
ušt32
 
£nd”S”v”Id
;

468 
	`logDebug
("gotƒnrp handleable„equest msg");

470 
hªdË
 = (
’½HªdËTabËRe¥Ú£
 *è
buf
;

471 
£nd”S”v”Id
 = 
	`Áohl
(
hªdË
->senderServerId);

472 ià(
£nd”S”v”Id
 =ğ
ownId
) {

473 
	`logDebug
("discarding own handleabele„equest message");

477 ià(
hªdË
->
hdr
.
æags
 & 0x01) {

478 
	`logDebug
("handleable„equest was„ejected");

482 ià((
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
£nd”S”v”Id
)è!ğ
NULL
)

483 
	`»gi¡¿rS”v”Re£tTim”
(
£rv”
);

485 
	`logDebug
("couldn'ˆfšd s”v” iÀ³”†i¡: 0x%08x", 
£nd”S”v”Id
);

489 
off£t
 = (*è
buf
 + (
’½HªdËTabËRe¥Ú£
);

490 
bufSize
 = 
Ën
;

492 
	`mem£t
(
poŞhªdË
, 0, (poolhandle));

494 
	`checkTLV
(
off£t
, 
bufSize
è=ğ
PARAM_POOL_HANDLE
) {

495 
phªdË
 = (
·¿mPoŞHªdË
 *è
off£t
;

496 
Ëngth
 = 
	`Áohs
(
phªdË
->
hdr
.length);

497 
	`¡ºıy
(
poŞhªdË
, ((*è
phªdË
 + 4), 
Ëngth
 - 4);

498 ià(
Ëngth
 % 4 != 0)

499 
Ëngth
 += 4 - (length % 4);

500 
off£t
 +ğ
Ëngth
;

501 
bufSize
 -ğ
Ëngth
;

503 ià((
poŞ
 = 
	`£rv”PoŞLi¡G‘PoŞ
(
poŞhªdË
)è=ğ
NULL
) {

504 
poŞ
 = 
	`£rv”PoŞNew
(
poŞhªdË
);

505 
	`£rv”PoŞLi¡AddPoŞ
(
poŞ
);

508 
	`checkTLV
(
off£t
, 
bufSize
è=ğ
PARAM_POOL_ELEMENT
) {

509 
³Ëm’t
 = 
	`£ndBufãrToPoŞEËm’t
(
off£t
, &
bufSize
);

510 ià(
³Ëm’t
) {

511 ià(
	`£rv”PoŞG‘PoŞEËm’tById
(
poŞ
, 
³Ëm’t
->
³Id’tif›r
è=ğ
NULL
) {

512 
	`£rv”PoŞAddPoŞEËm’t
(
poŞ
, 
³Ëm’t
);

513 ià((
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
£nd”S”v”Id
)è!ğ
NULL
) {

514 
	`»gi¡¿rS”v”AddPoŞEËm’t
(
£rv”
, 
³Ëm’t
);

515 
	`logDebug
("added…oŞƒËm’ˆ0x%08xØ£rv” 0x%08x", 
³Ëm’t
->
³Id’tif›r
, 
£rv”
->
rsId’tif›r
);

518 
	`logDebug
("registrar is unknown?!");

522 
	`poŞEËm’tD–‘e
(
³Ëm’t
);

530 
	`£rv”PoŞLi¡Pršt
();

533 
	}
}

536 
	$hªdËEÄpHªdËUpd©e
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

537 
’½HªdËUpd©e
 *
hupd©e
;

538 
·¿mPoŞHªdË
 *
phªdË
;

539 
Regi¡¿rS”v”
 
£nd”S”v”
;

540 
Regi¡¿rS”v”
 
ÃwPoŞEËm’tS”v”
;

541 
Regi¡¿rS”v”
 
exi¡šgPoŞEËm’tS”v”
;

542 
PoŞEËm’t
 
ÃwPoŞEËm’t
 = 
NULL
;

543 
PoŞEËm’t
 
exi¡šgPoŞEËm’t
;

544 
S”v”PoŞ
 
poŞ
;

545 
ušt16
 
upd©eAùiÚ
;

546 *
off£t
;

547 
size_t
 
bufSize
;

548 
poŞhªdË
[
POOLHANDLE_SIZE
 + 1];

549 
ušt16
 
Ëngth
;

550 
ušt32
 
£nd”S”v”Id
;

552 
	`logDebug
("gotƒnrp handle update msg");

554 
hupd©e
 = (
’½HªdËUpd©e
 *è
buf
;

555 
£nd”S”v”Id
 = 
	`Áohl
(
hupd©e
->senderServerId);

556 
upd©eAùiÚ
 = 
	`Áohs
(
hupd©e
->updateAction);

557 ià(
£nd”S”v”Id
 =ğ
ownId
) {

558 
	`logDebug
("discarding own handle update message");

562 ià((
£nd”S”v”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
£nd”S”v”Id
)è!ğ
NULL
)

563 
	`»gi¡¿rS”v”Re£tTim”
(
£nd”S”v”
);

565 
	`logDebug
("couldn'ˆfšd s”v” iÀ³”†i¡: 0x%08x", 
£nd”S”v”Id
);

569 
off£t
 = (*è
buf
 +  (*
hupd©e
);

570 
bufSize
 = 
Ën
 -  (*
hupd©e
);

572 
	`mem£t
(
poŞhªdË
, 0, (poolhandle));

574 ià(
	`checkTLV
(
off£t
, 
bufSize
è=ğ
PARAM_POOL_HANDLE
) {

575 
phªdË
 = (
·¿mPoŞHªdË
 *è
off£t
;

576 
Ëngth
 = 
	`Áohs
(
phªdË
->
hdr
.length);

577 
	`¡ºıy
(
poŞhªdË
, ((*è
phªdË
 + 4), 
Ëngth
 - 4);

578 ià((
Ëngth
 % 4) != 0)

579 
Ëngth
 += 4 - (length % 4);

580 
off£t
 +ğ
Ëngth
;

581 
bufSize
 -ğ
Ëngth
;

582 
poŞ
 = 
	`£rv”PoŞLi¡G‘PoŞ
(
poŞhªdË
);

583 ià(
poŞ
 =ğ
NULL
) {

584 
poŞ
 = 
	`£rv”PoŞNew
(
poŞhªdË
);

585 
	`£rv”PoŞLi¡AddPoŞ
(
poŞ
);

588 ià(
	`checkTLV
(
off£t
, 
bufSize
è=ğ
PARAM_POOL_ELEMENT
) {

589 
ÃwPoŞEËm’t
 = 
	`£ndBufãrToPoŞEËm’t
(
off£t
, &
bufSize
);

593 ià(
ÃwPoŞEËm’t
 =ğ
NULL
) {

594 
	`logDebug
("bad handle update message");

599 
	`£rv”PoŞLi¡Pršt
();

600 
	`»gi¡¿rS”v”Li¡Pršt
();

603 
ÃwPoŞEËm’tS”v”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
ÃwPoŞEËm’t
->
³HomeRegi¡¿rS”v”
);

604 
exi¡šgPoŞEËm’t
 = 
	`£rv”PoŞG‘PoŞEËm’tById
(
poŞ
, 
ÃwPoŞEËm’t
->
³Id’tif›r
);

605 ià(
exi¡šgPoŞEËm’t
) {

606 
exi¡šgPoŞEËm’tS”v”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
exi¡šgPoŞEËm’t
->
³HomeRegi¡¿rS”v”
);

609 
exi¡šgPoŞEËm’tS”v”
 = 
NULL
;

612 ià((
exi¡šgPoŞEËm’t
) &&

613 ((
upd©eAùiÚ
 =ğ
ENRP_UPDATE_ACTION_DEL_PE
) ||

614 (
upd©eAùiÚ
 =ğ
ENRP_UPDATE_ACTION_ADD_PE
))) {

615 ià(
exi¡šgPoŞEËm’tS”v”
) {

616 
	`»gi¡¿rS”v”RemovePoŞEËm’t
(
exi¡šgPoŞEËm’tS”v”
, 
exi¡šgPoŞEËm’t
);

618 
	`£rv”PoŞRemovePoŞEËm’t
(
poŞ
, 
exi¡šgPoŞEËm’t
->
³Id’tif›r
);

619 
exi¡šgPoŞEËm’t
 = 
NULL
;

621 ià(
upd©eAùiÚ
 =ğ
ENRP_UPDATE_ACTION_ADD_PE
) {

622 
	`£rv”PoŞAddPoŞEËm’t
(
poŞ
, 
ÃwPoŞEËm’t
);

623 ià(
ÃwPoŞEËm’tS”v”
) {

624 
	`»gi¡¿rS”v”AddPoŞEËm’t
(
ÃwPoŞEËm’tS”v”
, 
ÃwPoŞEËm’t
);

626 
ÃwPoŞEËm’t
 = 
NULL
;

628 ià(
upd©eAùiÚ
 !ğ
ENRP_UPDATE_ACTION_DEL_PE
) {

629 
	`logDebug
("bad update‡ction");

632 ià(
ÃwPoŞEËm’t
) {

633 
	`poŞEËm’tD–‘e
(
ÃwPoŞEËm’t
);

636 
	`£rv”PoŞLi¡Pršt
();

638 
	}
}

641 
	$hªdËEÄpIn™Takeov”
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

642 
’½In™Takeov”
 *
msg
;

643 
Regi¡¿rS”v”
 
rg‘S”v”
 = 
NULL
;

644 
Takeov”
 
keov”
;

645 
£ndAck
 = 0;

646 
ušt32
 
£nd”S”v”Id
;

647 
ušt32
 
rg‘S”v”Id
;

648 
ušt32
 
»ûiv”S”v”Id
;

650 
	`logDebug
("gotƒnrp initakeover msg");

652 
msg
 = (
’½In™Takeov”
 *è
buf
;

653 
£nd”S”v”Id
 = 
	`Áohl
(
msg
->senderServerId);

654 
rg‘S”v”Id
 = 
	`Áohl
(
msg
->targetServerId);

655 
»ûiv”S”v”Id
 = 
	`Áohl
(
msg
->receiverServerId);

657 
	`logDebug
("£nd”S”v”Id: 0x%08x", 
£nd”S”v”Id
);

658 
	`logDebug
("rg‘S”v”Id: 0x%08x", 
rg‘S”v”Id
);

660 ià(
£nd”S”v”Id
 =ğ
ownId
) {

661 
	`logDebug
("discarding own initakeover message");

665 ià(
rg‘S”v”Id
 =ğ
ownId
) {

666 
	`logDebug
("somebody isryingo overtake us");

667 
	`£ndEÄpP»£nû
(0, 0, 0, 0);

671 
keov”
 = 
	`keov”Lookup
(
rg‘S”v”Id
);

673 ià(
keov”
 =ğ
NULL
)

674 
£ndAck
 = 1;

676 ià(
£nd”S”v”Id
 < 
ownId
)

677 
£ndAck
 = 1;

679 
£ndAck
 = 0;

682 ià(
£ndAck
) {

684 
rg‘S”v”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
rg‘S”v”Id
);

685 ià(
rg‘S”v”
 !ğ
NULL
) {

686 
	`logDebug
("m¬kšg 0x%08x‡ nÙ‡ùive", 
rg‘S”v”
->
rsId’tif›r
);

687 
rg‘S”v”
->
rsAùive
 = 0;

690 
	`£ndEÄpIn™Takeov”Ack
(
»ûiv”S”v”Id
, 
rg‘S”v”Id
, 
assocId
);

692 
	`logDebug
("rg‘£rv” 0x%08x i nÙ iÀ³”†i¡", 
rg‘S”v”Id
);

694 
	`logDebug
("ignoring initakeover message");

697 
	}
}

700 
	$hªdËEÄpIn™Takeov”Ack
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

701 
’½In™Takeov”Ack
 *
msg
;

702 
Takeov”
 
keov”
;

703 
ušt32
 
£nd”S”v”Id
;

704 
ušt32
 
rg‘S”v”Id
;

706 
	`logDebug
("gotƒnrp initakeover‡ck msg");

708 
msg
 = (
’½In™Takeov”Ack
 *è
buf
;

709 
£nd”S”v”Id
 = 
	`Áohl
(
msg
->senderServerId);

710 
rg‘S”v”Id
 = 
	`Áohl
(
msg
->targetServerId);

711 
	`logDebug
("£nd”S”v”Id: 0x%08x", 
£nd”S”v”Id
);

712 
	`logDebug
("rg‘S”v”Id: 0x%08x", 
rg‘S”v”Id
);

714 ià(
£nd”S”v”Id
 =ğ
ownId
) {

715 
	`logDebug
("discarding own initakeover‡ck message!");

719 ià(
rg‘S”v”Id
 =ğ
ownId
) {

720 
	`logDebug
("abortakeover by sending…resence");

721 
	`£ndEÄpP»£nû
(0, 0, 1, 0);

725 
keov”
 = 
	`keov”Lookup
(
rg‘S”v”Id
);

726 ià(
keov”
 =ğ
NULL
) {

727 
	`logDebug
("unknownakeoverarget");

731 
	`keov”AckS”v”
(
keov”
, 
£nd”S”v”Id
);

734 
	}
}

737 
	$hªdËEÄpTakeov”S”v”
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

738 
’½Takeov”S”v”
 *
msg
;

739 
Regi¡¿rS”v”
 
rg‘S”v”
 = 
NULL
;

740 
Regi¡¿rS”v”
 
keov”S”v”
 = 
NULL
;

741 
PoŞEËm’t
 
–em’t
;

742 
ušt32
 
£nd”S”v”Id
;

743 
ušt32
 
rg‘S”v”Id
;

745 
	`logDebug
("gotƒnrpakeover server msg");

747 
msg
 = (
’½Takeov”S”v”
 *è
buf
;

748 
£nd”S”v”Id
 = 
	`Áohl
(
msg
->senderServerId);

749 
rg‘S”v”Id
 = 
	`Áohl
(
msg
->targetServerId);

750 
	`logDebug
("£nd”S”v”Id: 0x%08x", 
£nd”S”v”Id
);

751 
	`logDebug
("rg‘S”v”Id: 0x%08x", 
rg‘S”v”Id
);

753 ià(
£nd”S”v”Id
 =ğ
ownId
) {

754 
	`logDebug
("discarding ownakeover server message!");

758 ià(
rg‘S”v”Id
 =ğ
ownId
) {

759 
	`logDebug
("abortakeover by sending…resence");

760 
	`£ndEÄpP»£nû
(0, 0, 1, 0);

764 
rg‘S”v”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
rg‘S”v”Id
);

765 ià(
rg‘S”v”
 =ğ
NULL
) {

766 
	`logDebug
("rg‘ s”v” 0x%08x i nÙ iÀli¡", 
rg‘S”v”Id
);

770 
keov”S”v”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
£nd”S”v”Id
);

771 ià(
keov”S”v”
 =ğ
NULL
) {

772 
	`logDebug
("keov” s”v” 0x%08x i nÙ iÀli¡", 
£nd”S”v”Id
);

776 
–em’t
 = 
rg‘S”v”
->
rsPeLi¡
;

777 
	`logDebug
("movšg‡Î…oŞƒËm’t äom 0x%08xØ0x%08x", 
rg‘S”v”
->
rsId’tif›r
, 
keov”S”v”
->rsIdentifier);

778 ; 
–em’t
 !ğ
NULL
;ƒËm’ˆğ–em’t->
£rv”Next
) {

779 
	`»gi¡¿rS”v”RemovePoŞEËm’t
(
rg‘S”v”
, 
–em’t
);

780 
	`»gi¡¿rS”v”AddPoŞEËm’t
(
keov”S”v”
, 
–em’t
);

783 
	`»gi¡¿rS”v”Li¡RemoveS”v”
(
rg‘S”v”
->
rsId’tif›r
);

784 
	`»gi¡¿rS”v”D–‘e
(
rg‘S”v”
);

787 
	}
}

790 
	$£ndEÄpMsg
(*
buf
, 
size_t
 
Ën
, 
sùp_assoc_t
 
assocId
, 
ªnounûm’t
) {

791 
£ÁL’
 = 0;

792 
sùp_¢drcvšfo
 
sšfo
;

794 ià(!
buf
) {

795 
	`logDebug
("buf is NULL");

799 ià(
Ën
 < 12) {

800 
	`logDebug
("ËÀi toØsm®È%d,‡bÜtšg", (è
Ën
);

804 ià(
ªnounûm’t
) {

805 
	`logDebug
("sending‡s‡nnouncement");

806  
	`£ndEÄpAÂounûMsg
(
buf
, 
Ën
);

815 
	`mem£t
(&
sšfo
, 0, (sinfo));

816 
sšfo
.
sšfo_assoc_id
 = 
assocId
;

817 
sšfo
.
sšfo_µid
 = 
	`htÚl
(
ENRP_SCTP_PPID
);

819 ià((
£ÁL’
 = 
	`sùp_£nd
(
’½SùpFd
, (*)
buf
, 
Ën
, &
sšfo
,

820 #ifdeà
MSG_NOSIGNAL


821 
MSG_NOSIGNAL


826 
	`logDebug
("sùp_£ndØ%d faed", 
assocId
);

827 
	`³¼Ü
("sctp_send");

831 
	`logDebug
("£Á msg vŸ‡ssocid %d. sùp_£nd„‘uºed: %d", 
assocId
, 
£ÁL’
);

832  
£ÁL’
;

833 
	}
}

835 
ssize_t


836 
	$£ndEÄpAÂounûMsg
(*
buf
, 
size_t
 
msgL’
) {

837 
Regi¡¿rS”v”
 
£rv”
;

838 
’½MsgH—d”
 *
hdr
;

839 
sockaddr_š
 
š4
;

840 
sockaddr_š6
 
š6
;

841 
sùp_¢drcvšfo
 
sšfo
;

842 
ssize_t
 
£ÁL’
 = -1;

844 
’½AÂounûAddr
.
ty³
) {

845 
AF_INET
:

846 
	`mem£t
(&
š4
, 0, (in4));

847 
š4
.
sš_çmy
 = 
AF_INET
;

848 
š4
.
sš_addr
 = 
’½AÂounûAddr
.
addr
.in4;

849 
š4
.
sš_pÜt
 = 
	`htÚs
(
’½AÂounûPÜt
);

850 #ifdeà
HAVE_SIN_LEN


851 
š4
.
sš_Ën
 = (
sockaddr_š
);

854 ià((
£ÁL’
 = 
	`£ndto
(
’½UdpS’dFd
, (cÚ¡ *)
buf
, 
msgL’
, 0, (cÚ¡ 
sockaddr
 *è&
š4
, (
sockaddr_š
))) < 0)

855 
	`³¼Ü
("sendto: ipv4 send…resence‡nnouncment failed");

858 
AF_INET6
:

859 
	`mem£t
(&
š6
, 0, (in6));

860 
š6
.
sš6_çmy
 = 
AF_INET6
;

861 
š6
.
sš6_addr
 = 
’½AÂounûAddr
.
addr
.in6;

862 
š6
.
sš6_pÜt
 = 
	`htÚs
(
’½AÂounûPÜt
);

863 #ifdeà
HAVE_SIN6_LEN


864 
š6
.
sš6_Ën
 = (
sockaddr_š6
);

867 ià((
£ÁL’
 = 
	`£ndto
(
’½UdpS’dFd
, (cÚ¡ *)
buf
, 
msgL’
, 0, (cÚ¡ 
sockaddr
 *è&
š6
, (
sockaddr_š6
))) < 0)

868 
	`³¼Ü
("sendto: ipv6 send…resence‡nnouncment failed");

872 
	`logDebug
("enrp‡nnounce‡ddr is uninitialized! EXIT!!!");

873 
	`ex™
(-1);

876 
	`mem£t
(&
sšfo
, 0, (sinfo));

877 
sšfo
.
sšfo_µid
 = 
	`htÚl
(
ENRP_SCTP_PPID
);

879 
£rv”
 = 
»gi¡¿rS”v”Li¡
; s”v”; s”v” = s”v”->
Ãxt
) {

880 ià(
£rv”
->
rsId’tif›r
 =ğ
ownId
)

883 
hdr
 = (
’½MsgH—d”
 *è
buf
;

884 
hdr
->
»ûiv”S”v”Id
 = 
	`htÚl
(
£rv”
->
rsId’tif›r
);

885 
	`logDebug
("ŒyØ£nd…»£nûØ0x%08x vŸ %d", 
£rv”
->
rsId’tif›r
, s”v”->
rsEÄpAssocId
 );

886 
sšfo
.
sšfo_assoc_id
 = 
£rv”
->
rsEÄpAssocId
;

888 ià((
£ÁL’
 = 
	`sùp_£nd
(
’½SùpFd
, (cÚ¡ *è
buf
, 
msgL’
, &
sšfo
,

889 #ifdeà
MSG_NOSIGNAL


890 
MSG_NOSIGNAL


895 
	`³¼Ü
("sctp_send: send…resence‡nnouncment failed");

898  
£ÁL’
;

899 
	}
}

901 
ssize_t


902 
	$£ndEÄpMsgToAÎ
(*
buf
, 
size_t
 
msgL’
) {

903 
Regi¡¿rS”v”
 
£rv”
;

904 
’½MsgH—d”
 *
hdr
;

905 
sùp_¢drcvšfo
 
sšfo
;

906 
ssize_t
 
£ÁL’
 = -1;

907 
i
, 
addrCÁ
;

908 
addrBuf
[
MAX_ADDR_CNT
 * (
sockaddr_š6
)];

910 
	`mem£t
(&
sšfo
, 0, (sinfo));

911 
sšfo
.
sšfo_µid
 = 
	`htÚl
(
ENRP_SCTP_PPID
);

913 
£rv”
 = 
»gi¡¿rS”v”Li¡
; s”v”; s”v” = s”v”->
Ãxt
) {

914 ià(
£rv”
->
rsId’tif›r
 =ğ
ownId
)

917 
hdr
 = (
’½MsgH—d”
 *è
buf
;

918 
hdr
->
»ûiv”S”v”Id
 = 
	`htÚl
(
£rv”
->
rsId’tif›r
);

919 
	`logDebug
("ŒyØ£nd…»£nûØ0x%08x", 
£rv”
->
rsId’tif›r
);

920 
sšfo
.
sšfo_assoc_id
 = 
£rv”
->
rsEÄpAssocId
;

922 
addrCÁ
 = 0;

923 
i
 = 0; i < 
MAX_ADDR_CNT
; i++) {

924 ià((
£rv”
->
rsEÄpAddr
[
i
].
ty³
 =ğ
AF_INET
) ||

925 (
£rv”
->
rsEÄpAddr
[
i
].
ty³
 =ğ
AF_INET6
)) {

926 
addrCÁ
++;

929 ià(
addrCÁ
 < 1) {

930 
	`logDebug
("no ENRP‡ddress?");

935 ià(
	`add»s£sToSysC®lBufãr
((
Add»ss
*)&
£rv”
->
rsEÄpAddr
, s”v”->
rsEÄpPÜt
, 
addrCÁ
, 
addrBuf
) !=‡ddrCnt) {

936 
	`logDebug
("address…arsing failed,‡bort");

940 ià((
£ÁL’
 = 
	`sùp_£ndx
(
’½SùpFd
, (*è
buf
, 
msgL’
,

941 (
sockaddr
 *)&
addrBuf
, 
addrCÁ
, &
sšfo
,

942 #ifdeà
MSG_NOSIGNAL


943 
MSG_NOSIGNAL


948 
	`³¼Ü
("sctp_sendx");

952  
£ÁL’
;

953 
	}
}

956 
	$£ndEÄpP»£nû
(
ušt32
 
»ûiv”Id
, 
»¶yB™
, 
£ndInfo
, 
sùp_assoc_t
 
assocId
) {

957 
’½P»£nû
 *
´es
;

958 
·¿mS”v”InfÜm©iÚ
 *
¤vInfo
;

959 
buf
[
BUFFER_SIZE
];

960 *
off£t
;

961 
size_t
 
msgL’
, 
£ÁL’
;

962 
Ëngth
;

964 
	`logDebug
("»ûiv”Id: 0x%08x", 
»ûiv”Id
);

965 
	`logDebug
("»¶yB™: %d", 
»¶yB™
);

966 
	`logDebug
("£ndInfo: %d", 
£ndInfo
);

967 
	`logDebug
("assocId: %d", 
assocId
);

969 
	`mem£t
(
buf
, 0, 
BUFFER_SIZE
);

970 
off£t
 = (*)
buf
;

972 
´es
 = (
’½P»£nû
 *è
off£t
;

973 
	`š™EÄpP»£nû
(
´es
, 
»ûiv”Id
, 
»¶yB™
);

974 
	`logDebug
("owÀchecksum is: 0x%08x", 
	`»gi¡¿rS”v”G‘Checksum
(
ownId
));

975 
	`š™P¬amPeChecksum
(&
´es
->
³Checksum
, 
	`»gi¡¿rS”v”G‘Checksum
(
ownId
));

976 
off£t
 +ğ(*
´es
);

978 ià(
£ndInfo
) {

979 
¤vInfo
 = (
·¿mS”v”InfÜm©iÚ
 *è
off£t
;

980 
	`š™P¬amS”v”InfÜm©iÚ
(
¤vInfo
, 
u£EÄpAÂounûm’ts
, 
ownId
);

981 
off£t
 +ğ(*
¤vInfo
);

983 
Ëngth
 = 
	`Œª¥ÜtAdd»s£sToS’dBufãr
(
off£t
, 
this
->
rsEÄpAddr
,his->
rsEÄpPÜt
, 
TRANSPORT_USE_DATA_ONLY
, 
IPPROTO_SCTP
);

984 
	`logDebug
("Ëngth oàŒª¥Üˆadd»s ·¿m‘” i %d", 
Ëngth
);

986 ià(
Ëngth
 == -1) {

987 
	`logDebug
("addresso buffer conversion failed, omitting server information…arameter");

988 
off£t
 = (*è
´es
 + (*pres);

990 
off£t
 +ğ
Ëngth
;

991 
¤vInfo
->
hdr
.
Ëngth
 = 
	`htÚs
((
ušt16
èËngth + 
	`Áohs
(srvInfo->hdr.length));

992 
´es
->
hdr
.
Ëngth
 = 
	`htÚs
(
	`Áohs
Õ»s->hdr.Ëngthè+‚tohs(
¤vInfo
->hdr.length));

996 
msgL’
 = 
off£t
 - 
buf
;

997 ià((
msgL’
 - 
	`Áohs
(
´es
->
hdr
.
Ëngth
)) != 0)

998 
	`logDebug
("sth's wrong: calculated size does‚ot match buffer†ength");

1000 
	`´štBuf
(
buf
, 
msgL’
, "enrp…resence send buffer");

1003 
£ÁL’
 = 
	`£ndEÄpMsg
(
buf
, 
msgL’
, 
assocId
, 
»ûiv”Id
 == 0);

1004 
	`logDebug
("£ÁƒÄ°´e£nûØ0x%08x", 
»ûiv”Id
);

1006  (
£ÁL’
 =ğ
msgL’
) ? 1 : 0;

1007 
	}
}

1010 
	$£ndEÄpLi¡Reque¡
(
ušt32
 
»ûiv”Id
, 
sùp_assoc_t
 
assocId
) {

1011 
’½Li¡Reque¡
 *
msg
;

1012 
buf
[
BUFFER_SIZE
];

1013 
size_t
 
msgL’
;

1014 
»t
;

1016 
	`mem£t
(
buf
, 0, (buf));

1017 
msg
 = (
’½Li¡Reque¡
 *è
buf
;

1018 
msgL’
 = 
	`š™EÄpLi¡Reque¡
(
msg
, 
»ûiv”Id
);

1020 
	`´štBuf
(
buf
, 
msgL’
, "enrp†ist„equest send buffer");

1022 
»t
 = 
	`£ndEÄpMsg
(
buf
, 
msgL’
, 
assocId
, 0);

1023 
	`logDebug
("£ÁƒÄ°li¡„eque¡Ø0x%08x", 
»ûiv”Id
);

1025  (
»t
 =ğ()
msgL’
) ? 1 : -1;

1026 
	}
}

1029 
	$£ndEÄpLi¡Re¥Ú£
(
ušt32
 
»ûiv”Id
, 
»jeùB™
, 
sùp_assoc_t
 
assocId
) {

1030 
Regi¡¿rS”v”
 
£rv”
;

1031 
’½Li¡Re¥Ú£
 *
»¥Ú£
;

1032 
·¿mS”v”InfÜm©iÚ
 *
¤vInfo
;

1033 
buf
[
BUFFER_SIZE
];

1034 *
off£t
;

1035 
size_t
 
msgL’
;

1036 
»t
;

1037 
Ëngth
;

1039 
	`mem£t
(
buf
, 0, 
BUFFER_SIZE
);

1040 
off£t
 = (*è
buf
;

1042 
»¥Ú£
 = (
’½Li¡Re¥Ú£
 *è
off£t
;

1043 
msgL’
 = 
	`š™EÄpLi¡Re¥Ú£
(
»¥Ú£
, 
»ûiv”Id
, 
»jeùB™
);

1044 
off£t
 +ğ(
’½Li¡Re¥Ú£
);

1046 ià(!
»jeùB™
) {

1047 
£rv”
 = 
»gi¡¿rS”v”Li¡
; s”v”; s”v” = s”v”->
Ãxt
) {

1048 ià(
£rv”
->
rsAùive
 == 0) {

1049 
	`logDebug
("skpšg iÇùiv£rv” 0x%08x", 
£rv”
->
rsId’tif›r
);

1052 
	`logDebug
("addšg s”v” infÜm©iÚ fÜ 0x%08x ", 
£rv”
->
rsId’tif›r
);

1053 
¤vInfo
 = (
·¿mS”v”InfÜm©iÚ
 *è
off£t
;

1054 
	`š™P¬amS”v”InfÜm©iÚ
(
¤vInfo
, 
£rv”
->
rsU£sMuÉiCa¡
, s”v”->
rsId’tif›r
);

1055 
off£t
 +ğ(*
¤vInfo
);

1057 
Ëngth
 = 
	`Œª¥ÜtAdd»s£sToS’dBufãr
(
off£t
, 
£rv”
->
rsEÄpAddr
, s”v”->
rsEÄpPÜt
, 
TRANSPORT_USE_DATA_ONLY
, 
IPPROTO_SCTP
);

1058 
	`logDebug
("Ëngth oàŒª¥Üˆadd»s ·¿m‘” i %d", 
Ëngth
);

1060 ià(
Ëngth
 == -1) {

1061 
	`logDebug
("addresso buffer conversion failed, omitting server information…arameter");

1062 
off£t
 = (*è
»¥Ú£
 + (*response);

1064 
off£t
 +ğ
Ëngth
;

1065 
¤vInfo
->
hdr
.
Ëngth
 = 
	`htÚs
((
ušt16
èËngth + 
	`Áohs
(srvInfo->hdr.length));

1066 
»¥Ú£
->
hdr
.
Ëngth
 = 
	`htÚs
(
	`Áohs
Ôe¥Ú£->hdr.Ëngthè+‚tohs(
¤vInfo
->hdr.length));

1071 
msgL’
 = 
off£t
 - 
buf
;

1072 
»¥Ú£
->
hdr
.
Ëngth
 = 
	`htÚs
(
msgL’
);

1074 
	`´štBuf
(
buf
, 
msgL’
, "enrp†ist„esponse send buffer");

1076 
»t
 = 
	`£ndEÄpMsg
(
buf
, 
msgL’
, 
assocId
, 0);

1077 
	`logDebug
("£ÁƒÄ°li¡„e¥Ú£Ø0x%08x", 
»ûiv”Id
);

1079  (
»t
 =ğ()
msgL’
) ? 1 : -1;

1080 
	}
}

1083 
	$£ndEÄpHªdËTabËReque¡
(
ušt32
 
»ûiv”Id
, 
ownB™
, 
sùp_assoc_t
 
assocId
) {

1084 
’½HªdËTabËReque¡
 *
msg
;

1085 
buf
[
BUFFER_SIZE
];

1086 
size_t
 
msgL’
;

1087 
»t
;

1089 
msg
 = (
’½HªdËTabËReque¡
 *è
buf
;

1090 
msgL’
 = 
	`š™EÄpHªdËTabËReque¡
(
msg
, 
»ûiv”Id
, 
ownB™
);

1092 
	`´štBuf
(
buf
, 
msgL’
, "enrp†ist„equest send buffer")

1094 
»t
 = 
	`£ndEÄpMsg
(
buf
, 
msgL’
, 
assocId
, 0);

1095 
	`logDebug
("£ÁƒÄ°hªdËabË„eque¡Ø0x%08x", 
»ûiv”Id
);

1096  (
»t
 =ğ()
msgL’
) ? 1 : -1;

1097 
	}
}

1100 
	$£ndEÄpHªdËTabËRe¥Ú£
(
ušt32
 
»ûiv”Id
, 
mÜeB™
, 
»jeùB™
, 
sùp_assoc_t
 
assocId
) {

1101 
’½HªdËTabËRe¥Ú£
 *
msg
;

1102 
buf
[
BUFFER_SIZE
];

1103 
size_t
 
msgL’
;

1104 
S”v”PoŞ
 
poŞ
;

1105 
PoŞEËm’t
 
³Ëm’t
;

1106 *
off£t
;

1107 
·¿mPoŞHªdË
 *
phªdË
;

1108 
»t
;

1109 
Ëngth
;

1110 
addedPoŞEËm’t
;

1112 
msg
 = (
’½HªdËTabËRe¥Ú£
 *è
buf
;

1113 
off£t
 = (*è
msg
;

1114 
msgL’
 = 
	`š™EÄpHªdËTabËRe¥Ú£
(
msg
, 
»ûiv”Id
, 0, 
»jeùB™
);

1115 
off£t
 +ğ(
’½HªdËTabËRe¥Ú£
);

1117 
poŞ
 = 
£rv”PoŞLi¡
;…oŞ;…oŞ =…oŞ->
Ãxt
) {

1118 
addedPoŞEËm’t
 = 0;

1119 
phªdË
 = (
·¿mPoŞHªdË
 *è
off£t
;

1120 
off£t
 +ğ
	`š™P¬amPoŞHªdË
(
phªdË
, 
poŞ
->
¥HªdË
);

1122 
³Ëm’t
 = 
poŞ
->
¥PeLi¡
;…–em’t;…–em’ˆğ³Ëm’t->
poŞNext
) {

1123 
Ëngth
 = 
	`poŞEËm’tToS’dBufãr
(
³Ëm’t
, 
off£t
);

1124 ià(
Ëngth
 != -1) {

1125 
addedPoŞEËm’t
 = 1;

1126 
off£t
 +ğ
Ëngth
;

1128 
	`logDebug
("added…oŞƒËm’ˆ0x%08xØ£nd bufãr", 
³Ëm’t
->
³Id’tif›r
);

1129 
	`poŞEËm’tPršt
(
³Ëm’t
);

1132 ià(
addedPoŞEËm’t
 == 0) {

1133 
	`logDebug
("did‚ot‡dd‡ny…oolƒlementso send buffer");

1137 
msgL’
 = 
off£t
 - 
buf
;

1138 
msg
->
hdr
.
Ëngth
 = 
	`htÚs
(
msgL’
);

1140 
	`´štBuf
(
buf
, 
msgL’
, "enrp handleable„esponse send buffer");

1142 
»t
 = 
	`£ndEÄpMsg
(
buf
, 
msgL’
, 
assocId
, 0);

1143 
	`logDebug
("£ÁƒÄ°hªdËabË„e¥Ú£Ø0x%08x", 
»ûiv”Id
);

1145  (
»t
 =ğ()
msgL’
) ? 1 : -1;

1146 
	}
}

1149 
	$£ndEÄpHªdËUpd©e
(
S”v”PoŞ
 
poŞ
, 
PoŞEËm’t
 
–em’t
, 
ušt16
 
hªdËAùiÚ
) {

1150 
’½HªdËUpd©e
 *
msg
;

1151 
·¿mPoŞHªdË
 *
pHªdË
;

1152 
buf
[
BUFFER_SIZE
];

1153 
size_t
 
msgL’
 = 0;

1154 *
off£t
;

1155 
Ëngth
;

1156 
»t
;

1158 ià(
poŞ
 =ğ
NULL
) {

1159 
	`logDebug
("pool is NULL,‡borting");

1163 ià(
–em’t
 =ğ
NULL
) {

1164 
	`logDebug
("element is NULL,‡borting");

1168 ià(!(
hªdËAùiÚ
 =ğ
ENRP_UPDATE_ACTION_ADD_PE
 ||

1169 
hªdËAùiÚ
 =ğ
ENRP_UPDATE_ACTION_DEL_PE
)) {

1170 
	`logDebug
("unknowÀhªdË upd©aùiÚ: 0x%04x", 
hªdËAùiÚ
);

1174 
	`mem£t
(
buf
, 0, (buf));

1175 
off£t
 = 
buf
;

1177 
msg
 = (
’½HªdËUpd©e
 *è
buf
;

1178 
	`š™EÄpHªdËUpd©e
(
msg
, 0, 
hªdËAùiÚ
);

1179 
off£t
 +ğ(
’½HªdËUpd©e
);

1181 
pHªdË
 = (
·¿mPoŞHªdË
 *è
off£t
;

1182 
Ëngth
 = 
	`š™P¬amPoŞHªdË
(
pHªdË
, 
poŞ
->
¥HªdË
);

1183 
off£t
 +ğ
Ëngth
;

1185 
Ëngth
 = 
	`poŞEËm’tToS’dBufãr
(
–em’t
, 
off£t
);

1186 ià(
Ëngth
 != -1) {

1187 
off£t
 +ğ
Ëngth
;

1189 
	`logDebug
("added…oŞƒËm’ˆ0x%08xØ£nd bufãr", 
–em’t
->
³Id’tif›r
);

1190 
	`poŞEËm’tPršt
(
–em’t
);

1193 
msgL’
 = 
off£t
 - 
buf
;

1194 
msg
->
hdr
.
Ëngth
 = 
	`htÚs
(
msgL’
);

1196 
	`´štBuf
(
buf
, 
msgL’
, "enrp handle update send buffer");

1198 
»t
 = 
	`£ndEÄpMsg
(
buf
, 
msgL’
, 0, 1);

1200  (
»t
 =ğ(è
msgL’
) ? 1 : -1;

1201 
	}
}

1204 
	$£ndEÄpIn™Takeov”
(
ušt32
 
»ûiv”Id
, ušt32 
rg‘Id
, 
sùp_assoc_t
 
assocId
) {

1205 
’½In™Takeov”
 *
msg
;

1206 
buf
[
BUFFER_SIZE
];

1207 
size_t
 
msgL’
;

1208 
»t
;

1210 
msg
 = (
’½In™Takeov”
 *è
buf
;

1211 
msgL’
 = 
	`š™EÄpIn™Takeov”
(
msg
, 
»ûiv”Id
, 
rg‘Id
);

1213 
	`´štBuf
(
buf
, 
msgL’
, "enrp initakeover‡ck send buffer");

1215 
»t
 = 
	`£ndEÄpMsgToAÎ
(
buf
, 
msgL’
);

1216 
	`logDebug
("sentƒnrp initakeover‡s‡nnouncement");

1218  (
»t
 =ğ()
msgL’
) ? 1 : -1;

1219 
	}
}

1222 
	$£ndEÄpIn™Takeov”Ack
(
ušt32
 
»ûiv”Id
, ušt32 
rg‘Id
, 
sùp_assoc_t
 
assocId
) {

1223 
’½In™Takeov”Ack
 *
msg
;

1224 
buf
[
BUFFER_SIZE
];

1225 
size_t
 
msgL’
;

1226 
»t
;

1228 
msg
 = (
’½In™Takeov”Ack
 *è
buf
;

1229 
msgL’
 = 
	`š™EÄpIn™Takeov”Ack
(
msg
, 
»ûiv”Id
, 
rg‘Id
);

1231 
	`´štBuf
(
buf
, 
msgL’
, "enrp initakeover‡ck send buffer");

1233 
»t
 = 
	`£ndEÄpMsg
(
buf
, 
msgL’
, 
assocId
, 0);

1234 
	`logDebug
("£ÁƒÄ°š™akeov”‡ckØ0x%08x", 
»ûiv”Id
);

1236  (
»t
 =ğ()
msgL’
) ? 1 : -1;

1237 
	}
}

1240 
	$£ndEÄpTakeov”S”v”
(
ušt32
 
»ûiv”Id
, ušt32 
rg‘Id
, 
sùp_assoc_t
 
assocId
) {

1241 
’½Takeov”S”v”
 *
msg
;

1242 
buf
[
BUFFER_SIZE
];

1243 
size_t
 
msgL’
;

1244 
»t
;

1246 
msg
 = (
’½Takeov”S”v”
 *è
buf
;

1247 
msgL’
 = 
	`š™EÄpTakeov”S”v”
(
msg
, 
»ûiv”Id
, 
rg‘Id
);

1249 
	`´štBuf
(
buf
, 
msgL’
, "enrpakeover server send buffer");

1251 
»t
 = 
	`£ndEÄpMsgToAÎ
(
buf
, 
msgL’
);

1252 
	`logDebug
("sentƒnrpakeover server‡s‡nnouncement");

1254  (
»t
 =ğ()
msgL’
) ? 1 : -1;

1255 
	}
}

1258 
	$ü—‹AssocToP“r
(
sd
, 
Add»ss
 *
addrs
, 
addrCÁ
, 
ušt16
 
pÜt
, 
ušt32
 
£rv”Id
, 
sùp_assoc_t
 *
assocId
) {

1259 
sùp_¢drcvšfo
 
sšfo
;

1260 
Regi¡¿rS”v”
 
£rv”
;

1261 
»t
;

1262 
·r£dCouÁ
 = 0;

1263 
addrBuf
[
MAX_ADDR_CNT
 * (
sockaddr_š6
)];

1265 ià(
addrs
 =ğ
NULL
) {

1266 
	`logDebug
("addrs is NULL");

1270 ià(
addrCÁ
 < 1) {

1271 
	`logDebug
("addrCnt is†esshan 1");

1275 ià(
pÜt
 == 9901) {

1276 
	`logDebug
("tryingo connecto self");

1277 
	`logDebug
("£rv”id: 0x%08x…Üt: %d", 
£rv”Id
, 
pÜt
);

1278 
	`add»ssLi¡Pršt
(
addrs
);

1281 
	`mem£t
(
addrBuf
, 0, (addrBuf));

1282 
	`mem£t
(&
sšfo
, 0, (sinfo));

1284 ià((
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
£rv”Id
)è=ğ
NULL
) {

1285 
	`logDebug
("0x%08x i nÙ iÀ»gi¡¿¸£rv¸li¡", 
£rv”Id
);

1289 
·r£dCouÁ
 = 
	`add»s£sToSysC®lBufãr
(
addrs
, 
pÜt
, 
addrCÁ
, 
addrBuf
);

1290 ià(
·r£dCouÁ
 !ğ
addrCÁ
) {

1291 
	`logDebug
("address…arsing failed,‡bort");

1295 ià((
»t
 = 
	`sùp_£ndx
(
sd
, (*è
NULL
, 0, (
sockaddr
 *è
addrBuf
, 
addrCÁ
, &
sšfo
,

1296 #ifdeà
MSG_NOSIGNAL


1297 
MSG_NOSIGNAL


1302 
	`logDebug
("”rÜ whŒyšgØe¡ablish‡ssoøtØ0x%08x", 
£rv”Id
);

1303 
	`³¼Ü
("sctp_sendx");

1306 
	`logDebug
("Ãw‡ssocId fÜ 0x%08x i %d", 
£rv”Id
, 
sšfo
.
sšfo_assoc_id
);

1308 *
assocId
 = 
sšfo
.
sšfo_assoc_id
;

1309 
£rv”
->
rsEÄpAssocId
 = 
sšfo
.
sšfo_assoc_id
;

1311 
	}
}

	@enrp.h

36 #iâdeà
_ENRP_H


37 
	#_ENRP_H
 1

	)

39 
	~<sys/ty³s.h
>

41 
	~"·¿m‘”s.h
"

42 
	~"poŞ–em’t.h
"

43 
	~"£rv”poŞ.h
"

46 #´agm¨
·ck
(1)

49 
	#ENRP_PRESENCE
 0x01

	)

50 
	#ENRP_HANDLE_TABLE_REQUEST
 0x02

	)

51 
	#ENRP_HANDLE_TABLE_RESPONSE
 0x03

	)

52 
	#ENRP_HANDLE_UPDATE
 0x04

	)

53 
	#ENRP_LIST_REQUEST
 0x05

	)

54 
	#ENRP_LIST_RESPONSE
 0x06

	)

55 
	#ENRP_INIT_TAKEOVER
 0x07

	)

56 
	#ENRP_INIT_TAKEOVER_ACK
 0x08

	)

57 
	#ENRP_TAKEOVER_SERVER
 0x09

	)

58 
	#ENRP_ERROR
 0x0a

	)

60 
	#BUFFER_SIZE
 (1<<16)

	)

62 
	#ENRP_UPDATE_ACTION_ADD_PE
 0x0000

	)

63 
	#ENRP_UPDATE_ACTION_DEL_PE
 0x0001

	)

66 
	#MAX_NUMBER_SERVER_HUNT
 2

	)

67 
	#TIMEOUT_SERVER_HUNT
 1000

	)

68 
	#PEER_HEARTBEAT_CYCLE
 2500

	)

69 
	#SERVER_ANNOUNCE_CYCLE
 2500

	)

70 
	#MAX_TIME_LAST_HEARD
 5000

	)

71 
	#MAX_TIME_NO_RESPONSE
 1

	)

72 
	#MAX_BAD_PE_REPORT
 3

	)

78 
	s’½MsgH—d”
 {

79 
ušt8
 
	mty³
;

80 
ušt8
 
	mæags
;

81 
ušt16
 
	mËngth
;

82 
ušt32
 
	m£nd”S”v”Id
;

83 
ušt32
 
	m»ûiv”S”v”Id
;

86 
	s’½P»£nû
 {

87 
msgH—d”
 
	mhdr
;

88 
ušt32
 
	m£nd”S”v”Id
;

89 
ušt32
 
	m»ûiv”S”v”Id
;

90 
·¿mPeChecksum
 
	m³Checksum
;

93 
	s’½HªdËTabËReque¡
 {

94 
msgH—d”
 
	mhdr
;

95 
ušt32
 
	m£nd”S”v”Id
;

96 
ušt32
 
	m»ûiv”S”v”Id
;

99 
	s’½HªdËTabËRe¥Ú£
 {

100 
msgH—d”
 
	mhdr
;

101 
ušt32
 
	m£nd”S”v”Id
;

102 
ušt32
 
	m»ûiv”S”v”Id
;

105 
	s’½HªdËUpd©e
 {

106 
msgH—d”
 
	mhdr
;

107 
ušt32
 
	m£nd”S”v”Id
;

108 
ušt32
 
	m»ûiv”S”v”Id
;

109 
ušt16
 
	mupd©eAùiÚ
;

110 
ušt16
 
	m»£rved
;

113 
	s’½Li¡Reque¡
 {

114 
msgH—d”
 
	mhdr
;

115 
ušt32
 
	m£nd”S”v”Id
;

116 
ušt32
 
	m»ûiv”S”v”Id
;

119 
	s’½Li¡Re¥Ú£
 {

120 
msgH—d”
 
	mhdr
;

121 
ušt32
 
	m£nd”S”v”Id
;

122 
ušt32
 
	m»ûiv”S”v”Id
;

125 
	s’½In™Takeov”
 {

126 
msgH—d”
 
	mhdr
;

127 
ušt32
 
	m£nd”S”v”Id
;

128 
ušt32
 
	m»ûiv”S”v”Id
;

129 
ušt32
 
	mrg‘S”v”Id
;

132 
	s’½In™Takeov”Ack
 {

133 
msgH—d”
 
	mhdr
;

134 
ušt32
 
	m£nd”S”v”Id
;

135 
ušt32
 
	m»ûiv”S”v”Id
;

136 
ušt32
 
	mrg‘S”v”Id
;

139 
	s’½Takeov”S”v”
 {

140 
msgH—d”
 
	mhdr
;

141 
ušt32
 
	m£nd”S”v”Id
;

142 
ušt32
 
	m»ûiv”S”v”Id
;

143 
ušt32
 
	mrg‘S”v”Id
;

146 
	s’½E¼Ü
 {

147 
msgH—d”
 
	mhdr
;

148 
ušt32
 
	m£nd”S”v”Id
;

149 
ušt32
 
	m»ûiv”S”v”Id
;

156 
size_t


157 
š™EÄpP»£nû
(
’½P»£nû
 *
msg
, 
ušt32
 
»ûiv”Id
, 
»¶yB™
);

159 
size_t


160 
š™EÄpHªdËTabËReque¡
(
’½HªdËTabËReque¡
 *
msg
, 
ušt32
 
»ûiv”Id
, 
ownB™
);

162 
size_t


163 
š™EÄpHªdËTabËRe¥Ú£
(
’½HªdËTabËRe¥Ú£
 *
msg
, 
ušt32
 
»ûiv”Id
, 
mÜeB™
, 
»jeùB™
);

165 
size_t


166 
š™EÄpHªdËUpd©e
(
’½HªdËUpd©e
 *
msg
, 
ušt32
 
»ûiv”Id
, 
ušt16
 
upd©eAùiÚ
);

168 
size_t


169 
š™EÄpLi¡Reque¡
(
’½Li¡Reque¡
 *
msg
, 
ušt32
 
»ûiv”Id
);

171 
size_t


172 
š™EÄpLi¡Re¥Ú£
(
’½Li¡Re¥Ú£
 *
msg
, 
ušt32
 
»ûiv”Id
,
»jeùB™
);

174 
size_t


175 
š™EÄpIn™Takeov”
(
’½In™Takeov”
 *
msg
, 
ušt32
 
»ûiv”Id
, ušt32 
rg‘Id
);

177 
size_t


178 
š™EÄpIn™Takeov”Ack
(
’½In™Takeov”Ack
 *
msg
, 
ušt32
 
»ûiv”Id
, ušt32 
rg‘Id
);

180 
size_t


181 
š™EÄpTakeov”S”v”
(
’½Takeov”S”v”
 *
msg
, 
ušt32
 
»ûiv”Id
, ušt32 
rg‘Id
);

188 
£ndEÄpMsg
(*
buf
, 
size_t
 
Ën
, 
sùp_assoc_t
 
assocId
, 
ªnounûm’t
);

190 
ssize_t


191 
£ndEÄpAÂounûMsg
(*
buf
, 
size_t
 
msgL’
);

194 
£ndEÄpP»£nû
(
ušt32
 
»ûiv”Id
, 
»¶yB™
, 
£ndInfo
, 
sùp_assoc_t
 
assocId
);

197 
£ndEÄpHªdËTabËReque¡
(
ušt32
 
»ûiv”Id
, 
ownB™
, 
sùp_assoc_t
 
assocId
);

200 
£ndEÄpHªdËTabËRe¥Ú£
(
ušt32
 
»ûiv”Id
, 
ownB™
, 
»jeùB™
, 
sùp_assoc_t
 
assocId
);

203 
£ndEÄpHªdËUpd©e
(
S”v”PoŞ
 
poŞ
, 
PoŞEËm’t
 
–em’t
, 
ušt16
 
hªdËAùiÚ
);

206 
£ndEÄpLi¡Reque¡
(
ušt32
 
»ûiv”Id
, 
sùp_assoc_t
 
assocId
);

209 
£ndEÄpLi¡Re¥Ú£
(
ušt32
 
»ûiv”Id
, 
»jeùB™
, 
sùp_assoc_t
 
assocId
);

212 
£ndEÄpIn™Takeov”
(
ušt32
 
»ûiv”Id
, ušt32 
rg‘Id
, 
sùp_assoc_t
 
assocId
);

215 
£ndEÄpIn™Takeov”Ack
(
ušt32
 
»ûiv”Id
, ušt32 
rg‘Id
, 
sùp_assoc_t
 
assocId
);

218 
£ndEÄpTakeov”S”v”
(
ušt32
 
»ûiv”Id
, ušt32 
rg‘Id
, 
sùp_assoc_t
 
assocId
);

221 
£ndEÄpE¼Ü
(
ušt32
 
»ûiv”Id
, 
sùp_assoc_t
 
assocId
);

228 
hªdËEÄpP»£nû
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

231 
hªdËEÄpHªdËTabËReque¡
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

234 
hªdËEÄpHªdËTabËRe¥Ú£
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

237 
hªdËEÄpHªdËUpd©e
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

240 
hªdËEÄpLi¡Reque¡
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

243 
hªdËEÄpLi¡Re¥Ú£
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

246 
hªdËEÄpIn™Takeov”
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

249 
hªdËEÄpIn™Takeov”Ack
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

252 
hªdËEÄpTakeov”S”v”
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

255 
hªdËEÄpE¼Ü
(*
buf
, 
ssize_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

258 
ü—‹AssocToP“r
(
sd
, 
Add»ss
 *
addrs
, 
addrCÁ
, 
ušt16
 
pÜt
, 
ušt32
 
£rv”Id
, 
sùp_assoc_t
 *
assocId
);

261 
hªdËLiãtimeExpœy
(* 
d©a
);

	@main.c

36 
	~<¡ršgs.h
>

37 
	~<¡ršg.h
>

38 
	~<¡dlib.h
>

39 
	~<sys/ty³s.h
>

40 
	~<sys/time.h
>

41 
	~<sys/sock‘.h
>

42 
	~<Ãtš‘/š.h
>

43 
	~<Ãtš‘/sùp.h
>

44 
	~<uni¡d.h
>

45 
	~<¬·/š‘.h
>

47 
	~"maš.h
"

48 
	~"debug.h
"

49 
	~"back’d.h
"

50 
	~"cblib.h
"

51 
	~"’½.h
"

52 
	~"a§p.h
"

53 
	~"ÿÎbacks.h
"

54 
	~"»gi¡¿r£rv”.h
"

57 
	$checkFÜIpv6
() {

58 
sd
;

60 
sd
 = 
	`sock‘
(
AF_INET6
, 
SOCK_STREAM
, 
IPPROTO_TCP
);

62 ià(
sd
 != -1) {

63 
u£Ipv6
 = 1;

64 
	`şo£
(
sd
);

65 
	`logDebug
("ipv6‡vailable");

66  
u£Ipv6
;

69 
	`logDebug
("ipv6‚ot‡vailable");

70  
u£Ipv6
;

71 
	}
}

74 
	$·r£Args
(
¬gc
, **
¬gv
) {

75 
i
;

76 
´štU§ge
 = 0;

77 *
’½AÂounûAddr
 = 
NULL
;

78 *
’½LoÿlAddr
 = 
NULL
;

79 *
a§pAÂounûAddr
 = 
NULL
;

80 *
a§pLoÿlAddr
 = 
NULL
;

81 
ušt16
 
’½AÂounûPÜt
 = 0;

82 
ušt16
 
’½LoÿlPÜt
 = 0;

83 
ušt16
 
a§pAÂounûPÜt
 = 0;

84 
ušt16
 
a§pLoÿlPÜt
 = 0;

86 
i
 = 1; i < 
¬gc
; i++) {

87 ià((
	`¡ºcmp
(
¬gv
[
i
], "--help", 6)) == 0) {

88 
´štU§ge
 = 1;

92 ià((
	`¡ºcmp
(
¬gv
[
i
], "--enrpAnnounceAddr=", 19)) == 0)

93 
’½AÂounûAddr
 = &
¬gv
[
i
][19];

95 ià((
	`¡ºcmp
(
¬gv
[
i
], "--enrpAnnouncePort=", 19)) == 0)

96 
’½AÂounûPÜt
 = 
	`©oi
(&
¬gv
[
i
][19]);

98 ià((
	`¡ºcmp
(
¬gv
[
i
], "--enrpLocalAddr=", 16)) == 0)

99 
’½LoÿlAddr
 = &
¬gv
[
i
][16];

101 ià((
	`¡ºcmp
(
¬gv
[
i
], "--enrpLocalPort=", 16)) == 0)

102 
’½LoÿlPÜt
 = 
	`©oi
(&
¬gv
[
i
][16]);

104 ià((
	`¡ºcmp
(
¬gv
[
i
], "--asapAnnounceAddr=", 19)) == 0)

105 
a§pAÂounûAddr
 = &
¬gv
[
i
][19];

107 ià((
	`¡ºcmp
(
¬gv
[
i
], "--asapAnnouncePort=", 19)) == 0)

108 
a§pAÂounûPÜt
 = 
	`©oi
(&
¬gv
[
i
][19]);

110 ià((
	`¡ºcmp
(
¬gv
[
i
], "--asapLocalAddr=", 16)) == 0)

111 
a§pLoÿlAddr
 = &
¬gv
[
i
][16];

113 ià((
	`¡ºcmp
(
¬gv
[
i
], "--asapLocalPort=", 16)) == 0)

114 
a§pLoÿlPÜt
 = 
	`©oi
(&
¬gv
[
i
][16]);

116 ià((
	`¡ºcmp
(
¬gv
[
i
], "--useMulticast=off", 18)) == 0)

117 
u£EÄpAÂounûm’ts
 = 0;

119 ià((
	`¡ºcmp
(
¬gv
[
i
], "--useIpv6=off", 13)) == 0)

120 
u£Ipv6
 = 0;

122 ià((
	`¡ºcmp
(
¬gv
[
i
], "--useLoopback=off", 17)) == 0)

123 
u£Loİback
 = 0;

126 
	`logDebug
("Bad‡rgum’t: '%s'\n", 
¬gv
[
i
]);

127 
´štU§ge
 = 1;

132 ià(
´štU§ge
) {

133 
	`´štH–p
(
¬gv
[0]);

134 
	`ex™
(-1);

137 
	`logDebug
("’½LoÿlAddr: %s", 
’½LoÿlAddr
);

138 
	`logDebug
("’½LoÿlPÜt: %d", 
’½LoÿlPÜt
);

139 
	`logDebug
("’½AÂounûAddr: %s", 
’½AÂounûAddr
);

140 
	`logDebug
("’½AÂounûPÜt: %d", 
’½AÂounûPÜt
);

141 
	`logDebug
("a§pLoÿlAddr: %s", 
a§pLoÿlAddr
);

142 
	`logDebug
("a§pLoÿlPÜt: %d", 
a§pLoÿlPÜt
);

143 
	`logDebug
("a§pAÂounûAddr: %s", 
a§pAÂounûAddr
);

144 
	`logDebug
("a§pAÂounûPÜt: %d", 
a§pAÂounûPÜt
);

145 
	`logDebug
("u£EÄpAÂounûm’ts: %d", 
u£EÄpAÂounûm’ts
);

146 
	`logDebug
("u£Ipv6: %d", 
u£Ipv6
);

147 
	`logDebug
("u£Loİback: %d", 
u£Loİback
);

150 ià(
u£EÄpAÂounûm’ts
)

151 
	`š™EÄpUdpSock‘s
(
’½AÂounûAddr
, 
’½AÂounûPÜt
);

153 
	`š™EÄpSùpSock‘
(
’½LoÿlAddr
, 
’½LoÿlPÜt
);

162 
	}
}

165 
	$´štH–p
(*
bšName
) {

166 
	`´štf
("U§ge: %s\n\n", 
bšName
);

167 
	`´štf
("--enrpAnnounceAddr=<ipv4 or ipv6‡ddr>he multicast group‡ddress\n");

168 
	`´štf
("--enrpAnnouncePort=<port>he multicast input…ort\n");

169 
	`´štf
("--enrpLocalAddr=<Addr>†ocal‡ddress ofƒnrpƒndpoint\n");

170 
	`´štf
("--enrpLocalPort=<port>†ocal…ort ofƒnrpƒndpoint\n");

171 
	`´štf
("--useMulticast=offurn ofhe use of multicast generally\n");

172 
	`´štf
("--useIpv6=offurn offhe use of ipv6 generally\n");

173 
	`´štf
("--useLoopback=off do NOT bindo†oopback‡ddresses\n");

174 
	`´štf
("--help…rinthis help\n");

175 
	`´štf
("\n");

178 
	}
}

181 
	$cÚv”tSŒšgToAddr
(*
¡r
, 
Add»ss
 *
addr
) {

182 
š_addr
 
š4
;

183 
š6_addr
 
š6
;

185 
	`mem£t
(&
š4
, 0, (in4));

186 
	`mem£t
(&
š6
, 0, (in6));

187 
	`mem£t
(
addr
, 0, (
Add»ss
));

189 ià(
¡r
 =ğ
NULL
)

192 ià(
	`š‘_±Ú
(
AF_INET6
, 
¡r
, (*è&
š6
) > 0) {

193 
addr
->
ty³
 = 
AF_INET6
;

194 
addr
->addr.
š6
 = in6;

196 } ià(
	`š‘_±Ú
(
AF_INET
, 
¡r
, (*è&
š4
) > 0) {

197 ià(
u£Ipv6
) {

198 ((
ušt32
 *è&
š6
)[2] = 
	`htÚl
(0xffff);

199 ((
ušt32
 *è&
š6
)[3] = 
š4
.
s_addr
;

200 
addr
->
ty³
 = 
AF_INET6
;

201 
addr
->addr.
š6
 = in6;

204 
addr
->
ty³
 = 
AF_INET
;

205 
addr
->addr.
š4
 = in4;

209 
	}
}

212 
	$š™EÄpSùpSock‘
(*
’½LoÿlAddr
, 
ušt16
 
pÜt
) {

213 
sockaddr_š6
 
š6
;

214 
sockaddr_š
 
š4
;

215 
Add»ss
 
addr
;

216 
sùp_ev’t_subsüibe
 
ev’t
;

217 
sùp_š™msg
 
š™
;

218 
addrBuf
[
INET6_ADDRSTRLEN
];

220 
	`mem£t
(
addrBuf
, 0, (addrBuf));

222 ià(
	`cÚv”tSŒšgToAddr
(
’½LoÿlAddr
, &
addr
) < 0) {

223 ià(
u£Ipv6
) {

224 
	`logDebug
("settingƒnrpLocalAddro in6addr_any for AF_INET6")

225 
addr
.
ty³
 = 
AF_INET6
;

226 
addr
.addr.
š6
 = 
š6addr_ªy
;

228 
	`logDebug
("settingƒnrpLocalAddro INADDR_ANY for AF_INET");

229 
addr
.
ty³
 = 
AF_INET
;

230 
addr
.addr.
š4
.
s_addr
 = 
INADDR_ANY
;

234 ià(
pÜt
 == 0)

235 
pÜt
 = 
ENRP_SCTP_PORT
;

237 ià(
addr
.
ty³
 =ğ
AF_INET6
) {

238 
	`mem£t
(&
š6
, 0, (in6));

239 
š6
.
sš6_çmy
 = 
AF_INET6
;

240 
š6
.
sš6_pÜt
 = 
	`htÚs
(
pÜt
);

241 
š6
.
sš6_addr
 = 
addr
.addr.in6;

242 #ifdeà
HAVE_SIN6_LEN


243 
š6
.
sš6_Ën
 = (in6);

246 ià((
’½SùpFd
 = 
	`sock‘
(
AF_INET6
, 
SOCK_SEQPACKET
, 
IPPROTO_SCTP
)) < 0) {

247 
	`³¼Ü
("ipv6ƒnrp sctp socket failed");

248 
	`ex™
(-1);

251 ià(
	`bšd
(
’½SùpFd
, (
sockaddr
 *è&
š6
, (in6)) < 0) {

252 
	`³¼Ü
("ipv6ƒnrp sctp bind failed");

253 
	`ex™
(-1);

255 
	`logDebug
("’½ sù°sock‘ %d i boundØ%s:%d", 
’½SùpFd
, 
	`š‘_Áİ
(
AF_INET6
, (*è&
š6
.
sš6_addr
, 
addrBuf
, 
INET6_ADDRSTRLEN
), 
pÜt
);

256 } ià(
addr
.
ty³
 =ğ
AF_INET
) {

257 
	`mem£t
(&
š4
, 0, (in4));

258 
š4
.
sš_çmy
 = 
AF_INET
;

259 
š4
.
sš_pÜt
 = 
	`htÚs
(
pÜt
);

260 
š4
.
sš_addr
 = 
addr
.addr.in4;

261 #ifdeà
HAVE_SIN_LEN


262 
š4
.
sš_Ën
 = (in4);

265 ià((
’½SùpFd
 = 
	`sock‘
(
AF_INET
, 
SOCK_SEQPACKET
, 
IPPROTO_SCTP
)) < 0) {

266 
	`³¼Ü
("ipv4ƒnrp sctp socket failed"),

267 
	`ex™
(-1);

270 ià(
	`bšd
(
’½SùpFd
, (
sockaddr
 *è&
š4
, (in4)) < 0) {

271 
	`³¼Ü
("ipv4ƒnrp sctp bind failed");

272 
	`ex™
(-1);

274 
	`logDebug
("’½ sù°sock‘ %d i boundØ%s:%d", 
’½SùpFd
, 
	`š‘_Áİ
(
AF_INET
, (*è&
š4
.
sš_addr
, 
addrBuf
, 
INET6_ADDRSTRLEN
), 
pÜt
);

276 
	`logDebug
("v”y wrÚg‡dd»s ty³: %d", 
addr
.
ty³
);

277 
	`ex™
(-1);

281 
	`mem£t
(&
ev’t
, 0, (event));

282 
ev’t
.
sùp_assocŸtiÚ_ev’t
 = 1;

283 
ev’t
.
sùp_shutdown_ev’t
 = 1;

284 
ev’t
.
sùp_d©a_io_ev’t
 = 1;

285 
ev’t
.
sùp_add»ss_ev’t
 = 1;

286 
ev’t
.
sùp_£nd_çu»_ev’t
 = 1;

287 
ev’t
.
sùp_³”_”rÜ_ev’t
 = 1;

288 
ev’t
.
sùp_·¹Ÿl_d–iv”y_ev’t
 = 0;

294 ià(
	`£tsockİt
(
’½SùpFd
, 
IPPROTO_SCTP
, 
SCTP_EVENTS
, &
ev’t
, (event)) != 0) {

295 
	`³¼Ü
("setsockopt sctp_event onƒnrp socket failed");

296 
	`ex™
(-1);

300 
š™
.
sš™_num_o¡»ams
 = 1;

301 
š™
.
sš™_max_š¡»ams
 = 1;

302 
š™
.
sš™_max_©‹m±s
 = 0;

303 
š™
.
sš™_max_š™_timeo
 = 0;

304 ià(
	`£tsockİt
(
’½SùpFd
, 
IPPROTO_SCTP
, 
SCTP_INITMSG
, &
š™
, (init)) != 0) {

305 
	`³¼Ü
("setsockopt sctp_init onƒnrp socket failed");

306 
	`ex™
(-1);

310 ià(
	`li¡’
(
’½SùpFd
, 10) < 0) {

311 
	`³¼Ü
("listen onƒnrp…ort failed");

312 
	`ex™
(-1);

315 
	`tim”Regi¡”FdC®lback
(
’½SùpFd
, 
’½SùpC®lback
, 
NULL
);

316 
’½LoÿlPÜt
 = 
pÜt
;

318 
	}
}

321 
	$š™EÄpUdpSock‘s
(*
’½AÂounûAddrSŒ
, 
ušt16
 
pÜt
) {

322 
Add»ss
 
ªnounûAddr
;

323 
v6_m»q
 
m»q6
;

324 
_m»q
 
m»q
;

325 
sockaddr_š6
 
š6
;

326 
sockaddr_š
 
š4
;

327 
addrBuf
[
INET6_ADDRSTRLEN
];

328 cÚ¡ 
Ú
 = 1;

330 
	`mem£t
(
addrBuf
, 0, (addrBuf));

332 ià(
	`cÚv”tSŒšgToAddr
(
’½AÂounûAddrSŒ
, &
ªnounûAddr
) < 0)

333 
ªnounûAddr
 = 
’½AÂounûAddr
;

335 ià(
pÜt
 == 0)

336 
pÜt
 = 
ENRP_UDP_PORT
;

338 ià(
ªnounûAddr
.
ty³
 =ğ
AF_INET6
) {

339 ià((
’½UdpFd
 = 
	`sock‘
(
AF_INET6
, 
SOCK_DGRAM
, 
IPPROTO_UDP
)) < 0) {

340 
	`³¼Ü
("ipv6ƒnrp udp socket failed");

344 #ifdeà
HAVE_SO_REUSEPORT


345 ià(
	`£tsockİt
(
’½UdpFd
, 
SOL_SOCKET
, 
SO_REUSEPORT
, (cÚ¡ *è&
Ú
, (
size_t
)()) != 0)

346 
	`³¼Ü
("setsockopt„euseport");

348 ià(
	`£tsockİt
(
’½UdpFd
, 
SOL_SOCKET
, 
SO_REUSEADDR
, (cÚ¡ *è&
Ú
, (
size_t
)()) != 0)

349 
	`³¼Ü
("setsockopt„euseaddr");

352 
	`mem£t
(&
š6
, 0, (in6));

353 
š6
.
sš6_çmy
 = 
AF_INET6
;

354 
š6
.
sš6_addr
 = 
š6addr_ªy
;

355 
š6
.
sš6_pÜt
 = 
	`htÚs
(
pÜt
);

356 #ifdeà
HAVE_SIN6_LEN


357 
š6
.
sš6_Ën
 = (
sockaddr_š6
);

360 ià(
	`bšd
(
’½UdpFd
, (
sockaddr
 *è&
š6
, (
sockaddr_š6
)) < 0) {

361 
	`³¼Ü
("ipv6ƒnrp udp bind failed");

365 
m»q6
.
v6mr_muÉŸddr
 = 
ªnounûAddr
.
addr
.
š6
;

366 
m»q6
.
v6mr_š‹rçû
 = 0;

368 ià(
	`£tsockİt
(
’½UdpFd
, 
IPPROTO_IPV6
, 
IPV6_JOIN_GROUP
, &
m»q
, (mreq)) < 0) {

369 
	`³¼Ü
("setsockopt‡dd membership onƒnrp udp…ort failed");

373 ià((
’½UdpS’dFd
 = 
	`sock‘
(
AF_INET6
, 
SOCK_DGRAM
, 
IPPROTO_UDP
)) < 0) {

374 
	`³¼Ü
("ipv6ƒnrp udp socket failed");

377 
	`logDebug
("’½UdpFd i %d", 
’½UdpFd
);

378 
	`logDebug
("’½UdpFd i loÿÎy boundØ%s:%d", 
	`š‘_Áİ
(
AF_INET6
, (*è&
š6
.
sš6_addr
, 
addrBuf
, 
INET6_ADDRSTRLEN
), 
pÜt
);

379 
	`logDebug
("’½UdpS’dFd i %d", 
’½UdpS’dFd
);

380 } ià(
ªnounûAddr
.
ty³
 =ğ
AF_INET
) {

381 ià((
’½UdpFd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 
IPPROTO_UDP
)) < 0) {

382 
	`³¼Ü
("ipv4ƒnrp udp socket failed");

386 #ifdeà
HAVE_SO_REUSEPORT


387 ià(
	`£tsockİt
(
’½UdpFd
, 
SOL_SOCKET
, 
SO_REUSEPORT
, (cÚ¡ *è&
Ú
, (
size_t
) ()) != 0)

388 
	`³¼Ü
("setsockopt„euseport");

390 ià(
	`£tsockİt
(
’½UdpFd
, 
SOL_SOCKET
, 
SO_REUSEADDR
, (cÚ¡ *è&
Ú
, (
size_t
) ()) != 0)

391 
	`³¼Ü
("setsockopt„euseaddr");

394 
	`mem£t
(&
š4
, 0, (in4));

395 
š4
.
sš_çmy
 = 
AF_INET
;

396 
š4
.
sš_addr
.
s_addr
 = 
	`htÚl
(
INADDR_ANY
);

397 
š4
.
sš_pÜt
 = 
	`htÚs
(
pÜt
);

398 #ifdeà
HAVE_SIN_LEN


399 
š4
.
sš_Ën
 = (
sockaddr_š
);

402 ià(
	`bšd
(
’½UdpFd
, (
sockaddr
 *è&
š4
, (
sockaddr_š
)) < 0) {

403 
	`³¼Ü
("ipv4ƒnrp udp bind failed");

407 
m»q
.
imr_muÉŸddr
 = 
ªnounûAddr
.
addr
.
š4
;

408 
m»q
.
imr_š‹rçû
.
s_addr
 = 
INADDR_ANY
;

410 ià(
	`£tsockİt
(
’½UdpFd
, 
IPPROTO_IP
, 
IP_ADD_MEMBERSHIP
, &
m»q
, (mreq)) < 0) {

411 
	`³¼Ü
("setsockopt‡dd membership onƒnrp udp…ort failed");

415 ià((
’½UdpS’dFd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 
IPPROTO_UDP
)) < 0) {

416 
	`³¼Ü
("ipv4ƒnrp udp send socket failed");

419 
	`logDebug
("’½UdpFd i %d", 
’½UdpFd
);

420 
	`logDebug
("’½UdpFd i loÿÎy boundØ%s:%d", 
	`š‘_Áİ
(
AF_INET
, (*è&
š4
.
sš_addr
, 
addrBuf
, 
INET_ADDRSTRLEN
), 
pÜt
);

421 
	`logDebug
("’½UdpS’dFd i %d", 
’½UdpS’dFd
);

424 
’½AÂounûAddr
 = 
ªnounûAddr
;

425 
u£EÄpAÂounûm’ts
 = 1;

427 
	`tim”Regi¡”FdC®lback
(
’½UdpFd
, 
’½UdpC®lback
, 
NULL
);

429 
	}
}

432 
	$š™Regi¡¿r
() {

433 
sockaddr
 *
addrs
;

434 
sockaddr
 *
addr
;

435 
sockaddr_š6
 *
pš6
;

436 
sockaddr_š
 *
pš4
;

437 *
off£t
;

438 
addrBuf
[
INET6_ADDRSTRLEN
 + 1];

439 
timev®
 
now
;

440 
£ed
;

441 
addrCÁ
 = 0;

442 
i
;

444 
	`logDebug
("initializing own„egistrar");

447 
	`g‘Time
(&
now
);

448 
£ed
 = 
now
.
tv_£c
 |‚ow.
tv_u£c
;

449 
	`¤ªd
(
£ed
);

450 
ownId
 = (
ušt32
è
	`¿nd
();

451 
	`logDebug
("£rv” id is: 0x%08x", 
ownId
);

453 
this
 = 
	`»gi¡¿rS”v”New
(
ownId
);

454 
	`»gi¡¿rS”v”Li¡AddS”v”
(
this
);

455 
this
->
rsEÄpPÜt
 = 
’½LoÿlPÜt
;

458 
	`tim”Stİ
(
this
->
rsLa¡H—rdTimeout
);

459 
	`tim”D–‘e
(
this
->
rsLa¡H—rdTimeout
);

460 
this
->
rsLa¡H—rdTimeout
 = 
NULL
;

461 
this
->
rsLa¡H—rdTimeoutCÁ
 = 0;

463 ià((
addrCÁ
 = 
	`sùp_g‘Ïddrs
(
’½SùpFd
, 0, &
addrs
)) > 0) {

464 
off£t
 = (*è
addrs
;

465 
	`logDebug
("w¬loÿÎy boundØ%d‡d»s£s", 
addrCÁ
);

466 
i
 = 0; i < 
addrCÁ
 && i < 
MAX_ADDR_CNT
; i++) {

467 
addr
 = (
sockaddr
 *è
off£t
;

468 
pš4
 = (
sockaddr_š
 *è
off£t
;

469 
pš6
 = (
sockaddr_š6
 *è
off£t
;

471 ià(
addr
->
§_çmy
 =ğ
AF_INET
) {

472 ià(!
u£Loİback
 && 
pš4
->
sš_addr
.
s_addr
 =ğ
INADDR_LOOPBACK
)

475 
this
->
rsEÄpAddr
[
i
].
ty³
 = 
AF_INET
;

476 
	`memıy
(&
this
->
rsEÄpAddr
[
i
].
addr
.
š4
, &
pš4
->
sš_addr
, (
š_addr
));

477 
	`logDebug
("addrs[%d]: AF_INET %s", 
i
, 
	`š‘_Áİ
(
AF_INET
, (*è&
pš4
->
sš_addr
, 
addrBuf
, 
INET6_ADDRSTRLEN
));

478 
off£t
 +ğ(
sockaddr_š
);

479 } ià(
addrs
->
§_çmy
 =ğ
AF_INET6
) {

480 ià(!
u£Loİback
 && 
	`memcmp
((cÚ¡ *è&
pš6
->
sš6_addr
, (cÚ¡ *è&
š6addr_loİback
, (
š6_addr
)) == 0)

483 
this
->
rsEÄpAddr
[
i
].
ty³
 = 
AF_INET6
;

484 
	`memıy
(&
this
->
rsEÄpAddr
[
i
].
addr
.
š6
, &
pš6
->
sš6_addr
, (
š6_addr
));

485 
	`logDebug
("addrs[%d]: AF_INET6 %s", 
i
, 
	`š‘_Áİ
(
AF_INET6
, (*è&
pš6
->
sš6_addr
, 
addrBuf
, 
INET6_ADDRSTRLEN
));

486 
off£t
 +ğ(
sockaddr_š6
);

489 
	`sùp_ä“Ïddrs
(
addrs
);

493 
	}
}

496 
	$¡¬tRegi¡¿rS”v”HuÁ
() {

497 
£rv”HuÁCÁ
 = 0;

499 
’½AÂounûTim”
 = 
	`tim”C»©e
(
’½AÂounûTimeout
, 
NULL
, "enrp‡nnounce cycleimer");

501 ià(
u£EÄpAÂounûm’ts
) {

502 
	`logDebug
("using‡nnouncementso find mentor…eer");

503 
	`£ndEÄpP»£nû
(0, 1, 1, 0);

504 
£rv”HuÁTim”
 = 
	`tim”C»©e
(
£rv”HuÁTimeout
, 
NULL
, "server huntimer");

505 
	`tim”S¹
(
£rv”HuÁTim”
, 
TIMEOUT_SERVER_HUNT
);

510 
	`logDebug
("skipped server hunt,‚o multicast‡vailable");

511 
»gi¡¿rS‹
 = 
SERVICING
;

512 
	`tim”S¹
(
’½AÂounûTim”
, 
PEER_HEARTBEAT_CYCLE
);

515 
	}
}

518 
	$¡¬tA§pAÂounûm’ts
() {

519 
	`logDebug
("¡¬tšg‡§°£rv”‡Âounûm’t w™h cyş‘im%dms", 
ASAP_SERVER_ANNOUNCE_TIMEOUT
);

520 
a§pAÂounûTim”
 = 
	`tim”C»©e
(
a§pAÂounûTimeout
, 
NULL
, "asap‡nnounce cycleimer");

521 
	`tim”S¹
(
a§pAÂounûTim”
, 
ASAP_SERVER_ANNOUNCE_TIMEOUT
);

524 
	}
}

527 
	$maš
(
¬gc
, **
¬gv
) {

528 #ifdeà
DEBUG


530 
	`£tvbuf
(
¡dout
, (*è
NULL
, 
_IONBF
, 0);

534 
	`š™Cblib
();

537 
	`š™Glob®s
();

540 
	`checkFÜIpv6
();

543 
	`·r£Args
(
¬gc
, 
¬gv
);

546 
	`š™Regi¡¿r
();

549 
	`¡¬tRegi¡¿rS”v”HuÁ
();

552 
	`¡¬tA§pAÂounûm’ts
();

555 
	`hªdËEv’ts
();

559 
	}
}

	@main.h

36 #iâdeà
_MAIN_H


37 
	#_MAIN_H
 1

	)

39 
	~"back’d.h
"

42 
š™EÄpSùpSock‘
(*
’½LoÿlAddr
, 
ušt16
 
pÜt
);

45 
š™EÄpUdpSock‘s
(*
’½AÂounûAddr
, 
ušt16
 
pÜt
);

48 
š™A§pSùpSock‘
(*
a§pLoÿlAddr
, 
ušt16
 
pÜt
);

51 
š™A§pUdpSock‘s
(*
a§pAÂounûAddr
, 
ušt16
 
pÜt
);

54 
š™Regi¡¿r
();

57 
´štH–p
(*
bšName
);

60 
cÚv”tSŒšgToAddr
(*
¡r
, 
Add»ss
 *
addr
);

63 
·r£Args
(
¬gc
, **
¬gv
);

66 
¡¬tRegi¡¿rS”v”HuÁ
();

69 
checkFÜIpv6
();

	@parameters.c

36 
	~<¡ršg.h
>

37 
	~<¡dio.h
>

39 
	~"·¿m‘”s.h
"

40 
	~"£rv”poŞ.h
"

41 
	~"back’d.h
"

42 
	~"debug.h
"

43 
	~"ut.h
"

46 
	$š™P¬amIpv4Addr
(
·¿mIpv4Addr
 *
·¿m
, 
š_addr
 
addr
) {

47 
·¿m
->
hdr
.
ty³
 = 
	`htÚs
(
PARAM_IPV4_ADDR
);

48 
·¿m
->
hdr
.
Ëngth
 = 
	`htÚs
(8);

49 
·¿m
->
addr
 =‡ddr;

51 
	}
}

54 
	$š™P¬amIpv6Addr
(
·¿mIpv6Addr
 *
·¿m
, 
š6_addr
 
addr
) {

55 
·¿m
->
hdr
.
ty³
 = 
	`htÚs
(
PARAM_IPV6_ADDR
);

56 
·¿m
->
hdr
.
Ëngth
 = 
	`htÚs
(20);

57 
·¿m
->
addr
 =‡ddr;

59 
	}
}

62 
	$š™P¬amSùpT¿n¥Üt
(
·¿mSùpT¿n¥Üt
 *
·¿m
, 
ušt16
 
pÜt
, ušt16 
Œª¥ÜtU£
) {

63 
·¿m
->
hdr
.
ty³
 = 
	`htÚs
(
PARAM_SCTP_TRANSPORT
);

64 
·¿m
->
hdr
.
Ëngth
 = 
	`htÚs
(8);

65 
·¿m
->
sùpPÜt
 = 
	`htÚs
(
pÜt
);

66 
·¿m
->
Œª¥ÜtU£
 = 
	`htÚs
(transportUse);

68 
	}
}

71 
	$š™P¬amTıT¿n¥Üt
(
·¿mTıT¿n¥Üt
 *
·¿m
, 
ušt16
 
pÜt
, ušt16 
Œª¥ÜtU£
) {

72 
·¿m
->
hdr
.
ty³
 = 
	`htÚs
(
PARAM_TCP_TRANSPORT
);

73 
·¿m
->
hdr
.
Ëngth
 = 
	`htÚs
(8);

74 
·¿m
->
tıPÜt
 = 
	`htÚs
(
pÜt
);

75 
·¿m
->
Œª¥ÜtU£
 = 
	`htÚs
(transportUse);

77 
	}
}

80 
	$š™P¬amUdpT¿n¥Üt
(
·¿mUdpT¿n¥Üt
 *
·¿m
, 
ušt16
 
pÜt
) {

81 
·¿m
->
hdr
.
ty³
 = 
	`htÚs
(
PARAM_UDP_TRANSPORT
);

82 
·¿m
->
hdr
.
Ëngth
 = 
	`htÚs
(8);

83 
·¿m
->
udpPÜt
 = 
	`htÚs
(
pÜt
);

84 
·¿m
->
»£rved
 = 0;

86 
	}
}

89 
	$š™P¬amPoŞMemb”S–eùiÚPŞicy
(
·¿mPoŞMemb”S–eùiÚPŞicy
 *
·¿m
, 
ušt32
 
pŞicyTy³
, ušt32 
lßdWeight
, ušt32 
lßdDeg
) {

90 
ušt16
 
Ëngth
;

92 
·¿m
->
hdr
.
ty³
 = 
	`htÚs
(
PARAM_POOL_MEMBER_SELECTION_POLICY
);

93 
·¿m
->
pŞicyTy³
 = 
	`htÚl
(policyType);

95 
pŞicyTy³
) {

96 
POLICY_ROUND_ROBIN
:

97 
POLICY_RANDOM
:

98 
Ëngth
 = 8;

100 
POLICY_WEIGHTED_ROUND_ROBIN
:

101 
POLICY_WEIGHTED_RANDOM
:

102 
POLICY_LEAST_USED
:

103 
POLICY_RANDOMIZED_LEAST_USED
:

104 
Ëngth
 = 12;

105 
·¿m
->
»£rved
[0] = 
	`htÚl
(
lßdWeight
);

107 
POLICY_LEAST_USED_W_DEGRADATION
:

108 
POLICY_PRIORITY_LEAST_USED
:

109 
Ëngth
 = 12;

110 
·¿m
->
»£rved
[0] = 
	`htÚl
(
lßdWeight
);

111 
·¿m
->
»£rved
[1] = 
	`htÚl
(
lßdDeg
);

114 
	`logDebug
("unknowÀpŞicyTy³: %d", 
pŞicyTy³
);

117 
·¿m
->
hdr
.
Ëngth
 = 
	`htÚs
(length);

118  
Ëngth
;

119 
	}
}

122 
	$š™P¬amPoŞHªdË
(
·¿mPoŞHªdË
 *
·¿m
, *
ph
) {

123 
poŞHªdË
[
POOLHANDLE_SIZE
];

124 
ušt16
 
Ëngth
 = 0;

126 
	`mem£t
(
poŞHªdË
, 0, 
POOLHANDLE_SIZE
);

127 
	`¡ºıy
(
poŞHªdË
, 
ph
, 
POOLHANDLE_SIZE
);

128 
Ëngth
 = 
	`¡¾’
(
poŞHªdË
);

129 
Ëngth
 = 
	`ADD_PADDING
(length);

131 
	`memıy
((*)
·¿m
 + (
·¿mH—d”
), 
poŞHªdË
, 
Ëngth
);

132 
·¿m
->
hdr
.
ty³
 = 
	`htÚs
(
PARAM_POOL_HANDLE
);

133 
·¿m
->
hdr
.
Ëngth
 = 
	`htÚs
(length + 4);

135  
Ëngth
 + 4;

136 
	}
}

139 
	$š™P¬amPoŞEËm’t
(
·¿mPoŞEËm’t
 *
·¿m
, 
ušt32
 
³Id’tif›r
, ušt32 
homeEÄpS”v”Id’tif›r
, 
št32
 
»gi¡¿tiÚLiã
) {

140 
·¿m
->
hdr
.
ty³
 = 
	`htÚs
(
PARAM_POOL_ELEMENT
);

141 
·¿m
->
hdr
.
Ëngth
 = 
	`htÚs
(16);

142 
·¿m
->
³Id’tif›r
 = 
	`htÚl
(peIdentifier);

143 
·¿m
->
homeEÄpS”v”Id’tif›r
 = 
	`htÚl
(homeEnrpServerIdentifier);

144 
·¿m
->
»gi¡¿tiÚLiã
 = 
	`htÚl
(registrationLife);

146 
	}
}

149 
	$š™P¬amS”v”InfÜm©iÚ
(
·¿mS”v”InfÜm©iÚ
 *
·¿m
, 
MB™
, 
ušt32
 
£rv”Id
) {

150 
·¿m
->
hdr
.
ty³
 = 
	`htÚs
(
PARAM_SERVER_INFORMATION
);

151 
·¿m
->
hdr
.
Ëngth
 = 
	`htÚs
(12);

152 
·¿m
->
£rv”Id
 = 
	`htÚl
(serverId);

153 
·¿m
->
muÉiÿ¡
 = 
	`htÚl
((
MB™
 > 0) ? 0x80000000 : 0);

155 
	}
}

158 
	$š™P¬amO³¿tiÚE¼Ü
(
·¿mO³¿tiÚE¼Ü
 *
·¿m
) {

159 
·¿m
->
hdr
.
ty³
 = 
	`htÚs
(
PARAM_OPERATION_ERROR
);

160 
·¿m
->
hdr
.
Ëngth
 = 
	`htÚs
(4);

162 
	}
}

165 
	$š™P¬amCook›
(
·¿mCook›
 *
·¿m
) {

166 
·¿m
->
hdr
.
ty³
 = 
	`htÚs
(
PARAM_COOKIE
);

167 
·¿m
->
hdr
.
Ëngth
 = 
	`htÚs
(4);

169 
	}
}

172 
	$š™P¬amPeId’tif›r
(
·¿mPeId’tif›r
 *
·¿m
, 
ušt32
 
³Id’tif›r
) {

173 
·¿m
->
hdr
.
ty³
 = 
	`htÚs
(
PARAM_PE_IDENTIFIER
);

174 
·¿m
->
hdr
.
Ëngth
 = 
	`htÚs
(8);

175 
·¿m
->
³Id’tif›r
 = 
	`htÚl
(peIdentifier);

177 
	}
}

180 
	$š™P¬amPeChecksum
(
·¿mPeChecksum
 *
·¿m
, 
checksumTy³FŞded
 
checksum
) {

181 
·¿m
->
hdr
.
ty³
 = 
	`htÚs
(
PARAM_PE_CHECKSUM
);

182 
·¿m
->
hdr
.
Ëngth
 = 
	`htÚs
(6);

183 
·¿m
->
checksum
 = 
	`htÚs
(checksum);

184 
·¿m
->
·ddšg
 = 0;

186 
	}
}

189 
	$š™E¼ÜCau£
(
”rÜCau£
 *
ÿu£
, 
ušt16
 
ÿu£Code
) {

190 
ÿu£
->
ÿu£Code
 = 
	`htÚs
(causeCode);

191 
ÿu£
->
ÿu£L’gth
 = 
	`htÚs
(4);

193 
	}
}

	@parameters.h

36 #iâdeà
PARAMETERS_H


37 
	#PARAMETERS_H
 1

	)

39 
	~<sys/ty³s.h
>

40 
	~<sys/sock‘.h
>

41 
	~<Ãtš‘/š.h
>

43 
	~"back’d.h
"

44 
	~"checksum.h
"

47 #´agm¨
·ck
(1)

51 
	#PARAM_IPV4_ADDR
 0x0001

	)

52 
	#PARAM_IPV6_ADDR
 0x0002

	)

53 
	#PARAM_SCTP_TRANSPORT
 0x0003

	)

54 
	#PARAM_TCP_TRANSPORT
 0x0004

	)

55 
	#PARAM_UDP_TRANSPORT
 0x0005

	)

56 
	#PARAM_POOL_MEMBER_SELECTION_POLICY
 0x0006

	)

57 
	#PARAM_POOL_HANDLE
 0x0007

	)

58 
	#PARAM_POOL_ELEMENT
 0x0008

	)

59 
	#PARAM_SERVER_INFORMATION
 0x0009

	)

60 
	#PARAM_OPERATION_ERROR
 0x000a

	)

61 
	#PARAM_COOKIE
 0x000b

	)

62 
	#PARAM_PE_IDENTIFIER
 0x000c

	)

63 
	#PARAM_PE_CHECKSUM
 0x000d

	)

65 
	#TRANSPORT_USE_DATA_ONLY
 0x0000

	)

66 
	#TRANSPORT_USE_DATA_PLUS_CONTROL
 0x0001

	)

68 
	#POLICY_ROUND_ROBIN
 0x00000001

	)

69 
	#POLICY_WEIGHTED_ROUND_ROBIN
 0x00000002

	)

70 
	#POLICY_RANDOM
 0x00000003

	)

71 
	#POLICY_WEIGHTED_RANDOM
 0x00000004

	)

72 
	#POLICY_LEAST_USED
 0x40000001

	)

73 
	#POLICY_LEAST_USED_W_DEGRADATION
 0x40000002

	)

74 
	#POLICY_PRIORITY_LEAST_USED
 0x40000003

	)

75 
	#POLICY_RANDOMIZED_LEAST_USED
 0x40000004

	)

77 
	#ERROR_UNRECOGNIZED_ERROR
 0x0

	)

78 
	#ERROR_UNRECOGNIZED_PARAMETER
 0x1

	)

79 
	#ERROR_UNRECOGNIZED_MESSAGE
 0x2

	)

80 
	#ERROR_INVALID_VALUES
 0x3

	)

81 
	#ERROR_NONUINIQUE_PE_IDENTIFIER
 0x4

	)

82 
	#ERROR_INCONSISTENT_POOLING_POLICY
 0x5

	)

83 
	#ERROR_LACK_OF_RESOURCES
 0x6

	)

84 
	#ERROR_INCONSISTENT_TRANSPORT_TYPE
 0x7

	)

85 
	#ERROR_INCONSISTENT_DATA_CONTROL_CONFIG
 0x8

	)

86 
	#ERROR_UNKNOWN_POOLHANDLE
 0x9

	)

89 
	s·¿mH—d”
 {

90 
ušt16
 
	mty³
;

91 
ušt16
 
	mËngth
;

94 
	s·¿mIpv4Addr
 {

95 
·¿mH—d”
 
	mhdr
;

96 
š_addr
 
	maddr
;

99 
	s·¿mIpv6Addr
 {

100 
·¿mH—d”
 
	mhdr
;

101 
š6_addr
 
	maddr
;

104 
	s·¿mSùpT¿n¥Üt
 {

105 
·¿mH—d”
 
	mhdr
;

106 
ušt16
 
	msùpPÜt
;

107 
ušt16
 
	mŒª¥ÜtU£
;

110 
	s·¿mTıT¿n¥Üt
 {

111 
·¿mH—d”
 
	mhdr
;

112 
ušt16
 
	mtıPÜt
;

113 
ušt16
 
	mŒª¥ÜtU£
;

116 
	s·¿mUdpT¿n¥Üt
 {

117 
·¿mH—d”
 
	mhdr
;

118 
ušt16
 
	mudpPÜt
;

119 
ušt16
 
	m»£rved
;

122 
	s·¿mPoŞMemb”S–eùiÚPŞicy
 {

123 
·¿mH—d”
 
	mhdr
;

124 
ušt32
 
	mpŞicyTy³
;

125 
ušt32
 
	m»£rved
[4];

128 
	s·¿mPoŞHªdË
 {

129 
·¿mH—d”
 
	mhdr
;

132 
	s·¿mPoŞEËm’t
 {

133 
·¿mH—d”
 
	mhdr
;

134 
ušt32
 
	m³Id’tif›r
;

135 
ušt32
 
	mhomeEÄpS”v”Id’tif›r
;

136 
št32
 
	m»gi¡¿tiÚLiã
;

139 
	s·¿mS”v”InfÜm©iÚ
 {

140 
·¿mH—d”
 
	mhdr
;

141 
ušt32
 
	m£rv”Id
;

142 
ušt32
 
	mmuÉiÿ¡
;

145 
	s·¿mO³¿tiÚE¼Ü
 {

146 
·¿mH—d”
 
	mhdr
;

149 
	s·¿mCook›
 {

150 
·¿mH—d”
 
	mhdr
;

153 
	s·¿mPeId’tif›r
 {

154 
·¿mH—d”
 
	mhdr
;

155 
ušt32
 
	m³Id’tif›r
;

158 
	s·¿mPeChecksum
 {

159 
·¿mH—d”
 
	mhdr
;

160 
ušt16
 
	mchecksum
;

161 
ušt16
 
	m·ddšg
;

164 
	s”rÜCau£
 {

165 
ušt16
 
	mÿu£Code
;

166 
ušt16
 
	mÿu£L’gth
;

171 
š™P¬amIpv4Addr
(
·¿mIpv4Addr
 *
·¿m
, 
š_addr
 
addr
);

174 
š™P¬amIpv6Addr
(
·¿mIpv6Addr
 *
·¿m
, 
š6_addr
 
addr
);

177 
š™P¬amSùpT¿n¥Üt
(
·¿mSùpT¿n¥Üt
 *
·¿m
, 
ušt16
 
pÜt
, ušt16 
Œª¥ÜtU£
);

180 
š™P¬amTıT¿n¥Üt
(
·¿mTıT¿n¥Üt
 *
·¿m
, 
ušt16
 
pÜt
,ušt16 
Œª¥ÜtU£
);

183 
š™P¬amUdpT¿n¥Üt
(
·¿mUdpT¿n¥Üt
 *
·¿m
, 
ušt16
 
pÜt
);

186 
š™P¬amPoŞMemb”S–eùiÚPŞicy
(
·¿mPoŞMemb”S–eùiÚPŞicy
 *
·¿m
, 
ušt32
 
pŞicyTy³
, ušt32 
lßdWeight
, ušt32 
lßdDeg
);

189 
š™P¬amPoŞHªdË
(
·¿mPoŞHªdË
 *
·¿m
, *
poŞHªdË
);

192 
š™P¬amPoŞEËm’t
(
·¿mPoŞEËm’t
 *
·¿m
, 
ušt32
 
³Id’tif›r
, ušt32 
homeEÄpS”v”Id’tif›r
, 
št32
 
»gi¡¿tiÚLiã
);

195 
š™P¬amS”v”InfÜm©iÚ
(
·¿mS”v”InfÜm©iÚ
 *
·¿m
, 
MB™
, 
ušt32
 
£rv”Id
);

198 
š™P¬amO³¿tiÚE¼Ü
(
·¿mO³¿tiÚE¼Ü
 *
·¿m
);

201 
š™P¬amCook›
(
·¿mCook›
 *
·¿m
);

204 
š™P¬amPeId’tif›r
(
·¿mPeId’tif›r
 *
·¿m
, 
ušt32
 
³Id’tif›r
);

207 
š™P¬amPeChecksum
(
·¿mPeChecksum
 *
·¿m
, 
checksumTy³FŞded
 
checksum
);

210 
š™E¼ÜCau£
(
”rÜCau£
 *
ÿu£
, 
ušt16
 
ÿu£Code
);

	@policy.c

37 
	~<¡dlib.h
>

38 
	~<¡ršg.h
>

40 
	~"pŞicy.h
"

41 
	~"debug.h
"

42 
	~"poŞ–em’t.h
"

44 
PŞicy


45 
	$pŞicyNew
() {

46 
PŞicy
 
pŞ
 = 
NULL
;

48 
pŞ
 = (
PŞicy
è
	`m®loc
((*pol));

49 
	`mem£t
(
pŞ
, 0, (*pol));

57  
pŞ
;

58 
	}
}

61 
	$pŞicyCheck
(
PŞicy
 
pŞicy
, 
PoŞEËm’t
 
–em’t
) {

62 ià(
pŞicy
 =ğ
NULL
) {

63 
	`logDebug
("policy is NULL");

67 ià(
–em’t
 =ğ
NULL
) {

68 
	`logDebug
("policy is NULL");

72 ià(
–em’t
->
³PŞicyID
 =ğ
pŞicy
->
pId
);

76 
	}
}

79 
	$pŞicyD–‘e
(
PŞicy
 
pŞicy
) {

80 ià(
pŞicy
 !ğ
NULL
) {

81 
	`logDebug
("deleting…olicy");

82 
	`mem£t
(
pŞicy
, 0, (*policy));

83 
	`ä“
(
pŞicy
);

88 
	}
}

	@policy.h

37 #iâdeà
_POLICY_H


38 
	#_POLICY_H
 1

	)

40 
	~"back’d.h
"

41 
	~"poŞ–em’t.h
"

43 
pŞicy_¡ruù
 *
	tPŞicy
;

44 
	spŞicy_¡ruù
 {

45 
ušt16
 
	mpId
;

52 
PŞicy


53 
pŞicyNew
();

56 
pŞicyCheck
(
PŞicy
 
pŞicy
, 
PoŞEËm’t
 
–em’t
);

59 
pŞicyD–‘e
(
PŞicy
 
pŞicy
);

	@poolelement.c

37 
	~<¡dlib.h
>

38 
	~<¡dio.h
>

39 
	~<¡ršg.h
>

41 
	~"poŞ–em’t.h
"

42 
	~"£rv”poŞ.h
"

43 
	~"»gi¡¿r£rv”.h
"

44 
	~"debug.h
"

45 
	~"ut.h
"

46 
	~"’½.h
"

48 
PoŞEËm’t


49 
	$poŞEËm’tNew
(
ušt32
 
³Ëm’tId
) {

50 
PoŞEËm’t
 
³
;

52 
³
 = (
PoŞEËm’t
è
	`m®loc
((*pe));

53 ià(
³
 =ğ
NULL
)

54  
NULL
;

56 
	`mem£t
(
³
, 0, (*pe));

58 
³
->
³LiãtimeExpœyTim”
 = 
	`tim”C»©e
(
hªdËLiãtimeExpœy
,…e, "LifetimeExpiry");

59 ià(
³
->
³LiãtimeExpœyTim”
 =ğ
NULL
) {

60 
	`ä“
(
³
);

61  
NULL
;

64 
³
->
³Id’tif›r
 = 
³Ëm’tId
;

65 
	`logDebug
("ü—‹d‚ew…oŞƒËm’ˆw™h id 0x%08x", 
³Ëm’tId
);

66  
³
;

67 
	}
}

70 
	$poŞEËm’tPršt
(
PoŞEËm’t
 
³
) {

71 ià(
³
 =ğ
NULL
) {

72 
	`logDebug
("pe is NULL\n");

77 
	`logDebug
("--- PoŞ EËm’ˆ0x%08x ---", 
³
->
³Id’tif›r
);

78 
	`logDebug
("³HomeRegi¡¿rS”v”: 0x%08x", 
³
->
³HomeRegi¡¿rS”v”
);

79 
	`logDebug
("³Regi¡¿tiÚLiã: %d", 
³
->
³Regi¡¿tiÚLiã
);

80 
	`logDebug
("³Checksum: 0x%08x", 
³
->
³Checksum
);

81 
	`logDebug
("³A§pT¿n¥ÜtPÜt: %d" , 
³
->
³A§pT¿n¥ÜtPÜt
);

82 
	`logDebug
("peASAPTransportAddr");

83 
	`add»ssLi¡Pršt
(
³
->
³A§pT¿n¥ÜtAddr
);

84 
	`logDebug
("³U£rT¿n¥ÜtPrÙocŞ: %d", 
³
->
³U£rT¿n¥ÜtPrÙocŞ
);

85 
	`logDebug
("peUserTransportAddr");

86 
	`add»ssLi¡Pršt
(
³
->
³U£rT¿n¥ÜtAddr
);

87 
	`logDebug
("³U£rT¿n¥ÜtU£: %d", 
³
->
³U£rT¿n¥ÜtU£
);

88 
	`logDebug
("³PŞicyID: %d", 
³
->
³PŞicyID
);

89 
	`logDebug
("³PŞicyWeightLßd: %d", 
³
->
³PŞicyWeightLßd
);

90 
	`logDebug
("³PŞicyLßdDeg¿d©iÚ: %d", 
³
->
³PŞicyLßdDeg¿d©iÚ
);

93 
	}
}

96 
	$poŞEËm’tD–‘e
(
PoŞEËm’t
 
³
) {

97 ià(
³
 =ğ
NULL
) {

98 
	`logDebug
("pe is NULL");

102 ià(
³
->
³La¡H—rdTimeout
 !ğ
NULL
) {

103 
	`logDebug
("deleting LastHeardTimeoutimer from…oolElement");

104 
	`tim”D–‘e
(
³
->
³La¡H—rdTimeout
);

106 ià(
³
->
³LiãtimeExpœyTim”
 !ğ
NULL
) {

107 
	`logDebug
("deleting LifetimeExpiryTimerimer from…oolElement");

108 
	`tim”D–‘e
(
³
->
³LiãtimeExpœyTim”
);

111 
	`logDebug
("d–‘šg…oŞƒËm’ˆ0x%08x", 
³
->
³Id’tif›r
);

113 
	`mem£t
(
³
, 0, (*pe));

114 
	`ä“
(
³
);

117 
	}
}

	@poolelement.h

36 #iâdeà
_POOLELEMENT_H


37 
	#_POOLELEMENT_H
 1

	)

39 
	~<Ãtš‘/sùp.h
>

41 
	~"back’d.h
"

42 
	~"checksum.h
"

43 
	~"cblib.h
"

47 
	gpoŞ_–em’t_¡ruù
;

49 
poŞ_–em’t_¡ruù
 *
	tPoŞEËm’t
;

50 
	spoŞ_–em’t_¡ruù
 {

51 
PoŞEËm’t
 
	mpoŞNext
;

52 
PoŞEËm’t
 
	mpoŞP»v
;

54 
PoŞEËm’t
 
	m£rv”Next
;

55 
PoŞEËm’t
 
	m£rv”P»v
;

57 * 
	m³S”v”PoŞ
;

58 * 
	m³Regi¡¿rS”v”
;

60 
ušt32
 
	m³Id’tif›r
;

61 
ušt32
 
	m³HomeRegi¡¿rS”v”
;

62 
št32
 
	m³Regi¡¿tiÚLiã
;

63 
checksumTy³
 
	m³Checksum
;

65 
Tim”
 
	m³La¡H—rdTimeout
;

66 
	m³La¡H—rdTimeoutCÁ
;

67 
Tim”
 
	m³LiãtimeExpœyTim”
;

69 
ušt16
 
	m³A§pT¿n¥ÜtPÜt
;

70 
Add»ss
 
	m³A§pT¿n¥ÜtAddr
[
MAX_ADDR_CNT
];

71 
sùp_assoc_t
 
	m³A§pAssocId
;

73 
ušt8
 
	m³U£rT¿n¥ÜtPrÙocŞ
;

74 
ušt16
 
	m³U£rT¿n¥ÜtPÜt
;

75 
Add»ss
 
	m³U£rT¿n¥ÜtAddr
[
MAX_ADDR_CNT
];

76 
ušt16
 
	m³U£rT¿n¥ÜtU£
;

78 
ušt32
 
	m³PŞicyID
;

79 
ušt32
 
	m³PŞicyWeightLßd
;

80 
ušt32
 
	m³PŞicyLßdDeg¿d©iÚ
;

83 
PoŞEËm’t


84 
poŞEËm’tNew
(
ušt32
 
³Ëm’tId
);

87 
poŞEËm’tPršt
(
PoŞEËm’t
 
³
);

90 
poŞEËm’tD–‘e
(
PoŞEËm’t
 
³
);

	@registrarserver.c

36 
	~<¡dlib.h
>

37 
	~<¡dio.h
>

38 
	~<¡ršg.h
>

40 
	~"»gi¡¿r£rv”.h
"

41 
	~"back’d.h
"

42 
	~"cblib.h
"

43 
	~"ÿÎbacks.h
"

44 
	~"’½.h
"

45 
	~"poŞ–em’t.h
"

46 
	~"checksum.h
"

47 
	~"ut.h
"

48 
	~"debug.h
"

51 
Regi¡¿rS”v”
 
	g»gi¡¿rS”v”Li¡
;

52 
Regi¡¿rS”v”
 
	gthis
;

55 
Regi¡¿rS”v”


56 
	$»gi¡¿rS”v”New
(
ušt32
 
£rv”Id
) {

57 
Regi¡¿rS”v”
 
£rv”
 = 
NULL
;

58 
tim”Name
[
TIMER_DESCRIPTION_LENGTH
 + 1];

60 
£rv”
 = (
Regi¡¿rS”v”
è
	`m®loc
((*server));

61 ià(
£rv”
 =ğ
NULL
)

62  
NULL
;

64 
	`mem£t
(
£rv”
, 0, (*server));

65 
	`mem£t
(
tim”Name
, 0, (timerName));

67 
£rv”
->
rsId’tif›r
 = 
£rv”Id
;

68 
£rv”
->
rsAùive
 = 1;

69 
£rv”
->
rsChecksum
 = 0;

71 
	`¢´štf
(
tim”Name
, 
TIMER_DESCRIPTION_LENGTH
, "³”†a¡ h—rdimeouˆfÜ„egi¡¿¸0x%08x", 
£rv”Id
);

72 
£rv”
->
rsLa¡H—rdTimeout
 = 
	`tim”C»©e
(
³”La¡H—rdTimeout
, &£rv”->
rsId’tif›r
, 
tim”Name
);

73 
	`tim”S¹
(
£rv”
->
rsLa¡H—rdTimeout
, 
MAX_TIME_LAST_HEARD
);

75 
	`logDebug
("ü—‹d‚ew„egi¡¿¸£rv” w™h id: 0x%08x", 
£rv”Id
);

76  
£rv”
;

77 
	}
}

80 
	$»gi¡¿rS”v”AddPoŞEËm’t
(
Regi¡¿rS”v”
 
£rv”
, 
PoŞEËm’t
 
ÃwPoŞEËm’t
) {

81 ià(
ÃwPoŞEËm’t
 =ğ
NULL
) {

82 
	`logDebug
("newPoolElement is NULL");

86 ià(
£rv”
 =ğ
NULL
) {

87 
	`logDebug
("server is NULL");

92 ià(
	`»gi¡¿rS”v”G‘PoŞEËm’tById
(
£rv”
, 
ÃwPoŞEËm’t
->
³Id’tif›r
è!ğ
NULL
) {

93 
	`logDebug
("³Ëm’ˆw™h id 0x%08x i ®»ady iÀli¡, cª‚Ù‡dd it", 
ÃwPoŞEËm’t
->
³Id’tif›r
);

97 
£rv”
->
rsChecksum
 = 
	`checksumAdd
(£rv”->rsChecksum, 
ÃwPoŞEËm’t
->
³Checksum
);

99 
ÃwPoŞEËm’t
->
£rv”P»v
 = 
NULL
;

100 
ÃwPoŞEËm’t
->
£rv”Next
 = 
£rv”
->
rsPeLi¡
;

101 ià(
£rv”
->
rsPeLi¡
) {

102 
£rv”
->
rsPeLi¡
->
£rv”P»v
 = 
ÃwPoŞEËm’t
;

104 
£rv”
->
rsPeLi¡
 = 
ÃwPoŞEËm’t
;

106 
ÃwPoŞEËm’t
->
³Regi¡¿rS”v”
 = 
£rv”
;

108 
	`tim”S¹
(
ÃwPoŞEËm’t
->
³LiãtimeExpœyTim”
,‚ewPoŞEËm’t->
³Regi¡¿tiÚLiã
);

110 
	`logDebug
("added 0x%08xØ£rv”", 
ÃwPoŞEËm’t
->
³Id’tif›r
);

112 
	}
}

115 
	$»gi¡¿rS”v”RemovePoŞEËm’t
(
Regi¡¿rS”v”
 
£rv”
, 
PoŞEËm’t
 
³Ëm’t
) {

116 ià(
£rv”
 =ğ
NULL
) {

117 
	`logDebug
("server is NULL");

121 ià(
³Ëm’t
 =ğ
NULL
) {

122 
	`logDebug
("pelement is NULL");

126 
	`tim”Stİ
(
³Ëm’t
->
³LiãtimeExpœyTim”
);

127 
£rv”
->
rsChecksum
 = 
	`checksumSub
(£rv”->rsChecksum, 
³Ëm’t
->
³Checksum
);

129 
³Ëm’t
->
³Regi¡¿rS”v”
 = 
NULL
;

131 ià(
³Ëm’t
->
£rv”P»v
)

132 
³Ëm’t
->
£rv”P»v
->
£rv”Next
 =…element->serverNext;

133 ià(
³Ëm’t
->
£rv”Next
)

134 
³Ëm’t
->
£rv”Next
->
£rv”P»v
 =…element->serverPrev;

135 ià(
£rv”
->
rsPeLi¡
 =ğ
³Ëm’t
) {

136 
£rv”
->
rsPeLi¡
 = 
³Ëm’t
->
£rv”Next
;

138 
³Ëm’t
->
£rv”P»v
 = 
NULL
;

139 
³Ëm’t
->
£rv”Next
 = 
NULL
;

141 
	`logDebug
("»moved 0x%08x from†i¡", 
³Ëm’t
->
³Id’tif›r
);

143 
	}
}

146 
	$»gi¡¿rS”v”Re£tTim”
(
Regi¡¿rS”v”
 
£rv”
) {

147 ià(
£rv”
 =ğ
NULL
) {

148 
	`logDebug
("server is NULL");

152 ià(
£rv”
->
rsLa¡H—rdTimeout
 =ğ
NULL
) {

153 
	`logDebug
("server->rsLastHeardTimeout is NULL");

157 
	`logDebug
("»£‰šg†a¡ h—rdim” fÜ 0x%08x", 
£rv”
->
rsId’tif›r
);

158 
	`tim”S¹
(
£rv”
->
rsLa¡H—rdTimeout
, 
MAX_TIME_LAST_HEARD
);

159 
£rv”
->
rsLa¡H—rdTimeoutCÁ
 = 0;

162 
	}
}

164 
ušt16


165 
	$»gi¡¿rS”v”G‘Checksum
(
ušt32
 
£rv”Id
) {

166 
Regi¡¿rS”v”
 
£rv”
;

168 
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
£rv”Id
);

170 ià(
£rv”
 =ğ
NULL
) {

171 
	`logDebug
("server is NULL,„eturned checksum is‚ot valid");

172  (
ušt16
) -1;

175  
	`checksumFŞd
(
£rv”
->
rsChecksum
);

176 
	}
}

178 
PoŞEËm’t


179 
	$»gi¡¿rS”v”G‘PoŞEËm’tById
(
Regi¡¿rS”v”
 
£rv”
, 
ušt32
 
³Ëm’tId
) {

180 
PoŞEËm’t
 
³Ëm’t
 = 
NULL
;

181 
PoŞEËm’t
 
³Li¡
 = 
NULL
;

183 ià(
£rv”
 =ğ
NULL
) {

184 
	`logDebug
("server is NULL");

185  
NULL
;

188 
³Li¡
 = 
£rv”
->
rsPeLi¡
;

190 
³Ëm’t
 = 
³Li¡
;…–em’t;…–em’ˆğ³Ëm’t->
£rv”Next
) {

191 ià(
³Ëm’t
->
³Id’tif›r
 =ğ
³Ëm’tId
) {

192  
³Ëm’t
;

196  
NULL
;

197 
	}
}

200 
	$»gi¡¿rS”v”Pršt
(
Regi¡¿rS”v”
 
£rv”
) {

201 
PoŞEËm’t
 
³Ëm’t
;

203 
	`logDebug
("--- S”v” 0x%08x ---", 
£rv”
->
rsId’tif›r
);

204 
	`logDebug
("rsA§pPÜt: %d", 
£rv”
->
rsA§pPÜt
);

205 
	`logDebug
("rsAsapAddr:");

206 
	`add»ssLi¡Pršt
(
£rv”
->
rsA§pAddr
);

207 
	`logDebug
("rsEÄpPÜt: %d", 
£rv”
->
rsEÄpPÜt
);

208 
	`logDebug
("rsEnrpAddr:");

209 
	`add»ssLi¡Pršt
(
£rv”
->
rsEÄpAddr
);

211 
³Ëm’t
 = 
£rv”
->
rsPeLi¡
;…–em’t;…–em’ˆğ³Ëm’t->
£rv”Next
) {

212 
	`poŞEËm’tPršt
(
³Ëm’t
);

214 
	}
}

217 
	$»gi¡¿rS”v”D–‘e
(
Regi¡¿rS”v”
 
£rv”
) {

218 
	`logDebug
("d–‘šg„egi¡¿¸£rv” 0x%08x", 
£rv”
->
rsId’tif›r
);

220 ià(
£rv”
 =ğ
NULL
) {

221 
	`logDebug
("server is NULL");

225 ià(
£rv”
->
rsPeLi¡
 !ğ
NULL
) {

226 
	`logDebug
("rsPeList is‚ot NULL");

230 ià(
£rv”
->
rsLa¡H—rdTimeout
 !ğ
NULL
) {

231 
	`logDebug
("deletingimer");

232 
	`tim”Stİ
(
£rv”
->
rsLa¡H—rdTimeout
);

233 
	`tim”D–‘e
(
£rv”
->
rsLa¡H—rdTimeout
);

236 
	`mem£t
(
£rv”
, 0, (*server));

237 
	`ä“
(
£rv”
);

240 
	}
}

243 
	$»gi¡¿rS”v”Li¡AddS”v”
(
Regi¡¿rS”v”
 
ÃwRegi¡¿rS”v”
) {

244 ià(!
ÃwRegi¡¿rS”v”
) {

245 
	`logDebug
("newRegistrarServer is NULL\n");

250 ià(
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
ÃwRegi¡¿rS”v”
->
rsId’tif›r
è!ğ
NULL
) {

251 
	`logDebug
("£rv” w™h id 0x%08x i ®»ady iÀli¡, cª‚Ù‡dd it\n", 
ÃwRegi¡¿rS”v”
->
rsId’tif›r
);

255 
ÃwRegi¡¿rS”v”
->
´ev
 = 
NULL
;

256 
ÃwRegi¡¿rS”v”
->
Ãxt
 = 
»gi¡¿rS”v”Li¡
;

257 ià(
»gi¡¿rS”v”Li¡
) {

258 
»gi¡¿rS”v”Li¡
->
´ev
 = 
ÃwRegi¡¿rS”v”
;

260 
»gi¡¿rS”v”Li¡
 = 
ÃwRegi¡¿rS”v”
;

262 
	`logDebug
("added 0x%08xØli¡", 
ÃwRegi¡¿rS”v”
->
rsId’tif›r
);

264 
	}
}

267 
	$»gi¡¿rS”v”Li¡RemoveS”v”
(
ušt32
 
£rv”Id
) {

268 
Regi¡¿rS”v”
 
£rv”
;

271 ià((
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
£rv”Id
)è=ğ
NULL
) {

272 
	`logDebug
("0x%08x i nÙ iÀli¡, cª‚Ù d–‘™", 
£rv”Id
);

276 ià(
£rv”
->
´ev
) {

277 
£rv”
->
´ev
->
Ãxt
 = server->next;

279 ià(
£rv”
->
Ãxt
) {

280 
£rv”
->
Ãxt
->
´ev
 = server->prev;

282 ià(
»gi¡¿rS”v”Li¡
 =ğ
£rv”
) {

283 
»gi¡¿rS”v”Li¡
 = 
£rv”
->
Ãxt
;

286 
	`»gi¡¿rS”v”D–‘e
(
£rv”
);

288 
	`logDebug
("»moved 0x%08x from†i¡", 
£rv”Id
);

290 
	}
}

293 
	$»gi¡¿rS”v”Li¡Pršt
() {

294 
Regi¡¿rS”v”
 
£rv”
 = 
NULL
;

296 
	`logDebug
("###### Registrar Server List ######");

297 
£rv”
 = 
»gi¡¿rS”v”Li¡
; s”v”; s”v” = s”v”->
Ãxt
) {

298 
	`»gi¡¿rS”v”Pršt
(
£rv”
);

300 
	`logDebug
("###################################");

301 
	}
}

303 
Regi¡¿rS”v”


304 
	$»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
ušt32
 
£rv”Id
) {

305 
Regi¡¿rS”v”
 
£rv”
 = 
NULL
;

307 
£rv”
 = 
»gi¡¿rS”v”Li¡
; s”v”; s”v” = s”v”->
Ãxt
) {

308 ià(
£rv”
->
rsId’tif›r
 =ğ
£rv”Id
) {

309  
£rv”
;

313  
NULL
;

314 
	}
}

316 
Regi¡¿rS”v”


317 
	$»gi¡¿rS”v”Li¡G‘S”v”ByAssocId
(
sùp_assoc_t
 
assocId
) {

318 
Regi¡¿rS”v”
 
£rv”
 = 
NULL
;

320 
£rv”
 = 
»gi¡¿rS”v”Li¡
; s”v”; s”v” = s”v”->
Ãxt
) {

321 ià(
£rv”
->
rsEÄpAssocId
 =ğ
assocId
) {

322  
£rv”
;

326  
NULL
;

327 
	}
}

	@registrarserver.h

36 #iâdeà
_REGISTRARSERVER_H


37 
	#_REGISTRARSERVER_H
 1

	)

39 
	~"back’d.h
"

40 
	~"cblib.h
"

41 
	~"poŞ–em’t.h
"

43 
»gi¡¿r_£rv”_¡ruù
 *
	tRegi¡¿rS”v”
;

44 
	s»gi¡¿r_£rv”_¡ruù
 {

45 
Regi¡¿rS”v”
 
	mÃxt
;

46 
Regi¡¿rS”v”
 
	m´ev
;

48 
ušt32
 
	mrsId’tif›r
;

49 
ušt32
 
	mrsChecksum
;

50 
Tim”
 
	mrsLa¡H—rdTimeout
;

51 
	mrsLa¡H—rdTimeoutCÁ
;

52 
	mrsAùive
;

54 
ušt16
 
	mrsEÄpPÜt
;

55 
Add»ss
 
	mrsEÄpAddr
[
MAX_ADDR_CNT
];

56 
sùp_assoc_t
 
	mrsEÄpAssocId
;

57 
	mrsU£sMuÉiCa¡
;

59 
PoŞEËm’t
 
	mrsPeLi¡
;

61 
ušt16
 
	mrsA§pPÜt
;

62 
Add»ss
 
	mrsA§pAddr
[
MAX_ADDR_CNT
];

63 
sùp_assoc_t
 
	mrsA§pAssocId
;

66 
Regi¡¿rS”v”
 
»gi¡¿rS”v”Li¡
;

67 
Regi¡¿rS”v”
 
this
;

69 
Regi¡¿rS”v”


70 
»gi¡¿rS”v”New
(
ušt32
 
£rv”Id
);

73 
»gi¡¿rS”v”Pršt
(
Regi¡¿rS”v”
 
£rv”
);

76 
»gi¡¿rS”v”AddPoŞEËm’t
(
Regi¡¿rS”v”
 
£rv”
, 
PoŞEËm’t
 
ÃwPoŞEËm’t
);

80 
»gi¡¿rS”v”RemovePoŞEËm’t
(
Regi¡¿rS”v”
 
£rv”
, 
PoŞEËm’t
 
ÃwPoŞEËm’t
);

83 
»gi¡¿rS”v”Re£tTim”
(
Regi¡¿rS”v”
 
£rv”
);

85 
ušt16


86 
»gi¡¿rS”v”G‘Checksum
(
ušt32
 
£rv”Id
);

88 
PoŞEËm’t


89 
»gi¡¿rS”v”G‘PoŞEËm’tById
(
Regi¡¿rS”v”
 
£rv”
, 
ušt32
 
³Ëm’tId
);

92 
»gi¡¿rS”v”D–‘e
(
Regi¡¿rS”v”
 
£rv”
);

95 
»gi¡¿rS”v”Li¡AddS”v”
(
Regi¡¿rS”v”
 
ÃwS”v”
);

98 
»gi¡¿rS”v”Li¡RemoveS”v”
(
ušt32
 
£rv”Id
);

101 
»gi¡¿rS”v”Li¡Pršt
();

103 
Regi¡¿rS”v”


104 
»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
ušt32
 
£rv”Id
);

106 
Regi¡¿rS”v”


107 
»gi¡¿rS”v”Li¡G‘S”v”ByAssocId
(
sùp_assoc_t
 
assocId
);

	@serverpool.c

36 
	~<¡dlib.h
>

37 
	~<¡dio.h
>

38 
	~<¡ršg.h
>

40 
	~"£rv”poŞ.h
"

41 
	~"poŞ–em’t.h
"

42 
	~"debug.h
"

43 
	~"checksum.h
"

44 
	~"ut.h
"

47 
S”v”PoŞ
 
	g£rv”PoŞLi¡
;

50 
S”v”PoŞ


51 
	$£rv”PoŞNew
(*
poŞHªdË
) {

52 
S”v”PoŞ
 
poŞ
 = 
NULL
;

54 ià(!
poŞHªdË
) {

55 
	`logDebug
("given…oolHandle is NULL");

56  
NULL
;

59 ià(
	`¡¾’
(
poŞHªdË
) == 0) {

60 
	`logDebug
("poolHandle†ength is 0");

61  
NULL
;

64 
poŞ
 = (
S”v”PoŞ
è
	`m®loc
((*pool));

65 
	`mem£t
(
poŞ
, 0, (*pool));

67 
poŞ
->
Ãxt
 = 
NULL
;

68 
poŞ
->
´ev
 = 
NULL
;

69 
poŞ
->
¥PeLi¡
 = 
NULL
;

70 
	`¡ºıy
(
poŞ
->
¥HªdË
, 
poŞHªdË
, 
POOLHANDLE_SIZE
);

72 
	`logDebug
("sucûssfuÎy c»©ed…oŞ: %s", 
poŞHªdË
);

73  
poŞ
;

74 
	}
}

77 
	$£rv”PoŞPršt
(
S”v”PoŞ
 
poŞ
) {

78 
PoŞEËm’t
 
³Ëm’t
 = 
NULL
;

80 
	`logDebug
("PoŞ \"%s\":", 
poŞ
->
¥HªdË
);

82 
³Ëm’t
 = 
poŞ
->
¥PeLi¡
;…–em’t;…–em’ˆğ³Ëm’t->
poŞNext
) {

83 
	`poŞEËm’tPršt
(
³Ëm’t
);

85 
	}
}

87 
PoŞEËm’t


88 
	$£rv”PoŞG‘PoŞEËm’tById
(
S”v”PoŞ
 
poŞ
, 
ušt32
 
³Ëm’tId
) {

89 
PoŞEËm’t
 
³Ëm’t
;

91 ià(!
poŞ
)

92  
NULL
;

94 
³Ëm’t
 = 
poŞ
->
¥PeLi¡
;…–em’t;…–em’ˆğ³Ëm’t->
poŞNext
)

95 ià(
³Ëm’t
->
³Id’tif›r
 =ğ
³Ëm’tId
)

96  
³Ëm’t
;

98  
NULL
;

99 
	}
}

102 
	$£rv”PoŞAddPoŞEËm’t
(
S”v”PoŞ
 
poŞ
, 
PoŞEËm’t
 
ÃwPoŞEËm’t
) {

103 
buf
[
POOLHANDLE_SIZE
 + 5];

104 
size_t
 
poŞHªdËL’
;

106 ià(!
ÃwPoŞEËm’t
) {

107 
	`logDebug
("newPoolElement is NULL\n");

111 ià(!
poŞ
) {

112 
	`logDebug
("pool is NULL\n");

117 
	`mem£t
(
buf
, 0, (buf));

118 
poŞHªdËL’
 = 
	`¡¾’
(
poŞ
->
¥HªdË
);

119 ià(
poŞHªdËL’
 < 
POOLHANDLE_SIZE
) {

120 
	`memıy
(
buf
, 
poŞ
->
¥HªdË
, 
poŞHªdËL’
);

121 
	`¥rštf
(
buf
 + 
	`ADD_PADDING
(
poŞHªdËL’
), "%d", 
	`htÚl
(
ÃwPoŞEËm’t
->
³Id’tif›r
));

122 
ÃwPoŞEËm’t
->
³Checksum
 = 
	`checksumCompu‹
(0, 
buf
, 
	`ADD_PADDING
(
poŞHªdËL’
) + 4);

124 
	`logDebug
("pool handle size isoo big, can‚ot calculate checksum");

129 ià(
	`£rv”PoŞG‘PoŞEËm’tById
(
poŞ
, 
ÃwPoŞEËm’t
->
³Id’tif›r
è!ğ
NULL
) {

130 
	`logDebug
("³Ëm’ˆw™h id 0x%08x i ®»ady iÀli¡, cª‚Ù‡dd it\n", 
ÃwPoŞEËm’t
->
³Id’tif›r
);

134 
ÃwPoŞEËm’t
->
poŞP»v
 = 
NULL
;

135 
ÃwPoŞEËm’t
->
poŞNext
 = 
poŞ
->
¥PeLi¡
;

136 ià(
poŞ
->
¥PeLi¡
) {

137 
poŞ
->
¥PeLi¡
->
poŞP»v
 = 
ÃwPoŞEËm’t
;

139 
poŞ
->
¥PeLi¡
 = 
ÃwPoŞEËm’t
;

141 
ÃwPoŞEËm’t
->
³S”v”PoŞ
 = 
poŞ
;

143 
	`logDebug
("added 0x%08xØpoŞ %s", 
ÃwPoŞEËm’t
->
³Id’tif›r
, 
poŞ
->
¥HªdË
);

145 
	}
}

148 
	$£rv”PoŞRemovePoŞEËm’t
(
S”v”PoŞ
 
poŞ
, 
ušt32
 
³Ëm’tId
) {

149 
PoŞEËm’t
 
³Ëm’t
;

152 ià((
³Ëm’t
 = 
	`£rv”PoŞG‘PoŞEËm’tById
(
poŞ
, 
³Ëm’tId
)è=ğ
NULL
) {

153 
	`logDebug
("0x%08x i nÙ iÀli¡, cª‚Ù d–‘™", 
³Ëm’tId
);

157 ià(
³Ëm’t
->
poŞP»v
) {

158 
³Ëm’t
->
poŞP»v
->
poŞNext
 =…element->poolNext;

160 ià(
³Ëm’t
->
poŞNext
) {

161 
³Ëm’t
->
poŞNext
->
poŞP»v
 =…element->poolPrev;

163 ià(
poŞ
->
¥PeLi¡
 =ğ
³Ëm’t
) {

164 
poŞ
->
¥PeLi¡
 = 
³Ëm’t
->
poŞNext
;

167 
³Ëm’t
->
³S”v”PoŞ
 = 
NULL
;

169 
	`poŞEËm’tD–‘e
(
³Ëm’t
);

171 
	`logDebug
("»moved 0x%08x from†i¡", 
³Ëm’tId
);

173 
	}
}

176 
	$£rv”PoŞD–‘e
(
S”v”PoŞ
 
poŞ
) {

177 ià(
poŞ
 =ğ
NULL
) {

178 
	`logDebug
("pool is NULL");

182 ià(
poŞ
->
¥PeLi¡
 !ğ
NULL
) {

183 
	`logDebug
("spPeList is‚ot NULL");

187 
	`logDebug
("poŞ % wÈbd–‘ed", 
poŞ
->
¥HªdË
);

188 
	`mem£t
(
poŞ
, 0, (*pool));

189 
	`ä“
(
poŞ
);

192 
	}
}

195 
	$£rv”PoŞLi¡AddPoŞ
(
S”v”PoŞ
 
ÃwPoŞEËm’t
) {

196 ià(!
ÃwPoŞEËm’t
) {

197 
	`logDebug
("newPoolElement is NULL");

202 ià(
	`£rv”PoŞLi¡G‘PoŞ
(
ÃwPoŞEËm’t
->
¥HªdË
è!ğ
NULL
) {

203 
	`logDebug
("poŞ % ®»adyƒxi¡s", 
ÃwPoŞEËm’t
->
¥HªdË
);

207 ià(
£rv”PoŞLi¡
) {

208 
£rv”PoŞLi¡
->
´ev
 = 
ÃwPoŞEËm’t
;

209 
ÃwPoŞEËm’t
->
´ev
 = 
NULL
;

210 
ÃwPoŞEËm’t
->
Ãxt
 = 
£rv”PoŞLi¡
;

211 
£rv”PoŞLi¡
 = 
ÃwPoŞEËm’t
;

213 
£rv”PoŞLi¡
 = 
ÃwPoŞEËm’t
;

214 
ÃwPoŞEËm’t
->
Ãxt
 = 
NULL
;

215 
ÃwPoŞEËm’t
->
´ev
 = 
NULL
;

218 
	`logDebug
("sucûssfuÎy‡dded % tØ£rv”poŞ†i¡", 
ÃwPoŞEËm’t
->
¥HªdË
);

220 
	}
}

223 
	$£rv”PoŞLi¡Pršt
() {

224 
S”v”PoŞ
 
poŞ
;

226 
	`logDebug
("###### Server Pool List ######");

227 
poŞ
 = 
£rv”PoŞLi¡
;…oŞ;…oŞ =…oŞ->
Ãxt
) {

228 
	`£rv”PoŞPršt
(
poŞ
);

230 
	`logDebug
("##############################");

231 
	}
}

233 
S”v”PoŞ


234 
	$£rv”PoŞLi¡G‘PoŞ
(*
poŞHªdË
) {

235 
S”v”PoŞ
 
poŞ
 = 
NULL
;

237 ià(!
poŞHªdË
) {

238 
	`logDebug
("poolHandle is NULL");

239  
poŞ
;

242 
poŞ
 = 
£rv”PoŞLi¡
;…oŞ;…oŞ =…oŞ->
Ãxt
)

243 ià(
	`¡ºcmp
(
poŞ
->
¥HªdË
, 
poŞHªdË
, 
POOLHANDLE_SIZE
) == 0)

244  
poŞ
;

246  
NULL
;

247 
	}
}

250 
	$£rv”PoŞLi¡RemovePoŞ
(*
poŞHªdË
) {

251 
S”v”PoŞ
 
poŞ
;

253 ià(!
poŞHªdË
) {

254 
	`logDebug
("poolHandle is NULL");

259 ià((
poŞ
 = 
	`£rv”PoŞLi¡G‘PoŞ
(
poŞHªdË
)è=ğ
NULL
) {

260 
	`logDebug
("% i nÙ iÀli¡, cª‚Ù d–‘™", 
poŞHªdË
);

264 ià(
£rv”PoŞLi¡
 =ğ
poŞ
) {

265 
£rv”PoŞLi¡
 = 
NULL
;

267 
poŞ
->
Ãxt
->
´ev
 =…ool->prev;

270 
	`£rv”PoŞD–‘e
(
poŞ
);

272 
	`logDebug
("»moved % äom s”v”…oŞ†i¡\n", 
poŞHªdË
);

274 
	}
}

	@serverpool.h

36 #iâdeà
_SERVERPOOL_H


37 
	#_SERVERPOOL_H
 1

	)

39 
	~"back’d.h
"

40 
	~"poŞ–em’t.h
"

41 
	~"pŞicy.h
"

43 
	#POOLHANDLE_SIZE
 32

	)

45 
£rv”_poŞ_¡ruù
 *
	tS”v”PoŞ
;

46 
	s£rv”_poŞ_¡ruù
 {

47 
S”v”PoŞ
 
	mÃxt
;

48 
S”v”PoŞ
 
	m´ev
;

49 
	m¥HªdË
[
POOLHANDLE_SIZE
 + 1];

50 
PoŞEËm’t
 
	m¥PeLi¡
;

51 
PŞicy
 
	m¥PŞicy
;

54 
S”v”PoŞ
 
£rv”PoŞLi¡
;

56 
S”v”PoŞ


57 
£rv”PoŞNew
(*
poŞHªdË
);

59 
PoŞEËm’t


60 
£rv”PoŞG‘PoŞEËm’tById
(
S”v”PoŞ
 
poŞ
, 
ušt32
 
³Ëm’tId
);

63 
£rv”PoŞPršt
(
S”v”PoŞ
 
poŞ
);

66 
£rv”PoŞAddPoŞEËm’t
(
S”v”PoŞ
 
poŞ
, 
PoŞEËm’t
 
ÃwPoŞEËm’t
);

69 
£rv”PoŞRemovePoŞEËm’t
(
S”v”PoŞ
 
poŞ
, 
ušt32
 
³Ëm’tId
);

72 
£rv”PoŞD–‘e
(
S”v”PoŞ
 
poŞ
);

75 
£rv”PoŞLi¡Pršt
();

78 
£rv”PoŞLi¡AddPoŞ
(
S”v”PoŞ
 
ÃwS”v”PoŞ
);

80 
S”v”PoŞ


81 
£rv”PoŞLi¡G‘PoŞ
(*
poŞHªdË
);

84 
£rv”PoŞLi¡RemovePoŞ
(*
poŞHªdË
);

	@takeover.c

36 
	~<¡dlib.h
>

37 
	~<¡ršg.h
>

39 
	~"»gi¡¿r£rv”.h
"

40 
	~"keov”.h
"

41 
	~"cblib.h
"

42 
	~"back’d.h
"

43 
	~"debug.h
"

44 
	~"a§p.h
"

45 
	~"’½.h
"

48 
Takeov”
 
	gkeov”Li¡
;

51 
Takeov”


52 
	$keov”New
(
ušt32
 
rg‘S”v”Id
) {

53 
Takeov”
 
ÃwTakeov”
 = 
NULL
;

54 
»gi¡¿rCouÁ
 = 0;

55 
Regi¡¿rS”v”
 
£rv”
 = 
NULL
;

56 
tim”Name
[
TIMER_DESCRIPTION_LENGTH
];

58 ià(
rg‘S”v”Id
 =ğ
ownId
) {

59 
	`logDebug
("can‚otakeover myself, ABORT");

60  
NULL
;

63 
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
rg‘S”v”Id
);

65 ià(
£rv”
 =ğ
NULL
) {

66 
	`logDebug
("server is‚ot in†ist");

67  
NULL
;

70 
£rv”
->
rsAùive
 = 0;

72 
ÃwTakeov”
 = (
Takeov”
è
	`m®loc
((*newTakeover));

73 
	`mem£t
(
ÃwTakeov”
, 0, (*newTakeover));

75 
£rv”
 = 
»gi¡¿rS”v”Li¡
; s”v”->
Ãxt
; server = server->next) {

76 ià(
£rv”
->
rsId’tif›r
 =ğ
ownId
 || s”v”->rsId’tif›¸=ğ
rg‘S”v”Id
)

78 
»gi¡¿rCouÁ
++;

81 
	`mem£t
(
tim”Name
, 0, (timerName));

82 
	`¢´štf
(
tim”Name
, 
TIMER_DESCRIPTION_LENGTH
, "keov”Tim” fÜ¬g‘S”v”: 0x%08x", 
rg‘S”v”Id
);

84 
ÃwTakeov”
->
rg‘S”v”Id
 =argetServerId;

85 
ÃwTakeov”
->
expœeTim”
 = 
	`tim”C»©e
(
keov”C®lback
,‚ewTakeov”, 
tim”Name
);

86 
ÃwTakeov”
->
Ãxt
 = 
NULL
;

87 
ÃwTakeov”
->
´ev
 = 
NULL
;

88 
ÃwTakeov”
->
li¡Size
 = 
»gi¡¿rCouÁ
;

89 
ÃwTakeov”
->
ackedS”v”s
 = (
ušt32
 *è
	`m®loc
(
»gi¡¿rCouÁ
 * (uint32));

91 
	`mem£t
(
ÃwTakeov”
->
ackedS”v”s
, 0, 
»gi¡¿rCouÁ
 * (
ušt32
));

93 
ÃwTakeov”
->
´ev
 = 
NULL
;

94 
ÃwTakeov”
->
Ãxt
 = 
keov”Li¡
;

95 ià(
keov”Li¡
) {

96 
keov”Li¡
->
´ev
 = 
ÃwTakeov”
;

98 
keov”Li¡
 = 
ÃwTakeov”
;

100 
	`tim”S¹
(
ÃwTakeov”
->
expœeTim”
, 
TAKEOVER_TIMEOUT
);

101  
ÃwTakeov”
;

102 
	}
}

104 
Takeov”


105 
	$keov”Lookup
(
ušt32
 
rg‘S”v”Id
) {

106 
Takeov”
 
tmp
 = 
NULL
;

108 
	`logDebug
("lookšg u°keov”´oûs 0x%08x", 
rg‘S”v”Id
)

110 
tmp
 = 
keov”Li¡
;m°!ğ
NULL
;m°ğtmp->
Ãxt
)

111 ià(
tmp
->
rg‘S”v”Id
 ==argetServerId)

112  
tmp
;

114  
NULL
;

115 
	}
}

118 
	$keov”AckS”v”
(
Takeov”
 
keov”
, 
ušt32
 
£rv”Id
) {

119 
Regi¡¿rS”v”
 
£rv”
 = 
NULL
;

120 
i
;

122 ià(
keov”
 =ğ
NULL
) {

123 
	`logDebug
("takeover is NULL");

127 
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
£rv”Id
);

128 ià(
£rv”
 =ğ
NULL
) {

129 
	`logDebug
("server is‚ot in†ist");

133 
i
 = 0; i < 
keov”
->
li¡Size
; i++) {

134 ià(
keov”
->
ackedS”v”s
[
i
] =ğ
£rv”Id
) {

135 
	`logDebug
("®»ady‡cked s”v”Id oà0x%08x", 
£rv”Id
);

138 ià(
keov”
->
ackedS”v”s
[
i
] == 0) {

139 
keov”
->
ackedS”v”s
[
i
] = 
£rv”Id
;

140 
keov”
->
ackedS”v”CouÁ
++;

144 ià(
keov”
->
li¡Size
 =ğkeov”->
ackedS”v”CouÁ
) {

145 
	`logDebug
("all servers have‡ckedhe init, doingheakeover")

146 
	`keov”DoTakeov”
(
keov”
);

150 
	}
}

153 
	$keov”DoTakeov”
(
Takeov”
 
keov”
) {

154 
Regi¡¿rS”v”
 
rg‘S”v”
;

155 
PoŞEËm’t
 
–em’t
;

156 
ušt32
 
£rv”Id
;

158 ià(
keov”
 =ğ
NULL
) {

159 
	`logDebug
("takeover is NULL");

163 
rg‘S”v”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
keov”
->
rg‘S”v”Id
);

164 ià(
rg‘S”v”
 =ğ
NULL
) {

165 
	`logDebug
("targetServero beaken over is NULL,‡bort\n\n");

169 
£rv”Id
 = 
rg‘S”v”
->
rsId’tif›r
;

171 
	`£ndEÄpTakeov”S”v”
(0, 
keov”
->
rg‘S”v”Id
, 0);

173 ià(
rg‘S”v”
->
rsPeLi¡
 =ğ
NULL
) {

174 
	`logDebug
("target server has‚oƒlementso move");

176 
	`logDebug
("movšg‡Î…oŞƒËm’t äom 0x%08xØ0x%08x", 
rg‘S”v”
->
rsId’tif›r
, 
ownId
);

177 
–em’t
 = 
rg‘S”v”
->
rsPeLi¡
;

178 
–em’t
) {

179 
PoŞEËm’t
 
ÃxtEËm’t
 = 
–em’t
->
£rv”Next
;

180 
	`»gi¡¿rS”v”RemovePoŞEËm’t
(
rg‘S”v”
, 
–em’t
);

181 
	`»gi¡¿rS”v”AddPoŞEËm’t
(
this
, 
–em’t
);

182 
–em’t
->
³HomeRegi¡¿rS”v”
 = 
ownId
;

184 
	`£ndA§pEndpoštK“pAlive
(
–em’t
, 1);

185 
–em’t
 = 
ÃxtEËm’t
;

189 
	`keov”D–‘e
(
keov”
);

191 
	`»gi¡¿rS”v”Li¡RemoveS”v”
(
£rv”Id
);

192 
	`logDebug
("fšishedakeov” oà0x%08x", 
£rv”Id
);

195 
	}
}

198 
	$keov”C®lback
(*
¬g
) {

199 
Takeov”
 
keov”
 = (Takeov”è
¬g
;

201 
	`logDebug
("takeoverCallback called");

203 ià(
¬g
 =ğ
NULL
) {

204 
	`logDebug
("arg is NULL");

208 
	`logDebug
("thkeov” fÜ 0x%08ximed out, došghkeov”", 
keov”
->
rg‘S”v”Id
);

210 
	`keov”DoTakeov”
(
keov”
);

213 
	}
}

216 
	$keov”Li¡Pršt
() {

217 
Takeov”
 
tmp
;

219 ià(
keov”Li¡
 =ğ
NULL
) {

220 
	`logDebug
("takeoverList isƒmpty");

224 
	`logDebug
("printing†ist ofakeover…rocesses");

225 
tmp
 = 
keov”Li¡
;m°!ğ
NULL
;m°ğtmp->
Ãxt
)

226 
	`keov”Pršt
(
tmp
);

229 
	}
}

232 
	$keov”Pršt
(
Takeov”
 
keov”
) {

233 
i
;

235 ià(!
keov”
) {

236 
	`logDebug
("takeover is NULL");

240 
	`logDebug
("add»ss: %°-‚ext: %p", (*)
keov”
, (*éakeov”->
Ãxt
);

241 
	`logDebug
("rg‘S”v”Id: 0x%08x", 
keov”
->
rg‘S”v”Id
);

243 
i
 = 0; i < 
keov”
->
li¡Size
; i++)

244 
	`logDebug
("ackedS”v”s[%d]: 0x%08x", 
i
, 
keov”
->
ackedS”v”s
[i]);

245 
	`tim”Pršt
(
keov”
->
expœeTim”
);

248 
	}
}

251 
	$keov”D–‘e
(
Takeov”
 
keov”
) {

252 ià(!
keov”
) {

253 
	`logDebug
("takeover is NULL");

257 ià(!
keov”
->
expœeTim”
) {

258 
	`logDebug
("expireTimer inakeover is NULL");

261 
	`tim”Stİ
(
keov”
->
expœeTim”
);

262 
	`tim”D–‘e
(
keov”
->
expœeTim”
);

265 ià(
keov”
->
ackedS”v”s
 =ğ
NULL
 ) {

266 
	`logDebug
("ackedServers is NULL");

268 
	`mem£t
(
keov”
->
ackedS”v”s
, 0,akeov”->
li¡Size
 * (
ušt32
));

269 
	`ä“
(
keov”
->
ackedS”v”s
);

272 
	`logDebug
("d–‘edakeov”…roûs d©¨fÜ¬g‘S”v”Id: 0x%08x", 
keov”
->
rg‘S”v”Id
);

274 ià(
keov”
->
´ev
) {

275 
keov”
->
´ev
->
Ãxt
 =akeover->next;

277 ià(
keov”
->
Ãxt
) {

278 
keov”
->
Ãxt
->
´ev
 =akeover->prev;

280 ià(
keov”Li¡
 =ğ
keov”
) {

281 
keov”Li¡
 = 
keov”
->
Ãxt
;

284 
	`mem£t
(
keov”
, 0, (*takeover));

285 
	`ä“
(
keov”
);

287 
	}
}

	@takeover.h

37 #iâdeà
_TAKEOVER_H_


38 
	#_TAKEOVER_H
 1

	)

40 
	~"cblib.h
"

41 
	~"back’d.h
"

43 
	#TAKEOVER_TIMEOUT
 60000

	)

45 
keov”_¡ruù
 *
	tTakeov”
;

46 
	skeov”_¡ruù
 {

48 
Takeov”
 
	mÃxt
;

49 
Takeov”
 
	m´ev
;

52 
ušt32
 
	mrg‘S”v”Id
;

55 
	mli¡Size
;

56 
ušt32
 *
	mackedS”v”s
;

57 
	mackedS”v”CouÁ
;

60 
Tim”
 
	mexpœeTim”
;

63 
Takeov”
 
keov”Li¡
;

65 
Takeov”


66 
keov”New
(
ušt32
 
rg‘S”v”Id
);

68 
Takeov”


69 
keov”Lookup
(
ušt32
 
rg‘S”v”Id
);

72 
keov”AckS”v”
(
Takeov”
 
keov”
, 
ušt32
 
£rv”Id
);

75 
keov”DoTakeov”
(
Takeov”
 
keov”
);

78 
keov”C®lback
(*
¬g
);

81 
keov”Li¡Pršt
();

84 
keov”Pršt
(
Takeov”
 
keov”
);

87 
keov”D–‘e
(
Takeov”
 
keov”
);

	@util.c

37 
	~<¡dlib.h
>

38 
	~<¡ršg.h
>

39 
	~<sys/ty³s.h
>

40 
	~<sys/sock‘.h
>

41 
	~<Ãtš‘/š.h
>

42 
	~<¬·/š‘.h
>

43 
	~<Ãtš‘/sùp.h
>

45 
	~"ut.h
"

46 
	~"debug.h
"

47 
	~"’½.h
"

48 
	~"poŞ–em’t.h
"

49 
	~"»gi¡¿r£rv”.h
"

51 
ušt8


52 
	$checkAndId’tifyMsg
(*
msg
, 
size_t
 
Ën
, 
sùp_assoc_t
 
assocId
) {

53 
msgH—d”
 *
hdr
;

54 
ušt8
 
ty³
 = 0;

55 
ušt16
 
Ëngth
;

56 *
off£t
;

57 
ušt16
 
·¿mTy³
;

58 
size_t
 
bufL’
;

59 
addrCÁ
;

60 
Regi¡¿rS”v”
 
£rv”
;

61 
ušt32
 
£nd”S”v”Id
 = 0;

63 ià(
Ën
 < 12 || 
msg
 =ğ
NULL
) {

64 
	`logDebug
("msg isƒmpty otoo small");

68 
hdr
 = (
msgH—d”
 *è
msg
;

69 
ty³
 = 
hdr
->type;

70 
Ëngth
 = 
	`Áohs
(
hdr
->length);

72 ià(
Ëngth
 !ğ
Ën
) {

73 
	`logDebug
("buffer†ength does‚ot match…aket†ength");

80 
£nd”S”v”Id
 = *((*è
msg
 + 1);

81 
£rv”
 = 
	`»gi¡¿rS”v”Li¡G‘S”v”ByS”v”Id
(
£nd”S”v”Id
);

82 
	`logDebug
("msg oàty³ %d‡nd†’gth %d„eûived from 0x%08x", 
ty³
, 
Ëngth
, 
£nd”S”v”Id
);

84 ià(
£rv”
 !ğ
NULL
) {

85 ià(
£rv”
->
rsEÄpAssocId
 !ğ
assocId
) {

86 
£rv”
->
rsEÄpAssocId
 = 
assocId
;

87 
	`logDebug
("added‡ssocId %dØ³” 0x%08x", 
assocId
, 
£nd”S”v”Id
);

91 ià(
msg
)

92  
ty³
;

98 
bufL’
 = 
Ën
;

99 
off£t
 = 
msg
;

101 
ty³
) {

102 
ENRP_PRESENCE
:

103 ià(
bufL’
 > (
’½P»£nû
)) {

104 
off£t
 +ğ(
’½P»£nû
);

105 
bufL’
 -ğ(
’½P»£nû
);

107 ià(
	`checkTLV
(
off£t
, 
bufL’
è=ğ
PARAM_SERVER_INFORMATION
) {

108 
off£t
 +ğ(
·¿mS”v”InfÜm©iÚ
);

109 
bufL’
 -ğ(
·¿mS”v”InfÜm©iÚ
);

111 ià(
	`checkTLV
(
off£t
, 
bufL’
è=ğ
PARAM_SCTP_TRANSPORT
) {

112 
off£t
 +ğ(
·¿mSùpT¿n¥Üt
);

113 
bufL’
 -ğ(
·¿mSùpT¿n¥Üt
);

115 (
·¿mTy³
 = 
	`checkTLV
(
off£t
, 
bufL’
)) != 0) {

116 ià(
addrCÁ
 =ğ
MAX_ADDR_CNT
) {

117 
	`logDebug
("to much‡dresses in sctpransport…aram");

121 ià(
·¿mTy³
 =ğ
PARAM_IPV4_ADDR
) {

122 
off£t
 +ğ(
·¿mIpv4Addr
);

123 
bufL’
 -ğ(
·¿mIpv4Addr
);

124 
addrCÁ
++;

125 } ià(
·¿mTy³
 =ğ
PARAM_IPV6_ADDR
) {

126 
off£t
 +ğ(
·¿mIpv6Addr
);

127 
bufL’
 -ğ(
·¿mIpv6Addr
);

128 
addrCÁ
++;

156 
ENRP_HANDLE_TABLE_REQUEST
:

157 ià(
bufL’
 !ğ(
’½HªdËTabËReque¡
))

161 
ENRP_HANDLE_TABLE_RESPONSE
:

162 ià(
bufL’
 > (
’½HªdËTabËRe¥Ú£
)) {

163 
off£t
 +ğ(
’½HªdËTabËRe¥Ú£
);

164 
bufL’
 -ğ(
’½HªdËTabËRe¥Ú£
);

166 (
·¿mTy³
 = 
	`checkTLV
(
off£t
, 
bufL’
)è!ğ
PARAM_POOL_HANDLE
) {

167 
off£t
 +ğ(
size_t
è((
·¿mH—d”
 *èoff£t)->
Ëngth
;

168 
off£t
 +ğ4 - (((
·¿mH—d”
 *èoff£t)->
Ëngth
) % 4;

169 
bufL’
 -ğ((
·¿mH—d”
 *è
off£t
)->
Ëngth
;

170 
bufL’
 -ğ4 - (((
·¿mH—d”
 *è
off£t
)->
Ëngth
) % 4;

172 (
·¿mTy³
 = 
	`checkTLV
(
off£t
, 
bufL’
)è!ğ
PARAM_POOL_ELEMENT
) {

173 
off£t
 +ğ(
·¿mPoŞEËm’t
);

174 
bufL’
 -ğ(
·¿mPoŞEËm’t
);

176 ià((
·¿mTy³
 = 
	`checkTLV
(
off£t
, 
bufL’
)è=ğ
PARAM_IPV6_ADDR
) {

177 
off£t
 +ğ(
·¿mIpv6Addr
);

178 
bufL’
 -ğ(
·¿mIpv6Addr
);

185 
ENRP_HANDLE_UPDATE
:

188 
ENRP_LIST_REQUEST
:

191 
ENRP_LIST_RESPONSE
:

194 
ENRP_INIT_TAKEOVER
:

197 
ENRP_INIT_TAKEOVER_ACK
:

200 
ENRP_TAKEOVER_SERVER
:

203 
ENRP_ERROR
:

210  
ty³
;

211 
	}
}

213 
PoŞEËm’t


214 
	$£ndBufãrToPoŞEËm’t
(*
off£t
, 
size_t
 *
bufSize
) {

215 
·¿mPoŞEËm’t
 *
³Ëm’t
;

216 
·¿mPoŞMemb”S–eùiÚPŞicy
 *
pŞicy
;

217 
PoŞEËm’t
 
³
 = 
NULL
;

218 
Ëngth
;

219 
Add»ss
 
u£rAddr
[
MAX_ADDR_CNT
];

220 
u£rAddrCÁ
;

221 
ušt16
 
u£rPÜt
;

222 
ušt16
 
u£rT¿n¥ÜtU£
;

223 
ušt8
 
u£rPrÙocŞ
;

224 
i
;

226 
Add»ss
 
a§pAddr
[
MAX_ADDR_CNT
];

227 
a§pAddrCÁ
;

228 
ušt16
 
a§pPÜt
;

229 
ušt16
 
a§pT¿n¥ÜtU£
;

230 
ušt8
 
a§pPrÙocŞ
;

232 ià(
	`checkTLV
(
off£t
, *
bufSize
è!ğ
PARAM_POOL_ELEMENT
) {

233 
	`logDebug
("buffer is‚ot‡…oolƒlement");

234  
NULL
;

237 
³Ëm’t
 = (
·¿mPoŞEËm’t
 *è
off£t
;

238 
off£t
 +ğ(
·¿mPoŞEËm’t
);

239 *
bufSize
 -ğ(
·¿mPoŞEËm’t
);

241 
Ëngth
 = 
	`£ndBufãrToT¿n¥ÜtAdd»s£s
(
off£t
, 
bufSize
, 
u£rAddr
, &
u£rAddrCÁ
, &
u£rPÜt
, &
u£rT¿n¥ÜtU£
, &
u£rPrÙocŞ
);

243 ià(
Ëngth
 < 0) {

244 
	`logDebug
("user‡ddress…arsing failed");

245  
NULL
;

247 
off£t
 +ğ
Ëngth
;

249 ià(
	`checkTLV
(
off£t
, *
bufSize
è=ğ
PARAM_POOL_MEMBER_SELECTION_POLICY
) {

250 
pŞicy
 = (
·¿mPoŞMemb”S–eùiÚPŞicy
 *è
off£t
;

251 
off£t
 +ğ
	`Áohs
(
pŞicy
->
hdr
.
Ëngth
);

252 *
bufSize
 -ğ
	`Áohs
(
pŞicy
->
hdr
.
Ëngth
);

254 
	`logDebug
("no…olicy given");

255  
NULL
;

258 
Ëngth
 = 
	`£ndBufãrToT¿n¥ÜtAdd»s£s
(
off£t
, 
bufSize
,

259 
a§pAddr
, &
a§pAddrCÁ
,

260 &
a§pPÜt
, &
a§pT¿n¥ÜtU£
,

261 &
a§pPrÙocŞ
);

263 ià(
Ëngth
 < 0) {

264 
	`logDebug
("asap‡ddress…arsing failed");

265  
NULL
;

267 
off£t
 +ğ
Ëngth
;

272 
³
 = 
	`poŞEËm’tNew
(
³Ëm’t
->
³Id’tif›r
);

273 ià(
³
) {

274 
³
->
³Regi¡¿tiÚLiã
 = 
	`Áohl
(
³Ëm’t
->
»gi¡¿tiÚLiã
);

275 
³
->
³HomeRegi¡¿rS”v”
 = 
	`Áohl
(
³Ëm’t
->
homeEÄpS”v”Id’tif›r
);

276 
³
->
³U£rT¿n¥ÜtU£
 = 
	`Áohs
(
u£rT¿n¥ÜtU£
);

277 
³
->
³U£rT¿n¥ÜtPrÙocŞ
 = 
u£rPrÙocŞ
;

278 
³
->
³U£rT¿n¥ÜtPÜt
 = 
u£rPÜt
;

279 
i
 = 0; i < 
MAX_ADDR_CNT
; i++) {

280 
³
->
³U£rT¿n¥ÜtAddr
[
i
] = 
u£rAddr
[i];

282 
³
->
³A§pT¿n¥ÜtPÜt
 = 
u£rPÜt
;

283 
i
 = 0; i < 
MAX_ADDR_CNT
; i++) {

284 
³
->
³A§pT¿n¥ÜtAddr
[
i
] = 
u£rAddr
[i];

286 
³
->
³PŞicyID
 = 
	`Áohl
(
pŞicy
->
pŞicyTy³
);

287 
³
->
³PŞicyWeightLßd
 = 
	`Áohs
(
pŞicy
->
hdr
.
Ëngth
è>ğ12 ? 
	`Áohl
ÕŞicy->
»£rved
[0]) : 0;

288 
³
->
³PŞicyLßdDeg¿d©iÚ
 = 
	`Áohs
(
pŞicy
->
hdr
.
Ëngth
è>ğ16 ? 
	`Áohl
ÕŞicy->
»£rved
[1]) : 0;

290 
	`poŞEËm’tPršt
(
³
);

293  
³
;

294 
	}
}

297 
	$poŞEËm’tToS’dBufãr
(
PoŞEËm’t
 
³
, *
off£t
) {

298 
·¿mPoŞEËm’t
 *
³Ëm’t
;

299 
·¿mPoŞMemb”S–eùiÚPŞicy
 *
pŞicy
;

300 
Ëngth
;

301 * 
Üigš®Off£t
 = 
off£t
;

303 ià(!
³
) {

304 
	`logDebug
("pe is NULL");

308 ià(!
off£t
) {

309 
	`logDebug
("offset is NULL");

313 
³Ëm’t
 = (
·¿mPoŞEËm’t
 *è
off£t
;

314 
	`š™P¬amPoŞEËm’t
(
³Ëm’t
,

315 
³
->
³Id’tif›r
,

316 
³
->
³HomeRegi¡¿rS”v”
,

317 
³
->
³Regi¡¿tiÚLiã
);

319 
off£t
 +ğ(
·¿mPoŞEËm’t
);

322 
Ëngth
 = 
	`Œª¥ÜtAdd»s£sToS’dBufãr
(
off£t
,

323 
³
->
³U£rT¿n¥ÜtAddr
,

324 
³
->
³U£rT¿n¥ÜtPÜt
,

325 
³
->
³U£rT¿n¥ÜtU£
,

326 
³
->
³U£rT¿n¥ÜtPrÙocŞ
);

328 ià(
Ëngth
 == -1) {

329 
	`logDebug
("user‡ddresso buffer conversion failed");

332 
off£t
 +ğ
Ëngth
;

333 
³Ëm’t
->
hdr
.
Ëngth
 = 
	`htÚs
Ö’gth + 
	`Áohs
(pelement->hdr.length));

337 
pŞicy
 = (
·¿mPoŞMemb”S–eùiÚPŞicy
 *è
off£t
;

338 
Ëngth
 = 
	`š™P¬amPoŞMemb”S–eùiÚPŞicy
(
pŞicy
, 
³
->
³PŞicyID
,…e->
³PŞicyWeightLßd
,…e->
³PŞicyLßdDeg¿d©iÚ
);

339 ià(
Ëngth
 == -1) {

340 
	`logDebug
("policyo buffer conversion failed");

343 
off£t
 +ğ
Ëngth
;

344 
³Ëm’t
->
hdr
.
Ëngth
 = 
	`htÚs
Ö’gth + 
	`Áohs
(pelement->hdr.length));

348 
Ëngth
 = 
	`Œª¥ÜtAdd»s£sToS’dBufãr
(
off£t
,

349 
³
->
³A§pT¿n¥ÜtAddr
,

350 
³
->
³A§pT¿n¥ÜtPÜt
,

351 
TRANSPORT_USE_DATA_ONLY
,

352 
IPPROTO_SCTP
);

354 ià(
Ëngth
 == -1) {

355 
	`logDebug
("asap‡ddresso buffer conversion failed");

358 
off£t
 +ğ
Ëngth
;

359 
³Ëm’t
->
hdr
.
Ëngth
 = 
	`htÚs
Ö’gth + 
	`Áohs
(pelement->hdr.length));

363  ()(()
off£t
 - ()
Üigš®Off£t
);;

364 
	}
}

367 
	$Œª¥ÜtAdd»s£sToS’dBufãr
(*
off£t
, 
Add»ss
 *
addrs
,

368 
ušt16
 
pÜt
, ušt16 
Œª¥ÜtU£
,

369 
ušt8
 
´ÙocŞ
) {

370 
·¿mSùpT¿n¥Üt
 *
sùpT¿ns
;

371 
·¿mUdpT¿n¥Üt
 *
udpT¿ns
;

372 
·¿mTıT¿n¥Üt
 *
tıT¿ns
;

373 
·¿mIpv4Addr
 *
v4Addr
;

374 
·¿mIpv6Addr
 *
v6Addr
;

375 
Ëngth
 = 0;

376 
i
;

378 ià(
off£t
 =ğ
NULL
) {

379 
	`logDebug
("offset is NULL");

383 ()
´ÙocŞ
) {

384 
IPPROTO_SCTP
:

385 
sùpT¿ns
 = (
·¿mSùpT¿n¥Üt
 *è
off£t
;

386 
off£t
 +ğ(
·¿mSùpT¿n¥Üt
);

387 
	`š™P¬amSùpT¿n¥Üt
(
sùpT¿ns
, 
pÜt
, 
Œª¥ÜtU£
);

389 
i
 = 0; i < 
MAX_ADDR_CNT
; i++) {

390 ià(
addrs
[
i
].
ty³
 =ğ
AF_INET
) {

391 
v4Addr
 = (
·¿mIpv4Addr
 *è
off£t
;

392 
off£t
 +ğ(
·¿mIpv4Addr
);

393 
Ëngth
 = 
	`š™P¬amIpv4Addr
(
v4Addr
, 
addrs
[
i
].
addr
.
š4
);

394 
	`logDebug
("added ipv4‡ddro sctpransport");

395 } if(
addrs
[
i
].
ty³
 =ğ
AF_INET6
) {

396 
v6Addr
 = (
·¿mIpv6Addr
 *è
off£t
;

397 
off£t
 +ğ(
·¿mIpv6Addr
);

398 
Ëngth
 = 
	`š™P¬amIpv6Addr
(
v6Addr
, 
addrs
[
i
].
addr
.
š6
);

399 
	`logDebug
("added ipv6‡ddro sctpransport");

403 
sùpT¿ns
->
hdr
.
Ëngth
 = 
	`htÚs
Ö’gth + 
	`Áohs
(sctpTrans->hdr.length));

406  
	`Áohs
(
sùpT¿ns
->
hdr
.
Ëngth
);

408 
IPPROTO_TCP
:

409 
tıT¿ns
 = (
·¿mTıT¿n¥Üt
 *è
off£t
;

410 
off£t
 +ğ(
·¿mTıT¿n¥Üt
);

411 
	`š™P¬amTıT¿n¥Üt
(
tıT¿ns
, 
pÜt
, 
Œª¥ÜtU£
);

413 ià(
addrs
[0].
ty³
 =ğ
AF_INET
) {

414 
v4Addr
 = (
·¿mIpv4Addr
 *è
off£t
;

415 
off£t
 +ğ(
·¿mIpv4Addr
);

416 
Ëngth
 = 
	`š™P¬amIpv4Addr
(
v4Addr
, 
addrs
[0].
addr
.
š4
);

417 } if(
addrs
[0].
ty³
 =ğ
AF_INET6
) {

418 
v6Addr
 = (
·¿mIpv6Addr
 *è
off£t
;

419 
off£t
 +ğ(
·¿mIpv6Addr
);

420 
Ëngth
 = 
	`š™P¬amIpv6Addr
(
v6Addr
, 
addrs
[0].
addr
.
š6
);

422 
	`logDebug
("invalid‡ddress in‡ddrs");

426 
tıT¿ns
->
hdr
.
Ëngth
 = 
	`htÚs
Ö’gth + 
	`Áohs
(tcpTrans->hdr.length));

428  
	`Áohs
(
tıT¿ns
->
hdr
.
Ëngth
);

430 
IPPROTO_UDP
:

431 
udpT¿ns
 = (
·¿mUdpT¿n¥Üt
 *è
off£t
;

432 
off£t
 +ğ(
·¿mUdpT¿n¥Üt
);

433 
	`š™P¬amUdpT¿n¥Üt
(
udpT¿ns
, 
pÜt
);

435 ià(
addrs
[0].
ty³
 =ğ
AF_INET
) {

436 
v4Addr
 = (
·¿mIpv4Addr
 *è
off£t
;

437 
off£t
 +ğ(
·¿mIpv4Addr
);

438 
Ëngth
 = 
	`š™P¬amIpv4Addr
(
v4Addr
, 
addrs
[0].
addr
.
š4
);

439 } if(
addrs
[0].
ty³
 =ğ
AF_INET6
) {

440 
v6Addr
 = (
·¿mIpv6Addr
 *è
off£t
;

441 
off£t
 +ğ(
·¿mIpv6Addr
);

442 
Ëngth
 = 
	`š™P¬amIpv6Addr
(
v6Addr
, 
addrs
[0].
addr
.
š6
);

444 
	`logDebug
("invalid‡ddress in‡ddrs");

448 
udpT¿ns
->
hdr
.
Ëngth
 = 
	`htÚs
Ö’gth + 
	`Áohs
(udpTrans->hdr.length));

450  
	`Áohs
(
udpT¿ns
->
hdr
.
Ëngth
);

453 
	`logDebug
("unknown…rotocol");

458 
	}
}

461 
	$£ndBufãrToT¿n¥ÜtAdd»s£s
(*
off£t
, 
size_t
 *
bufSize
,

462 
Add»ss
 *
addrs
, *
addrCÁ
,

463 
ušt16
 *
pÜt
, ušt16 *
Œª¥ÜtU£
,

464 
ušt8
 *
´ÙocŞ
) {

465 
·¿mH—d”
 *
hdr
;

466 
·¿mSùpT¿n¥Üt
 *
sùpT¿ns
;

467 
·¿mUdpT¿n¥Üt
 *
udpT¿ns
;

468 
·¿mTıT¿n¥Üt
 *
tıT¿ns
;

469 
·¿mIpv4Addr
 *
v4Addr
;

470 
·¿mIpv6Addr
 *
v6Addr
;

471 
Add»ss
 
addr
[
MAX_ADDR_CNT
];

472 
ušt16
 
·¿mTy³
;

473 
add»ssCÁ
 = 0;

474 
sucûss
;

475 * 
Üigš®Off£t
 = 
off£t
;

476 
i
;

478 
i
 = 0; i < 
MAX_ADDR_CNT
; i++) {

479 
addrs
[
i
].
ty³
 = 0;

482 ià(
off£t
 =ğ
NULL
)

485 ià(*
bufSize
 < (
·¿mH—d”
))

488 
hdr
 = (
·¿mH—d”
 *è
off£t
;

489 *
addrCÁ
 = 0;

491 
	`´štBuf
(
off£t
, *
bufSize
, "buffer");

493 
	`Áohs
(
hdr
->
ty³
)) {

494 
PARAM_SCTP_TRANSPORT
:

495 
	`logDebug
("parsing sctpransport…arameter");

496 
sucûss
 = 0;

497 ià(
	`checkTLV
(
off£t
, *
bufSize
è=ğ
PARAM_SCTP_TRANSPORT
) {

498 
size_t
 
pos
 = (
·¿mSùpT¿n¥Üt
);

499 cÚ¡ 
size_t
 
Ën
 = 
	`Áohs
(
hdr
->
Ëngth
);

501 
sùpT¿ns
 = (
·¿mSùpT¿n¥Üt
 *è
off£t
;

502 
off£t
 +ğ(
·¿mSùpT¿n¥Üt
);

503 *
bufSize
 -ğ(
·¿mSùpT¿n¥Üt
);

505 
sucûss
 = 1;

507 
pos
 < 
Ën
) {

508 
·¿mTy³
 = 
	`checkTLV
(
off£t
, *
bufSize
);

510 ià(*
addrCÁ
 > 
MAX_ADDR_CNT
) {

511 
sucûss
 = 0;

515 ià(
·¿mTy³
 =ğ
PARAM_IPV4_ADDR
) {

516 
	`logDebug
("parsing ipv4…arameter");

517 
v4Addr
 = (
·¿mIpv4Addr
 *è
off£t
;

518 
off£t
 +ğ(
·¿mIpv4Addr
);

519 
pos
 +ğ(
·¿mIpv4Addr
);

520 *
bufSize
 -ğ(
·¿mIpv4Addr
);

521 
addr
[
add»ssCÁ
].
ty³
 = 
AF_INET
;

522 
addr
[
add»ssCÁ
].addr.
š4
 = 
v4Addr
->addr;

523 
add»ssCÁ
++;

524 } ià(
·¿mTy³
 =ğ
PARAM_IPV6_ADDR
) {

525 
	`logDebug
("parsing ipv6…arameter");

526 
v6Addr
 = (
·¿mIpv6Addr
 *è
off£t
;

527 
off£t
 +ğ(
·¿mIpv6Addr
);

528 
pos
 +ğ(
·¿mIpv6Addr
);

529 *
bufSize
 -ğ(
·¿mIpv6Addr
);

530 
addr
[
add»ssCÁ
].
ty³
 = 
AF_INET6
;

531 
addr
[
add»ssCÁ
].addr.
š6
 = 
v6Addr
->addr;

532 
add»ssCÁ
++;

534 
	`logDebug
("could‚ot find‡ny‡ddress in here");

535 
sucûss
 = 0;

543 
	`logDebug
("no…roper sctpransport…aram found");

547 ià(
sucûss
 == 0) {

548 
	`logDebug
("·rsšg faed, bufSizi %lu ", (è*
bufSize
);

552 *
pÜt
 = 
	`Áohs
(
sùpT¿ns
->
sùpPÜt
);

553 *
Œª¥ÜtU£
 = 
sùpT¿ns
->transportUse;

554 *
´ÙocŞ
 = 
IPPROTO_SCTP
;

555 *
addrCÁ
 = 
add»ssCÁ
;

556 
	`memıy
(
addrs
, &
addr
, (
Add»ss
è* 
add»ssCÁ
);

559 
j
;

560 
addrBuf
[
INET6_ADDRSTRLEN
];

561 
	`logDebug
("parsed‡dresses");

562 
j
 = 0; j < *
addrCÁ
; j++) {

563 ià(
addrs
[
j
].
ty³
 =ğ
AF_INET6
) {

564 
	`š‘_Áİ
(
AF_INET6
, (*è&
addrs
[
j
].
addr
.
š6
, 
addrBuf
, (addrBuf));

565 
	`logDebug
("%s", 
addrBuf
);

566 } ià(
addrs
[
j
].
ty³
 =ğ
AF_INET
) {

567 
	`š‘_Áİ
(
AF_INET
, (*è&
addrs
[
j
].
addr
.
š4
, 
addrBuf
, (addrBuf));

568 
	`logDebug
("%s", 
addrBuf
);

573 
	`logDebug
("found %d‡dd»s£ š sù°Œª¥Üˆ·¿m‘” ", *
addrCÁ
);

576 
PARAM_TCP_TRANSPORT
:

577 
	`logDebug
("parsingcpransport…arameter");

578 ià(
	`checkTLV
(
off£t
, *
bufSize
è=ğ
PARAM_TCP_TRANSPORT
) {

579 
tıT¿ns
 = (
·¿mTıT¿n¥Üt
 *è
off£t
;

580 
off£t
 +ğ(
·¿mTıT¿n¥Üt
);

581 *
bufSize
 -ğ(
·¿mTıT¿n¥Üt
);

583 ià((
·¿mTy³
 = 
	`checkTLV
(
off£t
, *
bufSize
)) != 0) {

584 ià(
·¿mTy³
 =ğ
PARAM_IPV4_ADDR
) {

585 
v4Addr
 = (
·¿mIpv4Addr
 *è
off£t
;

586 
off£t
 +ğ(
·¿mIpv4Addr
);

587 *
bufSize
 -ğ(
·¿mIpv4Addr
);

588 
addr
[0].
ty³
 = 
AF_INET
;

589 
addr
[0].addr.
š4
 = 
v4Addr
->addr;

590 } ià(
·¿mTy³
 =ğ
PARAM_IPV6_ADDR
) {

591 
v6Addr
 = (
·¿mIpv6Addr
 *è
off£t
;

592 
off£t
 +ğ(
·¿mIpv6Addr
);

593 *
bufSize
 -ğ(
·¿mIpv6Addr
);

594 
addr
[0].
ty³
 = 
AF_INET6
;

595 
addr
[0].addr.
š6
 = 
v6Addr
->addr;

599 
	`logDebug
("no…ropercpransport…aram found");

603 ià(*
bufSize
 != 0) {

604 
	`logDebug
("·rsšg faed, bufSizi %lu ", ()*
bufSize
);

607 *
pÜt
 = 
	`Áohs
(
tıT¿ns
->
tıPÜt
);

608 *
Œª¥ÜtU£
 = 
tıT¿ns
->transportUse;

609 *
´ÙocŞ
 = 
IPPROTO_TCP
;

610 *
addrCÁ
 = 1;

612 
	`memıy
(
addrs
, &
addr
, (
Add»ss
));

615 
PARAM_UDP_TRANSPORT
:

616 
	`logDebug
("parsing udpransport…arameter");

617 ià(
	`checkTLV
(
off£t
, *
bufSize
è=ğ
PARAM_UDP_TRANSPORT
) {

618 
udpT¿ns
 = (
·¿mUdpT¿n¥Üt
 *è
off£t
;

619 
off£t
 +ğ(
·¿mUdpT¿n¥Üt
);

620 
bufSize
 -ğ(
·¿mUdpT¿n¥Üt
);

622 ià((
·¿mTy³
 = 
	`checkTLV
(
off£t
, *
bufSize
)) != 0) {

623 ià(
·¿mTy³
 =ğ
PARAM_IPV4_ADDR
) {

624 
v4Addr
 = (
·¿mIpv4Addr
 *è
off£t
;

625 
off£t
 +ğ(
·¿mIpv4Addr
);

626 
bufSize
 -ğ(
·¿mIpv4Addr
);

627 
addr
[0].
ty³
 = 
AF_INET
;

628 
addr
[0].addr.
š4
 = 
v4Addr
->addr;

629 } ià(
·¿mTy³
 =ğ
PARAM_IPV6_ADDR
) {

630 
v6Addr
 = (
·¿mIpv6Addr
 *è
off£t
;

631 
off£t
 +ğ(
·¿mIpv6Addr
);

632 
bufSize
 -ğ(
·¿mIpv6Addr
);

633 
addr
[0].
ty³
 = 
AF_INET6
;

634 
addr
[0].addr.
š6
 = 
v6Addr
->addr;

638 
	`logDebug
("no…roper udpransport…aram found");

642 ià(*
bufSize
 != 0) {

643 
	`logDebug
("·rsšg faed, bufSizi %lu ", ()*
bufSize
);

647 *
addrCÁ
 = 1;

648 *
pÜt
 = 
	`Áohs
(
udpT¿ns
->
udpPÜt
);

649 *
Œª¥ÜtU£
 = 0;

650 *
´ÙocŞ
 = 
IPPROTO_UDP
;

652 
	`memıy
(
addrs
, &
addr
, (
Add»ss
));

656 
	`logDebug
("unknowÀŒª¥Üˆ·¿m‘”: %d ", 
	`Áohs
(
hdr
->
ty³
));

660 
	`logDebug
("end");

661  ()(()
off£t
 - ()
Üigš®Off£t
);

662 
	}
}

664 
ušt16


665 
	$checkTLV
(*
pos
, 
ssize_t
 
bufSize
) {

666 
·¿mH—d”
 *
hdr
;

668 ià(
pos
 =ğ
NULL
)

671 ià(
bufSize
 < (
ssize_t
)(
·¿mH—d”
))

674 
hdr
 = (
·¿mH—d”
 *è
pos
;

676 ià(
	`Áohs
(
hdr
->
Ëngth
è> 
bufSize
)

679  
	`Áohs
(
hdr
->
ty³
);

680 
	}
}

687 
	$add»s£sToSysC®lBufãr
(
Add»ss
 *
addrs
, 
ušt16
 
pÜt
, 
addrCÁ
, *
buf
) {

688 
couÁ
 = 0;

689 
size
 = 0;

690 
i
;

691 *
off£t
;

692 
sockaddr_š
 *
š4
;

693 
sockaddr_š6
 *
š6
;

695 ià(
addrs
 =ğ
NULL
) {

696 
	`logDebug
("addrs is NULL");

700 ià(
addrCÁ
 < 1) {

701 
	`logDebug
("addrCnt is†esshan 1");

705 ià(
buf
 =ğ
NULL
) {

706 
	`logDebug
("buf is NULL");

710 
	`mem£t
(
buf
, 0, 
addrCÁ
 * (
sockaddr_š6
));

712 
off£t
 = 
buf
;

713 
i
 = 0; i < 
addrCÁ
 && i < 
MAX_ADDR_CNT
; i++) {

714 ià(
addrs
[
i
].
ty³
 =ğ
AF_INET
) {

715 
š4
 = (
sockaddr_š
 *è
off£t
;

716 
š4
->
sš_çmy
 = 
AF_INET
;

717 
š4
->
sš_pÜt
 = 
	`htÚs
(
pÜt
);

718 #ifdeà
HAVE_SIN_LEN


719 
š4
->
sš_Ën
 = (
sockaddr_š
);

721 
	`memıy
(&
š4
->
sš_addr
, &
addrs
[
i
].
addr
.š4, (
š_addr
));

722 
	`´štBuf
(
off£t
, 16, "ipv4");

723 
off£t
 +ğ(
sockaddr_š
);

724 
size
 +ğ(
sockaddr_š
);

725 
couÁ
++;

727 } ià(
addrs
[
i
].
ty³
 =ğ
AF_INET6
) {

728 
š6
 = (
sockaddr_š6
 *è
off£t
;

729 
š6
->
sš6_çmy
 = 
AF_INET6
;

730 
š6
->
sš6_pÜt
 = 
	`htÚs
(
pÜt
);

731 #ifdeà
HAVE_SIN6_LEN


732 
š6
->
sš6_Ën
 = (
sockaddr_š6
);

734 
	`memıy
(&
š6
->
sš6_addr
, &
addrs
[
i
].
addr
.š6, (
š6_addr
));

735 
	`´štBuf
(
off£t
, 28, "ipv6");

736 
off£t
 +ğ(
sockaddr_š6
);

737 
size
 +ğ(
sockaddr_š6
);

738 
couÁ
++;

741 
	`logDebug
("unsuµÜ‹d‡dd»s çmy: %d", 
addrs
[
i
].
ty³
);

746 
	`´štBuf
(
buf
, 
size
, "address buffer");

748  
couÁ
;

749 
	}
}

752 
	$sysC®lBufãrToAdd»s£s
(*
buf
, 
size_t
 
bufL’
, 
Add»ss
 *
addrs
) {

753 
addrCÁ
;

754 
i
;

755 
size_t
 
size
;

756 *
off£t
;

757 
sockaddr
 *
š
;

758 
sockaddr_š
 *
š4
;

759 
sockaddr_š6
 *
š6
;

761 ià(
buf
 =ğ
NULL
) {

762 
	`logDebug
("buf is NULL");

766 ià(
addrs
 =ğ
NULL
) {

767 
	`logDebug
("addrs is NULL");

771 ià(
bufL’
 < (
sockaddr_š
)) {

772 
	`logDebug
("buf isoo small");

776 
addrCÁ
 = 0;

777 
size
 = 0;

778 
off£t
 = 
buf
;

779 
i
 = 0; i < 
MAX_ADDR_CNT
; i++) {

780 ià(
size
 + (
sockaddr
è> 
bufL’
)

782 
š
 = (
sockaddr
 *è
off£t
;

783 
š
->
§_çmy
) {

784 
AF_INET
:

785 ià(
size
 + (
sockaddr_š
è> 
bufL’
)

786  
addrCÁ
;

787 
š4
 = (
sockaddr_š
 *è
off£t
;

788 
addrs
[
i
].
ty³
 = 
AF_INET
;

789 
	`memıy
(&
addrs
[
i
].
addr
.
š4
, &š4->
sš_addr
, (
š_addr
));

791 
AF_INET6
:

792 ià(
size
 + (
sockaddr_š6
è> 
bufL’
)

793  
addrCÁ
;

794 
š6
 = (
sockaddr_š6
 *è
off£t
;

795 
addrs
[
i
].
ty³
 = 
AF_INET6
;

796 
	`memıy
(&
addrs
[
i
].
addr
.
š6
, &š6->
sš6_addr
, (
š6_addr
));

799 
	`logDebug
("unknowÀty³: %d", 
š
->
§_çmy
);

800  
addrCÁ
;

804  
addrCÁ
;

805 
	}
}

808 
	$add»ssLi¡Pršt
(
Add»ss
 *
addrs
) {

809 
addrBuf
[
INET6_ADDRSTRLEN
];

810 
i
;

812 ià(
addrs
 =ğ
NULL
) {

813 
	`logDebug
("addrs is NULL\n");

817 
i
 = 0; i < 
MAX_ADDR_CNT
; i++) {

818 ià(
addrs
[
i
].
ty³
 =ğ
AF_INET
)

819 
	`logDebug
("addrs[%d]: AF_INET %s\n", 
i
, 
	`š‘_Áİ
(
AF_INET
, (*è&
addrs
[i].
addr
.
š4
, 
addrBuf
, 
INET6_ADDRSTRLEN
));

820 ià(
addrs
[
i
].
ty³
 =ğ
AF_INET6
)

821 
	`logDebug
("addrs[%d]: AF_INET6 %s\n", 
i
, 
	`š‘_Áİ
(
AF_INET6
, (*è&
addrs
[i].
addr
.
š6
, 
addrBuf
, 
INET6_ADDRSTRLEN
));

824 
	}
}

827 #iâdeà
HAVE_SCTP_SENDX


830 
size_t
 
	$g‘SockËn
(cÚ¡ 
sockaddr
* 
add»ss
)

832 
add»ss
->
§_çmy
) {

833 
AF_INET
:

834 ((
sockaddr_š
));

836 
AF_INET6
:

837 ((
sockaddr_š6
));

840 
	`abÜt
();

843 
	}
}

845 
	#AS_UNSPECIFIED
 0

	)

846 
	#AS_MULTICAST_NODELOCAL
 1

	)

847 
	#AS_LOOPBACK
 2

	)

848 
	#AS_MULTICAST_LINKLOCAL
 3

	)

849 
	#AS_UNICAST_LINKLOCAL
 4

	)

850 
	#AS_MULTICAST_SITELOCAL
 5

	)

851 
	#AS_UNICAST_SITELOCAL
 6

	)

852 
	#AS_MULTICAST_ORGLOCAL
 7

	)

853 
	#AS_MULTICAST_GLOBAL
 8

	)

854 
	#AS_UNICAST_GLOBAL
 10

	)

857 
	$g‘ScİeIPv4
(cÚ¡ 
ušt32_t
* 
add»ss
)

859 
ušt32_t
 
a
;

860 
ušt8_t
 
b1
;

861 
ušt8_t
 
b2
;

864 if(*
add»ss
 == 0x00000000) {

869 
a
 = 
	`Áohl
(*
add»ss
);

870 if((
a
 & 0x7f000000) == 0x7f000000) {

875 
b1
 = (
ušt8_t
)(
a
 >> 24);

876 if(
b1
 == 10) {

877 (
AS_UNICAST_SITELOCAL
);

881 
b2
 = (
ušt8_t
)((
a
 >> 16) & 0x00ff);

882 if((
b1
 =ğ172è&& (
b2
 >= 16) && (b2 <= 31)) {

883 (
AS_UNICAST_SITELOCAL
);

887 if((
b1
 =ğ192è&& (
b2
 == 168)) {

888 (
AS_UNICAST_SITELOCAL
);

891 if(
	`IN_MULTICAST
(
	`Áohl
(*
add»ss
))) {

892 (
AS_MULTICAST_GLOBAL
);

894 (
AS_UNICAST_GLOBAL
);

895 
	}
}

899 
	$g‘ScİeIPv6
(cÚ¡ 
š6_addr
* 
add»ss
)

901 if(
	`IN6_IS_ADDR_V4MAPPED
(
add»ss
)) {

902 #ià
defšed
 
__lšux__


903 (
	`g‘ScİeIPv4
(&
add»ss
->
s6_addr32
[3]));

905 (
	`g‘ScİeIPv4
(&
add»ss
->
__u6_addr
.
__u6_addr32
[3]));

908 if(
	`IN6_IS_ADDR_UNSPECIFIED
(
add»ss
)) {

909 (
AS_UNSPECIFIED
);

911 if(
	`IN6_IS_ADDR_MC_NODELOCAL
(
add»ss
)) {

912 (
AS_MULTICAST_NODELOCAL
);

914 if(
	`IN6_IS_ADDR_LOOPBACK
(
add»ss
)) {

915 (
AS_LOOPBACK
);

917 if(
	`IN6_IS_ADDR_MC_LINKLOCAL
(
add»ss
)) {

918 (
AS_MULTICAST_LINKLOCAL
);

920 if(
	`IN6_IS_ADDR_LINKLOCAL
(
add»ss
)) {

921 (
AS_UNICAST_LINKLOCAL
);

923 if(
	`IN6_IS_ADDR_MC_SITELOCAL
(
add»ss
)) {

924 (
AS_MULTICAST_SITELOCAL
);

926 if(
	`IN6_IS_ADDR_SITELOCAL
(
add»ss
)) {

927 (
AS_UNICAST_SITELOCAL
);

929 if(
	`IN6_IS_ADDR_MC_ORGLOCAL
(
add»ss
)) {

930 (
AS_MULTICAST_ORGLOCAL
);

932 if(
	`IN6_IS_ADDR_MC_GLOBAL
(
add»ss
)) {

933 (
AS_MULTICAST_GLOBAL
);

935 (
AS_UNICAST_GLOBAL
);

936 
	}
}

940 
	$g‘Scİe
(
sockaddr
* 
add»ss
)

942 if(
add»ss
->
§_çmy
 =ğ
AF_INET
) {

943 (
	`g‘ScİeIPv4
((
ušt32_t
*)&((
sockaddr_š
*)
add»ss
)->
sš_addr
));

945 if(
add»ss
->
§_çmy
 =ğ
AF_INET6
) {

946 (
	`g‘ScİeIPv6
(&((
sockaddr_š6
*)
add»ss
)->
sš6_addr
));

949 
	`abÜt
();

952 
	}
}

955 
sockaddr
* 
	$g‘Be¡ScİedAdd»ss
(
sockaddr
* 
addrs
,

956 
addrút
)

958 
sockaddr
* 
be¡ScİedAdd»ss
 = 
addrs
;

959 
be¡Scİe
 = 
	`g‘Scİe
(
addrs
);

960 
ÃwScİe
;

961 
sockaddr
* 
a
;

962 
i
;

964 
a
 = 
addrs
;

965 
i
 = 1; i < 
addrút
; i++) {

966 
a
 = (
sockaddr
*)((ï + ()
	`g‘SockËn
(a));

967 
ÃwScİe
 = 
	`g‘Scİe
(
a
);

968 ià(
ÃwScİe
 > 
be¡Scİe
) {

969 
be¡ScİedAdd»ss
 = 
a
;

970 
be¡Scİe
 = 
ÃwScİe
;

974  
be¡ScİedAdd»ss
;

975 
	}
}

977 
ssize_t
 
	$sùp_£ndx
(
sd
,

978 cÚ¡ * 
d©a
,

979 
size_t
 
Ën
,

980 
sockaddr
* 
addrs
,

981 
addrút
,

982 
sùp_¢drcvšfo
* 
sšfo
,

983 
æags
)

985 
sùp_¢drcvšfo
* 
¤i
;

986 
iovec
 
iov
[1];

987 
cmsghdr
* 
cmsg
;

988 
cbuf
[
	`CMSG_SPACE
((
sùp_¢drcvšfo
))];

989 
msghdr
 
msg
;

990 
sockaddr
* 
be¡ScİedAdd»ss
;

992 
iov
[0].
iov_ba£
 = (*)
d©a
;

993 
iov
[0].
iov_Ën
 = 
Ën
;

995 
be¡ScİedAdd»ss
 = 
	`g‘Be¡ScİedAdd»ss
(
addrs
, 
addrút
);

996 
msg
.
msg_Çme
 = (
sockaddr
*)
be¡ScİedAdd»ss
;

997 
msg
.
msg_Çm–’
 = 
	`g‘SockËn
(
be¡ScİedAdd»ss
);

998 
msg
.
msg_iov
 = 
iov
;

999 
msg
.
msg_iovËn
 = 1;

1000 
msg
.
msg_cÚŒŞ
 = (*)
cbuf
;

1002 
cmsg
 = (
cmsghdr
*)
cbuf
;

1003 
cmsg
->
cmsg_Ën
 = 
	`CMSG_LEN
((
sùp_¢drcvšfo
));

1004 
cmsg
->
cmsg_Ëv–
 = 
IPPROTO_SCTP
;

1005 
cmsg
->
cmsg_ty³
 = 
SCTP_SNDRCV
;

1007 
¤i
 = (
sùp_¢drcvšfo
*)
	`CMSG_DATA
(
cmsg
);

1008 
	`memıy
(
¤i
, 
sšfo
, (
sùp_¢drcvšfo
));

1010 (
	`£ndmsg
(
sd
, &
msg
, 
æags
));

1011 
	}
}

	@util.h

37 #iâdeà
_UTIL_H


38 
	#_UTIL_H
 1

	)

40 
	~"back’d.h
"

41 
	~"poŞ–em’t.h
"

43 
	#ADD_PADDING
(
x
è((((xè+ 3è>> 2è<< 2)

	)

45 
ušt8


46 
checkAndId’tifyMsg
(*
msg
, 
size_t
 
Ën
, 
sùp_assoc_t
 
assocId
);

48 
ušt16


49 
checkTLV
(*
pos
, 
ssize_t
 
bufL’gth
);

52 
Œª¥ÜtAdd»s£sToS’dBufãr
(*
off£t
, 
Add»ss
 *
addrs
,

53 
ušt16
 
pÜt
, ušt16 
Œª¥ÜtU£
,

54 
ušt8
 
´ÙocŞ
);

56 
£ndBufãrToT¿n¥ÜtAdd»s£s
(*
off£t
, 
size_t
 *
bufSize
,

57 
Add»ss
 *
addrs
, *
addrCÁ
,

58 
ušt16
 *
pÜt
, ušt16 *
Œª¥ÜtU£
,

59 
ušt8
 *
´ÙocŞ
);

62 
poŞEËm’tToS’dBufãr
(
PoŞEËm’t
 
³
, *
off£t
);

64 
PoŞEËm’t


65 
£ndBufãrToPoŞEËm’t
(*
off£t
, 
size_t
 *
bufSize
);

68 
add»s£sToSysC®lBufãr
(
Add»ss
 *
addrs
, 
ušt16
 
pÜt
, 
addrCÁ
, *
buf
);

71 
add»ssLi¡Pršt
(
Add»ss
 *
addrs
);

74 #iâdeà
HAVE_SCTP_SENDX


75 
ssize_t
 
sùp_£ndx
(
sd
,

76 cÚ¡ * 
d©a
,

77 
size_t
 
Ën
,

78 
sockaddr
* 
addrs
,

79 
addrút
,

80 
sùp_¢drcvšfo
* 
sšfo
,

81 
æags
);

	@/usr/include/arpa/inet.h

62 #iâdeà
_ARPA_INET_H_


63 
	#_ARPA_INET_H_


	)

67 
	~<sys/cdefs.h
>

68 
	~<sys/_ty³s.h
>

71 
	~<machše/’dŸn.h
>

73 
	#INET_ADDRSTRLEN
 16

	)

74 
	#INET6_ADDRSTRLEN
 46

	)

76 #iâdeà
_UINT16_T_DECLARED


77 
__ušt16_t
 
	tušt16_t
;

78 
	#_UINT16_T_DECLARED


	)

81 #iâdeà
_UINT32_T_DECLARED


82 
__ušt32_t
 
	tušt32_t
;

83 
	#_UINT32_T_DECLARED


	)

86 #iâdeà
_IN_ADDR_T_DECLARED


87 
ušt32_t
 
	tš_addr_t
;

88 
	#_IN_ADDR_T_DECLARED


	)

91 #iâdeà
_IN_PORT_T_DECLARED


92 
ušt16_t
 
	tš_pÜt_t
;

93 
	#_IN_PORT_T_DECLARED


	)

96 #ià
__BSD_VISIBLE


97 #iâdeà
_SIZE_T_DECLARED


98 
__size_t
 
	tsize_t
;

99 
	#_SIZE_T_DECLARED


	)

107 #iâdeà
_SOCKLEN_T_DECLARED


108 
__sockËn_t
 
	tsockËn_t
;

109 
	#_SOCKLEN_T_DECLARED


	)

112 #iâdeà
_STRUCT_IN_ADDR_DECLARED


113 
	sš_addr
 {

114 
š_addr_t
 
	ms_addr
;

116 
	#_STRUCT_IN_ADDR_DECLARED


	)

120 #ià
__BSD_VISIBLE


121 
	#š‘_addr
 
__š‘_addr


	)

122 
	#š‘_©Ú
 
__š‘_©Ú


	)

123 
	#š‘_Êaof
 
__š‘_Êaof


	)

124 
	#š‘_mak—ddr
 
__š‘_mak—ddr


	)

125 
	#š‘_Ã
 
__š‘_Ã


	)

126 
	#š‘_Ãtof
 
__š‘_Ãtof


	)

127 
	#š‘_ÃtwÜk
 
__š‘_ÃtwÜk


	)

128 
	#š‘_Ãt_Áİ
 
__š‘_Ãt_Áİ


	)

129 
	#š‘_Ãt_±Ú
 
__š‘_Ãt_±Ú


	)

130 
	#š‘_cidr_Áİ
 
__š‘_cidr_Áİ


	)

131 
	#š‘_cidr_±Ú
 
__š‘_cidr_±Ú


	)

132 
	#š‘_Áß
 
__š‘_Áß


	)

133 
	#š‘_Áß_r
 
__š‘_Áß_r


	)

134 
	#š‘_±Ú
 
__š‘_±Ú


	)

135 
	#š‘_Áİ
 
__š‘_Áİ


	)

136 
	#š‘_n§p_addr
 
__š‘_n§p_addr


	)

137 
	#š‘_n§p_Áß
 
__š‘_n§p_Áß


	)

140 
	g__BEGIN_DECLS


141 #iâdeà
_BYTEORDER_PROTOTYPED


142 
	#_BYTEORDER_PROTOTYPED


	)

143 
ušt32_t
 
htÚl
(uint32_t);

144 
ušt16_t
 
htÚs
(uint16_t);

145 
ušt32_t
 
Áohl
(uint32_t);

146 
ušt16_t
 
Áohs
(uint16_t);

149 
š_addr_t
 
š‘_addr
(const *);

150  *
š‘_Áß
(
š_addr
);

151 *
š‘_Áß_r
(
š_addr
, *
buf
, 
sockËn_t
 
size
);

152 cÚ¡ *
š‘_Áİ
(, cÚ¡ * 
__»¡riù
, * __restrict,

153 
sockËn_t
);

154 
š‘_±Ú
(, cÚ¡ * 
__»¡riù
, * __restrict);

156 #ià
__BSD_VISIBLE


157 
š‘_©Ú
(cÚ¡ *, 
š_addr
 *);

158 
š_addr_t
 
š‘_Êaof
(
š_addr
);

159 
š_addr
 
š‘_mak—ddr
(
š_addr_t
, in_addr_t);

160 * 
š‘_Ã
(
š_addr_t
, *, 
size_t
);

161 
š_addr_t
 
š‘_Ãtof
(
š_addr
);

162 
š_addr_t
 
š‘_ÃtwÜk
(const *);

163 *
š‘_Ãt_Áİ
(, cÚ¡ *, , *, 
size_t
);

164 
š‘_Ãt_±Ú
(, cÚ¡ *, *, 
size_t
);

165 *
š‘_cidr_Áİ
(, cÚ¡ *, , *, 
size_t
);

166 
š‘_cidr_±Ú
(, const *, *, *);

167 
š‘_n§p_addr
(const *, *, );

168 *
š‘_n§p_Áß
(, const *, *);

170 
	g__END_DECLS


172 #iâdeà
_BYTEORDER_FUNC_DEFINED


173 
	#_BYTEORDER_FUNC_DEFINED


	)

174 
	#htÚl
(
x
è
	`__htÚl
(x)

	)

175 
	#htÚs
(
x
è
	`__htÚs
(x)

	)

176 
	#Áohl
(
x
è
	`__Áohl
(x)

	)

177 
	#Áohs
(
x
è
	`__Áohs
(x)

	)

	@/usr/include/assert.h

42 
	~<sys/cdefs.h
>

49 #undeà
as£¹


50 #undeà
_as£¹


52 #ifdeà
NDEBUG


53 
	#as£¹
(
e
è(()0)

	)

54 
	#_as£¹
(
e
è(()0)

	)

56 
	#_as£¹
(
e
è
	`as£¹
Ó)

	)

58 
	#as£¹
(
e
è(Óè? ()0 : 
	`__as£¹
(
__func__
, 
__FILE__
, \

59 
__LINE__
, #e))

	)

62 
__BEGIN_DECLS


63 
__as£¹
(const *, const *, , const *);

64 
	g__END_DECLS


	@/usr/include/netinet/in.h

33 #iâdeà
_NETINET_IN_H_


34 
	#_NETINET_IN_H_


	)

36 
	~<sys/cdefs.h
>

37 
	~<sys/_ty³s.h
>

38 
	~<machše/’dŸn.h
>

41 
	#IPPROTO_IP
 0

	)

42 
	#IPPROTO_ICMP
 1

	)

43 
	#IPPROTO_TCP
 6

	)

44 
	#IPPROTO_UDP
 17

	)

46 
	#INADDR_ANY
 (
u_št32_t
)0x00000000

	)

47 
	#INADDR_BROADCAST
 (
u_št32_t
)0xfffffffà

	)

49 #iâdeà
_UINT8_T_DECLARED


50 
__ušt8_t
 
	tušt8_t
;

51 
	#_UINT8_T_DECLARED


	)

54 #iâdeà
_UINT16_T_DECLARED


55 
__ušt16_t
 
	tušt16_t
;

56 
	#_UINT16_T_DECLARED


	)

59 #iâdeà
_UINT32_T_DECLARED


60 
__ušt32_t
 
	tušt32_t
;

61 
	#_UINT32_T_DECLARED


	)

64 #iâdeà
_IN_ADDR_T_DECLARED


65 
ušt32_t
 
	tš_addr_t
;

66 
	#_IN_ADDR_T_DECLARED


	)

69 #iâdeà
_IN_PORT_T_DECLARED


70 
ušt16_t
 
	tš_pÜt_t
;

71 
	#_IN_PORT_T_DECLARED


	)

74 #iâdeà
_SA_FAMILY_T_DECLARED


75 
__§_çmy_t
 
	t§_çmy_t
;

76 
	#_SA_FAMILY_T_DECLARED


	)

80 #iâdef 
_STRUCT_IN_ADDR_DECLARED


81 
	sš_addr
 {

82 
š_addr_t
 
	ms_addr
;

84 
	#_STRUCT_IN_ADDR_DECLARED


	)

87 #iâdef 
_SOCKLEN_T_DECLARED


88 
__sockËn_t
 
	tsockËn_t
;

89 
	#_SOCKLEN_T_DECLARED


	)

93 #iâdef 
_STRUCT_SOCKADDR_STORAGE_DECLARED


97 
	#_SS_MAXSIZE
 128U

	)

98 
	#_SS_ALIGNSIZE
 ((
__št64_t
))

	)

99 
	#_SS_PAD1SIZE
 (
_SS_ALIGNSIZE
 - () - \

100 (
§_çmy_t
))

	)

101 
	#_SS_PAD2SIZE
 (
_SS_MAXSIZE
 - () - \

102 (
§_çmy_t
è- 
_SS_PAD1SIZE
 - 
_SS_ALIGNSIZE
)

	)

104 
	ssockaddr_¡Üage
 {

105 
	mss_Ën
;

106 
§_çmy_t
 
	mss_çmy
;

107 
	m__ss_·d1
[
_SS_PAD1SIZE
];

108 
__št64_t
 
	m__ss_®ign
;

109 
	m__ss_·d2
[
_SS_PAD2SIZE
];

111 
	#_STRUCT_SOCKADDR_STORAGE_DECLARED


	)

115 
	ssockaddr_š
 {

116 
ušt8_t
 
	msš_Ën
;

117 
§_çmy_t
 
	msš_çmy
;

118 
š_pÜt_t
 
	msš_pÜt
;

119 
š_addr
 
	msš_addr
;

120 
	msš_z”o
[8];

123 #iâdeà
_KERNEL


125 #iâdeà
_BYTEORDER_PROTOTYPED


126 
	#_BYTEORDER_PROTOTYPED


	)

127 
__BEGIN_DECLS


128 
ušt32_t
 
htÚl
(uint32_t);

129 
ušt16_t
 
htÚs
(uint16_t);

130 
ušt32_t
 
Áohl
(uint32_t);

131 
ušt16_t
 
Áohs
(uint16_t);

132 
	g__END_DECLS


135 #iâdeà
_BYTEORDER_FUNC_DEFINED


136 
	#_BYTEORDER_FUNC_DEFINED


	)

137 
	#htÚl
(
x
è
	`__htÚl
(x)

	)

138 
	#htÚs
(
x
è
	`__htÚs
(x)

	)

139 
	#Áohl
(
x
è
	`__Áohl
(x)

	)

140 
	#Áohs
(
x
è
	`__Áohs
(x)

	)

145 #ià
__POSIX_VISIBLE
 >= 200112

146 
	#IPPROTO_RAW
 255

	)

147 
	#INET_ADDRSTRLEN
 16

	)

150 #ià
__BSD_VISIBLE


159 
	#IPPROTO_HOPOPTS
 0

	)

160 
	#IPPROTO_IGMP
 2

	)

161 
	#IPPROTO_GGP
 3

	)

162 
	#IPPROTO_IPV4
 4

	)

163 
	#IPPROTO_IPIP
 
IPPROTO_IPV4


	)

164 
	#IPPROTO_ST
 7

	)

165 
	#IPPROTO_EGP
 8

	)

166 
	#IPPROTO_PIGP
 9

	)

167 
	#IPPROTO_RCCMON
 10

	)

168 
	#IPPROTO_NVPII
 11

	)

169 
	#IPPROTO_PUP
 12

	)

170 
	#IPPROTO_ARGUS
 13

	)

171 
	#IPPROTO_EMCON
 14

	)

172 
	#IPPROTO_XNET
 15

	)

173 
	#IPPROTO_CHAOS
 16

	)

174 
	#IPPROTO_MUX
 18

	)

175 
	#IPPROTO_MEAS
 19

	)

176 
	#IPPROTO_HMP
 20

	)

177 
	#IPPROTO_PRM
 21

	)

178 
	#IPPROTO_IDP
 22

	)

179 
	#IPPROTO_TRUNK1
 23

	)

180 
	#IPPROTO_TRUNK2
 24

	)

181 
	#IPPROTO_LEAF1
 25

	)

182 
	#IPPROTO_LEAF2
 26

	)

183 
	#IPPROTO_RDP
 27

	)

184 
	#IPPROTO_IRTP
 28

	)

185 
	#IPPROTO_TP
 29

	)

186 
	#IPPROTO_BLT
 30

	)

187 
	#IPPROTO_NSP
 31

	)

188 
	#IPPROTO_INP
 32

	)

189 
	#IPPROTO_SEP
 33

	)

190 
	#IPPROTO_3PC
 34

	)

191 
	#IPPROTO_IDPR
 35

	)

192 
	#IPPROTO_XTP
 36

	)

193 
	#IPPROTO_DDP
 37

	)

194 
	#IPPROTO_CMTP
 38

	)

195 
	#IPPROTO_TPXX
 39

	)

196 
	#IPPROTO_IL
 40

	)

197 
	#IPPROTO_IPV6
 41

	)

198 
	#IPPROTO_SDRP
 42

	)

199 
	#IPPROTO_ROUTING
 43

	)

200 
	#IPPROTO_FRAGMENT
 44

	)

201 
	#IPPROTO_IDRP
 45

	)

202 
	#IPPROTO_RSVP
 46

	)

203 
	#IPPROTO_GRE
 47

	)

204 
	#IPPROTO_MHRP
 48

	)

205 
	#IPPROTO_BHA
 49

	)

206 
	#IPPROTO_ESP
 50

	)

207 
	#IPPROTO_AH
 51

	)

208 
	#IPPROTO_INLSP
 52

	)

209 
	#IPPROTO_SWIPE
 53

	)

210 
	#IPPROTO_NHRP
 54

	)

211 
	#IPPROTO_MOBILE
 55

	)

212 
	#IPPROTO_TLSP
 56

	)

213 
	#IPPROTO_SKIP
 57

	)

214 
	#IPPROTO_ICMPV6
 58

	)

215 
	#IPPROTO_NONE
 59

	)

216 
	#IPPROTO_DSTOPTS
 60

	)

217 
	#IPPROTO_AHIP
 61

	)

218 
	#IPPROTO_CFTP
 62

	)

219 
	#IPPROTO_HELLO
 63

	)

220 
	#IPPROTO_SATEXPAK
 64

	)

221 
	#IPPROTO_KRYPTOLAN
 65

	)

222 
	#IPPROTO_RVD
 66

	)

223 
	#IPPROTO_IPPC
 67

	)

224 
	#IPPROTO_ADFS
 68

	)

225 
	#IPPROTO_SATMON
 69

	)

226 
	#IPPROTO_VISA
 70

	)

227 
	#IPPROTO_IPCV
 71

	)

228 
	#IPPROTO_CPNX
 72

	)

229 
	#IPPROTO_CPHB
 73

	)

230 
	#IPPROTO_WSN
 74

	)

231 
	#IPPROTO_PVP
 75

	)

232 
	#IPPROTO_BRSATMON
 76

	)

233 
	#IPPROTO_ND
 77

	)

234 
	#IPPROTO_WBMON
 78

	)

235 
	#IPPROTO_WBEXPAK
 79

	)

236 
	#IPPROTO_EON
 80

	)

237 
	#IPPROTO_VMTP
 81

	)

238 
	#IPPROTO_SVMTP
 82

	)

239 
	#IPPROTO_VINES
 83

	)

240 
	#IPPROTO_TTP
 84

	)

241 
	#IPPROTO_IGP
 85

	)

242 
	#IPPROTO_DGP
 86

	)

243 
	#IPPROTO_TCF
 87

	)

244 
	#IPPROTO_IGRP
 88

	)

245 
	#IPPROTO_OSPFIGP
 89

	)

246 
	#IPPROTO_SRPC
 90

	)

247 
	#IPPROTO_LARP
 91

	)

248 
	#IPPROTO_MTP
 92

	)

249 
	#IPPROTO_AX25
 93

	)

250 
	#IPPROTO_IPEIP
 94

	)

251 
	#IPPROTO_MICP
 95

	)

252 
	#IPPROTO_SCCSP
 96

	)

253 
	#IPPROTO_ETHERIP
 97

	)

254 
	#IPPROTO_ENCAP
 98

	)

255 
	#IPPROTO_APES
 99

	)

256 
	#IPPROTO_GMTP
 100

	)

257 
	#IPPROTO_IPCOMP
 108

	)

258 
	#IPPROTO_SCTP
 132

	)

260 
	#IPPROTO_PIM
 103

	)

261 
	#IPPROTO_CARP
 112

	)

262 
	#IPPROTO_PGM
 113

	)

263 
	#IPPROTO_PFSYNC
 240

	)

266 
	#IPPROTO_OLD_DIVERT
 254

	)

267 
	#IPPROTO_MAX
 256

	)

270 
	#IPPROTO_DONE
 257

	)

273 
	#IPPROTO_DIVERT
 258

	)

279 
	#IPPROTO_SPACER
 32767

	)

331 
	#IPPORT_RESERVED
 1024

	)

337 
	#IPPORT_HIFIRSTAUTO
 49152

	)

338 
	#IPPORT_HILASTAUTO
 65535

	)

346 
	#IPPORT_RESERVEDSTART
 600

	)

348 
	#IPPORT_MAX
 65535

	)

355 
	#IN_CLASSA
(
i
è(((
u_št32_t
)(iè& 0x80000000è=ğ0)

	)

356 
	#IN_CLASSA_NET
 0xff000000

	)

357 
	#IN_CLASSA_NSHIFT
 24

	)

358 
	#IN_CLASSA_HOST
 0x00ffffff

	)

359 
	#IN_CLASSA_MAX
 128

	)

361 
	#IN_CLASSB
(
i
è(((
u_št32_t
)(iè& 0xc0000000è=ğ0x80000000)

	)

362 
	#IN_CLASSB_NET
 0xffff0000

	)

363 
	#IN_CLASSB_NSHIFT
 16

	)

364 
	#IN_CLASSB_HOST
 0x0000ffff

	)

365 
	#IN_CLASSB_MAX
 65536

	)

367 
	#IN_CLASSC
(
i
è(((
u_št32_t
)(iè& 0xe0000000è=ğ0xc0000000)

	)

368 
	#IN_CLASSC_NET
 0xffffff00

	)

369 
	#IN_CLASSC_NSHIFT
 8

	)

370 
	#IN_CLASSC_HOST
 0x000000ff

	)

372 
	#IN_CLASSD
(
i
è(((
u_št32_t
)(iè& 0xf0000000è=ğ0xe0000000)

	)

373 
	#IN_CLASSD_NET
 0xf0000000

	)

374 
	#IN_CLASSD_NSHIFT
 28

	)

375 
	#IN_CLASSD_HOST
 0x0ffffffà

	)

376 
	#IN_MULTICAST
(
i
è
	`IN_CLASSD
(i)

	)

378 
	#IN_EXPERIMENTAL
(
i
è(((
u_št32_t
)(iè& 0xf0000000è=ğ0xf0000000)

	)

379 
	#IN_BADCLASS
(
i
è(((
u_št32_t
)(iè& 0xf0000000è=ğ0xf0000000)

	)

381 
	#IN_LINKLOCAL
(
i
è(((
u_št32_t
)(iè& 0xffff0000è=ğ0xa9ã0000)

	)

383 
	#IN_PRIVATE
(
i
è((((
u_št32_t
)(i) & 0xff000000) == 0x0a000000) || \

384 (((
u_št32_t
)(
i
) & 0xfff00000) == 0xac100000) || \

385 (((
u_št32_t
)(
i
è& 0xffff0000è=ğ0xc0a80000))

	)

387 
	#IN_LOCAL_GROUP
(
i
è(((
u_št32_t
)(iè& 0xffffff00è=ğ0xe0000000)

	)

389 
	#IN_ANY_LOCAL
(
i
è(
	`IN_LINKLOCAL
(iè|| 
	`IN_LOCAL_GROUP
(i))

	)

391 
	#INADDR_LOOPBACK
 (
u_št32_t
)0x7f000001

	)

392 #iâdeà
_KERNEL


393 
	#INADDR_NONE
 0xfffffffà

	)

396 
	#INADDR_UNSPEC_GROUP
 (
u_št32_t
)0xe0000000

	)

397 
	#INADDR_ALLHOSTS_GROUP
 (
u_št32_t
)0xe0000001

	)

398 
	#INADDR_ALLRTRS_GROUP
 (
u_št32_t
)0xe0000002

	)

399 
	#INADDR_ALLRPTS_GROUP
 (
u_št32_t
)0xe0000016

	)

400 
	#INADDR_CARP_GROUP
 (
u_št32_t
)0xe0000012

	)

401 
	#INADDR_PFSYNC_GROUP
 (
u_št32_t
)0xe00000f0

	)

402 
	#INADDR_ALLMDNS_GROUP
 (
u_št32_t
)0xe00000fb

	)

403 
	#INADDR_MAX_LOCAL_GROUP
 (
u_št32_t
)0xe00000fà

	)

405 
	#IN_LOOPBACKNET
 127

	)

411 
	#IP_OPTIONS
 1

	)

412 
	#IP_HDRINCL
 2

	)

413 
	#IP_TOS
 3

	)

414 
	#IP_TTL
 4

	)

415 
	#IP_RECVOPTS
 5

	)

416 
	#IP_RECVRETOPTS
 6

	)

417 
	#IP_RECVDSTADDR
 7

	)

418 
	#IP_SENDSRCADDR
 
IP_RECVDSTADDR


	)

419 
	#IP_RETOPTS
 8

	)

420 
	#IP_MULTICAST_IF
 9

	)

422 
	#IP_MULTICAST_TTL
 10

	)

423 
	#IP_MULTICAST_LOOP
 11

	)

424 
	#IP_ADD_MEMBERSHIP
 12

	)

425 
	#IP_DROP_MEMBERSHIP
 13

	)

426 
	#IP_MULTICAST_VIF
 14

	)

427 
	#IP_RSVP_ON
 15

	)

428 
	#IP_RSVP_OFF
 16

	)

429 
	#IP_RSVP_VIF_ON
 17

	)

430 
	#IP_RSVP_VIF_OFF
 18

	)

431 
	#IP_PORTRANGE
 19

	)

432 
	#IP_RECVIF
 20

	)

434 
	#IP_IPSEC_POLICY
 21

	)

435 
	#IP_FAITH
 22

	)

437 
	#IP_ONESBCAST
 23

	)

439 
	#IP_FW_TABLE_ADD
 40

	)

440 
	#IP_FW_TABLE_DEL
 41

	)

441 
	#IP_FW_TABLE_FLUSH
 42

	)

442 
	#IP_FW_TABLE_GETSIZE
 43

	)

443 
	#IP_FW_TABLE_LIST
 44

	)

445 
	#IP_FW_ADD
 50

	)

446 
	#IP_FW_DEL
 51

	)

447 
	#IP_FW_FLUSH
 52

	)

448 
	#IP_FW_ZERO
 53

	)

449 
	#IP_FW_GET
 54

	)

450 
	#IP_FW_RESETLOG
 55

	)

452 
	#IP_FW_NAT_CFG
 56

	)

453 
	#IP_FW_NAT_DEL
 57

	)

454 
	#IP_FW_NAT_GET_CONFIG
 58

	)

455 
	#IP_FW_NAT_GET_LOG
 59

	)

457 
	#IP_DUMMYNET_CONFIGURE
 60

	)

458 
	#IP_DUMMYNET_DEL
 61

	)

459 
	#IP_DUMMYNET_FLUSH
 62

	)

460 
	#IP_DUMMYNET_GET
 64

	)

462 
	#IP_RECVTTL
 65

	)

463 
	#IP_MINTTL
 66

	)

464 
	#IP_DONTFRAG
 67

	)

467 
	#IP_ADD_SOURCE_MEMBERSHIP
 70

	)

468 
	#IP_DROP_SOURCE_MEMBERSHIP
 71

	)

469 
	#IP_BLOCK_SOURCE
 72

	)

470 
	#IP_UNBLOCK_SOURCE
 73

	)

473 
	#IP_MSFILTER
 74

	)

476 
	#MCAST_JOIN_GROUP
 80

	)

477 
	#MCAST_LEAVE_GROUP
 81

	)

478 
	#MCAST_JOIN_SOURCE_GROUP
 82

	)

479 
	#MCAST_LEAVE_SOURCE_GROUP
 83

	)

480 
	#MCAST_BLOCK_SOURCE
 84

	)

481 
	#MCAST_UNBLOCK_SOURCE
 85

	)

486 
	#IP_DEFAULT_MULTICAST_TTL
 1

	)

487 
	#IP_DEFAULT_MULTICAST_LOOP
 1

	)

494 
	#IP_MIN_MEMBERSHIPS
 31

	)

495 
	#IP_MAX_MEMBERSHIPS
 4095

	)

496 
	#IP_MAX_SOURCE_FILTER
 1024

	)

501 
	s_m»q
 {

502 
š_addr
 
	mimr_muÉŸddr
;

503 
š_addr
 
	mimr_š‹rçû
;

511 
	s_m»qn
 {

512 
š_addr
 
	mimr_muÉŸddr
;

513 
š_addr
 
	mimr_add»ss
;

514 
	mimr_ifšdex
;

520 
	s_m»q_sourû
 {

521 
š_addr
 
	mimr_muÉŸddr
;

522 
š_addr
 
	mimr_sourûaddr
;

523 
š_addr
 
	mimr_š‹rçû
;

530 
	sgroup_»q
 {

531 
ušt32_t
 
	mgr_š‹rçû
;

532 
sockaddr_¡Üage
 
	mgr_group
;

535 
	sgroup_sourû_»q
 {

536 
ušt32_t
 
	mg¤_š‹rçû
;

537 
sockaddr_¡Üage
 
	mg¤_group
;

538 
sockaddr_¡Üage
 
	mg¤_sourû
;

541 #iâdeà
__MSFILTERREQ_DEFINED


542 
	#__MSFILTERREQ_DEFINED


	)

548 
	s__msf‹¼eq
 {

549 
ušt32_t
 
	mmsä_ifšdex
;

550 
ušt32_t
 
	mmsä_fmode
;

551 
ušt32_t
 
	mmsä_n¤cs
;

552 
sockaddr_¡Üage
 
	mmsä_group
;

553 
sockaddr_¡Üage
 *
	mmsä_¤cs
;

560 
	gsockaddr
;

567 
£tv4sourûf‹r
(, 
š_addr
, š_addr, 
ušt32_t
,

568 
ušt32_t
, 
š_addr
 *);

569 
g‘v4sourûf‹r
(, 
š_addr
, š_addr, 
ušt32_t
 *,

570 
ušt32_t
 *, 
š_addr
 *);

571 
£tsourûf‹r
(, 
ušt32_t
, 
sockaddr
 *, 
sockËn_t
,

572 
ušt32_t
, ušt32_t, 
sockaddr_¡Üage
 *);

573 
g‘sourûf‹r
(, 
ušt32_t
, 
sockaddr
 *, 
sockËn_t
,

574 
ušt32_t
 *, ušt32_ˆ*, 
sockaddr_¡Üage
 *);

579 
	#MCAST_INCLUDE
 1

	)

580 
	#MCAST_EXCLUDE
 2

	)

586 
	#IP_PORTRANGE_DEFAULT
 0

	)

587 
	#IP_PORTRANGE_HIGH
 1

	)

588 
	#IP_PORTRANGE_LOW
 2

	)

596 
	#IPPROTO_MAXID
 (
IPPROTO_AH
 + 1è

	)

598 
	#CTL_IPPROTO_NAMES
 { \

599 { "", 
CTLTYPE_NODE
 }, \

600 { "icmp", 
CTLTYPE_NODE
 }, \

601 { "igmp", 
CTLTYPE_NODE
 }, \

602 { "ggp", 
CTLTYPE_NODE
 }, \

605 { "tı", 
CTLTYPE_NODE
 }, \

607 { "egp", 
CTLTYPE_NODE
 }, \

611 { "pup", 
CTLTYPE_NODE
 }, \

616 { "udp", 
CTLTYPE_NODE
 }, \

621 { "idp", 
CTLTYPE_NODE
 }, \

650 { "£c", 
CTLTYPE_NODE
 }, \

666 { "pim", 
CTLTYPE_NODE
 }, \

667 }

	)

672 
	#IPCTL_FORWARDING
 1

	)

673 
	#IPCTL_SENDREDIRECTS
 2

	)

674 
	#IPCTL_DEFTTL
 3

	)

675 #ifdeà
nÙy‘


676 
	#IPCTL_DEFMTU
 4

	)

678 
	#IPCTL_RTEXPIRE
 5

	)

679 
	#IPCTL_RTMINEXPIRE
 6

	)

680 
	#IPCTL_RTMAXCACHE
 7

	)

681 
	#IPCTL_SOURCEROUTE
 8

	)

682 
	#IPCTL_DIRECTEDBROADCAST
 9

	)

683 
	#IPCTL_INTRQMAXLEN
 10

	)

684 
	#IPCTL_INTRQDROPS
 11

	)

685 
	#IPCTL_STATS
 12

	)

686 
	#IPCTL_ACCEPTSOURCEROUTE
 13

	)

687 
	#IPCTL_FASTFORWARDING
 14

	)

688 
	#IPCTL_KEEPFAITH
 15

	)

689 
	#IPCTL_GIF_TTL
 16

	)

690 
	#IPCTL_MAXID
 17

	)

692 
	#IPCTL_NAMES
 { \

694 { "fÜw¬dšg", 
CTLTYPE_INT
 }, \

695 { "»dœeù", 
CTLTYPE_INT
 }, \

696 { "‰l", 
CTLTYPE_INT
 }, \

697 { "mtu", 
CTLTYPE_INT
 }, \

698 { "¹expœe", 
CTLTYPE_INT
 }, \

699 { "¹mšexpœe", 
CTLTYPE_INT
 }, \

700 { "¹maxÿche", 
CTLTYPE_INT
 }, \

701 { "sourûrou‹", 
CTLTYPE_INT
 }, \

702 { "dœeùed-brßdÿ¡", 
CTLTYPE_INT
 }, \

703 { "šŒ-queue-maxËn", 
CTLTYPE_INT
 }, \

704 { "šŒ-queue-drİs", 
CTLTYPE_INT
 }, \

705 { "¡©s", 
CTLTYPE_STRUCT
 }, \

706 { "acû±_sourûrou‹", 
CTLTYPE_INT
 }, \

707 { "ç¡fÜw¬dšg", 
CTLTYPE_INT
 }, \

708 }

	)

712 #ifdeà
_KERNEL


714 
	giâ‘
; 
	gmbuf
;

716 
š_brßdÿ¡
(
š_addr
, 
iâ‘
 *);

717 
š_ÿnfÜw¬d
(
š_addr
);

718 
š_loÿÏddr
(
š_addr
);

719 
š_loÿl
(
š_addr
);

720 *
š‘_Áß
(
š_addr
);

721 *
š‘_Áß_r
(
š_addr
 
ša
, *
buf
);

722 
š_ifd‘ach
(
iâ‘
 *);

724 
	#š_ho¡eq
(
s
, 
t
è((s).
s_addr
 =ğÑ).s_addr)

	)

725 
	#š_nuÎho¡
(
x
è((x).
s_addr
 =ğ
INADDR_ANY
)

	)

727 
	#§tosš
(
§
è((
sockaddr_š
 *)(§))

	)

728 
	#sšto§
(
sš
è((
sockaddr
 *)(sš))

	)

729 
	#içtoŸ
(
iç
è((
š_içddr
 *)(iç))

	)

734 #ià
__POSIX_VISIBLE
 >= 200112

735 
	#__KAME_NETINET_IN_H_INCLUDED_


	)

736 
	~<Ãtš‘6/š6.h
>

737 #undeà
__KAME_NETINET_IN_H_INCLUDED_


	@/usr/include/netinet/sctp.h

32 
	~<sys/cdefs.h
>

33 
__FBSDID
("$FreeBSD: src/sys/netinet/sctp.h,v 1.21 2007/09/15 19:07:42„rs Exp $");

35 #iâdeà
_NETINET_SCTP_H_


36 
	#_NETINET_SCTP_H_


	)

38 
	~<sys/ty³s.h
>

43 
	ssùphdr
 {

44 
ušt16_t
 
	m¤c_pÜt
;

45 
ušt16_t
 
	mde¡_pÜt
;

46 
ušt32_t
 
	mv_g
;

47 
ušt32_t
 
	mchecksum
;

51 
__©Œibu‹__
((
·cked
));

56 
	ssùp_chunkhdr
 {

57 
ušt8_t
 
	mchunk_ty³
;

58 
ušt8_t
 
	mchunk_æags
;

59 
ušt16_t
 
	mchunk_Ëngth
;

61 } 
__©Œibu‹__
((
·cked
));

66 
	ssùp_·¿mhdr
 {

67 
ušt16_t
 
	m·¿m_ty³
;

68 
ušt16_t
 
	m·¿m_Ëngth
;

69 } 
__©Œibu‹__
((
·cked
));

77 
	#SCTP_RTOINFO
 0x00000001

	)

78 
	#SCTP_ASSOCINFO
 0x00000002

	)

79 
	#SCTP_INITMSG
 0x00000003

	)

80 
	#SCTP_NODELAY
 0x00000004

	)

81 
	#SCTP_AUTOCLOSE
 0x00000005

	)

82 
	#SCTP_SET_PEER_PRIMARY_ADDR
 0x00000006

	)

83 
	#SCTP_PRIMARY_ADDR
 0x00000007

	)

84 
	#SCTP_ADAPTATION_LAYER
 0x00000008

	)

86 
	#SCTP_ADAPTION_LAYER
 0x00000008

	)

87 
	#SCTP_DISABLE_FRAGMENTS
 0x00000009

	)

88 
	#SCTP_PEER_ADDR_PARAMS
 0x0000000a

	)

89 
	#SCTP_DEFAULT_SEND_PARAM
 0x0000000b

	)

91 
	#SCTP_EVENTS
 0x0000000c

	)

93 
	#SCTP_I_WANT_MAPPED_V4_ADDR
 0x0000000d

	)

94 
	#SCTP_MAXSEG
 0x0000000e

	)

95 
	#SCTP_DELAYED_SACK
 0x0000000f

	)

96 
	#SCTP_FRAGMENT_INTERLEAVE
 0x00000010

	)

97 
	#SCTP_PARTIAL_DELIVERY_POINT
 0x00000011

	)

99 
	#SCTP_AUTH_CHUNK
 0x00000012

	)

100 
	#SCTP_AUTH_KEY
 0x00000013

	)

101 
	#SCTP_HMAC_IDENT
 0x00000014

	)

102 
	#SCTP_AUTH_ACTIVE_KEY
 0x00000015

	)

103 
	#SCTP_AUTH_DELETE_KEY
 0x00000016

	)

104 
	#SCTP_USE_EXT_RCVINFO
 0x00000017

	)

105 
	#SCTP_AUTO_ASCONF
 0x00000018

	)

106 
	#SCTP_MAXBURST
 0x00000019

	)

107 
	#SCTP_MAX_BURST
 0x00000019

	)

109 
	#SCTP_CONTEXT
 0x0000001¨

	)

111 
	#SCTP_EXPLICIT_EOR
 0x0000001b

	)

116 
	#SCTP_STATUS
 0x00000100

	)

117 
	#SCTP_GET_PEER_ADDR_INFO
 0x00000101

	)

119 
	#SCTP_PEER_AUTH_CHUNKS
 0x00000102

	)

120 
	#SCTP_LOCAL_AUTH_CHUNKS
 0x00000103

	)

121 
	#SCTP_GET_ASSOC_NUMBER
 0x00000104

	)

122 
	#SCTP_GET_ASSOC_ID_LIST
 0x00000105

	)

146 
	#SCTP_RESET_STREAMS
 0x00001004

	)

150 
	#SCTP_SET_DEBUG_LEVEL
 0x00001005

	)

151 
	#SCTP_CLR_STAT_LOG
 0x00001007

	)

153 
	#SCTP_CMT_ON_OFF
 0x00001200

	)

154 
	#SCTP_CMT_USE_DAC
 0x00001201

	)

156 
	#SCTP_PLUGGABLE_CC
 0x00001202

	)

159 
	#SCTP_GET_SNDBUF_USE
 0x00001101

	)

160 
	#SCTP_GET_STAT_LOG
 0x00001103

	)

161 
	#SCTP_PCB_STATUS
 0x00001104

	)

162 
	#SCTP_GET_NONCE_VALUES
 0x00001105

	)

168 
	#SCTP_SET_DYNAMIC_PRIMARY
 0x00002001

	)

198 
	#SCTP_VRF_ID
 0x00003001

	)

199 
	#SCTP_ADD_VRF_ID
 0x00003002

	)

200 
	#SCTP_GET_VRF_IDS
 0x00003003

	)

201 
	#SCTP_GET_ASOC_VRF
 0x00003004

	)

202 
	#SCTP_DEL_VRF_ID
 0x00003005

	)

212 
	#SCTP_GET_PACKET_LOG
 0x00004001

	)

219 
	#SCTP_BINDX_ADD_ADDR
 0x00008001

	)

220 
	#SCTP_BINDX_REM_ADDR
 0x00008002

	)

222 
	#SCTP_GET_PEER_ADDRESSES
 0x00008003

	)

223 
	#SCTP_GET_LOCAL_ADDRESSES
 0x00008004

	)

225 
	#SCTP_GET_LOCAL_ADDR_SIZE
 0x00008005

	)

227 
	#SCTP_GET_REMOTE_ADDR_SIZE
 0x00008006

	)

229 
	#SCTP_CONNECT_X
 0x00008007

	)

231 
	#SCTP_CONNECT_X_DELAYED
 0x00008008

	)

232 
	#SCTP_CONNECT_X_COMPLETE
 0x00008009

	)

234 
	#SCTP_PEELOFF
 0x0000800a

	)

236 
	#SCTP_GET_ADDR_LEN
 0x0000800b

	)

238 
	#SCTP_LISTEN_FIX
 0x0000800c

	)

240 
	#SCTP_SET_INITIAL_DBG_SEQ
 0x00009f00

	)

246 
	#SCTP_CC_RFC2581
 0x00000000

	)

248 
	#SCTP_CC_HSTCP
 0x00000001

	)

250 
	#SCTP_CC_HTCP
 0x00000002

	)

257 
	#SCTP_FRAG_LEVEL_0
 0x00000000

	)

258 
	#SCTP_FRAG_LEVEL_1
 0x00000001

	)

259 
	#SCTP_FRAG_LEVEL_2
 0x00000002

	)

264 
	#SCTP_CLOSED
 0x0000

	)

265 
	#SCTP_BOUND
 0x1000

	)

266 
	#SCTP_LISTEN
 0x2000

	)

267 
	#SCTP_COOKIE_WAIT
 0x0002

	)

268 
	#SCTP_COOKIE_ECHOED
 0x0004

	)

269 
	#SCTP_ESTABLISHED
 0x0008

	)

270 
	#SCTP_SHUTDOWN_SENT
 0x0010

	)

271 
	#SCTP_SHUTDOWN_RECEIVED
 0x0020

	)

272 
	#SCTP_SHUTDOWN_ACK_SENT
 0x0040

	)

273 
	#SCTP_SHUTDOWN_PENDING
 0x0080

	)

278 
	#SCTP_CAUSE_NO_ERROR
 0x0000

	)

279 
	#SCTP_CAUSE_INVALID_STREAM
 0x0001

	)

280 
	#SCTP_CAUSE_MISSING_PARAM
 0x0002

	)

281 
	#SCTP_CAUSE_STALE_COOKIE
 0x0003

	)

282 
	#SCTP_CAUSE_OUT_OF_RESC
 0x0004

	)

283 
	#SCTP_CAUSE_UNRESOLVABLE_ADDR
 0x0005

	)

284 
	#SCTP_CAUSE_UNRECOG_CHUNK
 0x0006

	)

285 
	#SCTP_CAUSE_INVALID_PARAM
 0x0007

	)

286 
	#SCTP_CAUSE_UNRECOG_PARAM
 0x0008

	)

287 
	#SCTP_CAUSE_NO_USER_DATA
 0x0009

	)

288 
	#SCTP_CAUSE_COOKIE_IN_SHUTDOWN
 0x000a

	)

289 
	#SCTP_CAUSE_RESTART_W_NEWADDR
 0x000b

	)

290 
	#SCTP_CAUSE_USER_INITIATED_ABT
 0x000c

	)

291 
	#SCTP_CAUSE_PROTOCOL_VIOLATION
 0x000d

	)

294 
	#SCTP_CAUSE_DELETING_LAST_ADDR
 0xa0

	)

295 
	#SCTP_CAUSE_RESOURCE_SHORTAGE
 0xa1

	)

296 
	#SCTP_CAUSE_DELETING_SRC_ADDR
 0xa2

	)

297 
	#SCTP_CAUSE_ILLEGAL_ASCONF_ACK
 0xa3

	)

298 
	#SCTP_CAUSE_REQUEST_REFUSED
 0xa4

	)

301 
	#SCTP_CAUSE_UNSUPPORTED_HMACID
 0x0105

	)

306 
	ssùp_”rÜ_ÿu£
 {

307 
ušt16_t
 
	mcode
;

308 
ušt16_t
 
	mËngth
;

310 } 
__©Œibu‹__
((
·cked
));

312 
	ssùp_”rÜ_šv®id_¡»am
 {

313 
sùp_”rÜ_ÿu£
 
	mÿu£
;

315 
ušt16_t
 
	m¡»am_id
;

316 
ušt16_t
 
	m»£rved
;

317 } 
__©Œibu‹__
((
·cked
));

319 
	ssùp_”rÜ_missšg_·¿m
 {

320 
sùp_”rÜ_ÿu£
 
	mÿu£
;

322 
ušt32_t
 
	mnum_missšg_·¿ms
;

325 } 
__©Œibu‹__
((
·cked
));

327 
	ssùp_”rÜ_¡®e_cook›
 {

328 
sùp_”rÜ_ÿu£
 
	mÿu£
;

330 
ušt32_t
 
	m¡®e_time
;

331 } 
__©Œibu‹__
((
·cked
));

333 
	ssùp_”rÜ_out_of_»sourû
 {

334 
sùp_”rÜ_ÿu£
 
	mÿu£
;

336 } 
__©Œibu‹__
((
·cked
));

338 
	ssùp_”rÜ_uÄesŞv_addr
 {

339 
sùp_”rÜ_ÿu£
 
	mÿu£
;

342 } 
__©Œibu‹__
((
·cked
));

344 
	ssùp_”rÜ_uÄecognized_chunk
 {

345 
sùp_”rÜ_ÿu£
 
	mÿu£
;

347 
sùp_chunkhdr
 
	mch
;

348 } 
__©Œibu‹__
((
·cked
));

355 
	#SCTP_DATA
 0x00

	)

356 
	#SCTP_INITIATION
 0x01

	)

357 
	#SCTP_INITIATION_ACK
 0x02

	)

358 
	#SCTP_SELECTIVE_ACK
 0x03

	)

359 
	#SCTP_HEARTBEAT_REQUEST
 0x04

	)

360 
	#SCTP_HEARTBEAT_ACK
 0x05

	)

361 
	#SCTP_ABORT_ASSOCIATION
 0x06

	)

362 
	#SCTP_SHUTDOWN
 0x07

	)

363 
	#SCTP_SHUTDOWN_ACK
 0x08

	)

364 
	#SCTP_OPERATION_ERROR
 0x09

	)

365 
	#SCTP_COOKIE_ECHO
 0x0a

	)

366 
	#SCTP_COOKIE_ACK
 0x0b

	)

367 
	#SCTP_ECN_ECHO
 0x0c

	)

368 
	#SCTP_ECN_CWR
 0x0d

	)

369 
	#SCTP_SHUTDOWN_COMPLETE
 0x0e

	)

371 
	#SCTP_AUTHENTICATION
 0x0f

	)

375 
	#SCTP_ASCONF_ACK
 0x80

	)

377 
	#SCTP_PACKET_DROPPED
 0x81

	)

379 
	#SCTP_STREAM_RESET
 0x82

	)

382 
	#SCTP_PAD_CHUNK
 0x84

	)

385 
	#SCTP_FORWARD_CUM_TSN
 0xc0

	)

387 
	#SCTP_ASCONF
 0xc1

	)

391 
	#SCTP_HAD_NO_TCB
 0x01

	)

394 
	#SCTP_FROM_MIDDLE_BOX
 
SCTP_HAD_NO_TCB


	)

395 
	#SCTP_BADCRC
 0x02

	)

396 
	#SCTP_PACKET_TRUNCATED
 0x04

	)

398 
	#SCTP_SAT_NETWORK_MIN
 400

	)

400 
	#SCTP_SAT_NETWORK_BURST_INCR
 2

	)

404 
	#SCTP_DATA_FRAG_MASK
 0x03

	)

405 
	#SCTP_DATA_MIDDLE_FRAG
 0x00

	)

406 
	#SCTP_DATA_LAST_FRAG
 0x01

	)

407 
	#SCTP_DATA_FIRST_FRAG
 0x02

	)

408 
	#SCTP_DATA_NOT_FRAG
 0x03

	)

409 
	#SCTP_DATA_UNORDERED
 0x04

	)

412 
	#SCTP_SACK_NONCE_SUM
 0x01

	)

415 
	#SCTP_SACK_CMT_DAC
 0x80

	)

422 
	#SCTP_PCB_FLAGS_UDPTYPE
 0x00000001

	)

423 
	#SCTP_PCB_FLAGS_TCPTYPE
 0x00000002

	)

424 
	#SCTP_PCB_FLAGS_BOUNDALL
 0x00000004

	)

425 
	#SCTP_PCB_FLAGS_ACCEPTING
 0x00000008

	)

426 
	#SCTP_PCB_FLAGS_UNBOUND
 0x00000010

	)

427 
	#SCTP_PCB_FLAGS_LISTENING
 0x00000020

	)

428 
	#SCTP_PCB_FLAGS_CLOSE_IP
 0x00040000

	)

429 
	#SCTP_PCB_FLAGS_WAS_CONNECTED
 0x00080000

	)

430 
	#SCTP_PCB_FLAGS_WAS_ABORTED
 0x00100000

	)

433 
	#SCTP_PCB_FLAGS_CONNECTED
 0x00200000

	)

434 
	#SCTP_PCB_FLAGS_IN_TCPPOOL
 0x00400000

	)

435 
	#SCTP_PCB_FLAGS_DONT_WAKE
 0x00800000

	)

436 
	#SCTP_PCB_FLAGS_WAKEOUTPUT
 0x01000000

	)

437 
	#SCTP_PCB_FLAGS_WAKEINPUT
 0x02000000

	)

438 
	#SCTP_PCB_FLAGS_BOUND_V6
 0x04000000

	)

439 
	#SCTP_PCB_FLAGS_NEEDS_MAPPED_V4
 0x08000000

	)

440 
	#SCTP_PCB_FLAGS_BLOCKING_IO
 0x10000000

	)

441 
	#SCTP_PCB_FLAGS_SOCKET_GONE
 0x20000000

	)

442 
	#SCTP_PCB_FLAGS_SOCKET_ALLGONE
 0x40000000

	)

444 
	#SCTP_PCB_COPY_FLAGS
 0x0e000004

	)

450 
	#SCTP_PCB_FLAGS_EXT_RCVINFO
 0x00000002

	)

451 
	#SCTP_PCB_FLAGS_DONOT_HEARTBEAT
 0x00000004

	)

452 
	#SCTP_PCB_FLAGS_FRAG_INTERLEAVE
 0x00000008

	)

453 
	#SCTP_PCB_FLAGS_INTERLEAVE_STRMS
 0x00000010

	)

454 
	#SCTP_PCB_FLAGS_DO_ASCONF
 0x00000020

	)

455 
	#SCTP_PCB_FLAGS_AUTO_ASCONF
 0x00000040

	)

456 
	#SCTP_PCB_FLAGS_ZERO_COPY_ACTIVE
 0x00000080

	)

459 
	#SCTP_PCB_FLAGS_NODELAY
 0x00000100

	)

460 
	#SCTP_PCB_FLAGS_AUTOCLOSE
 0x00000200

	)

461 
	#SCTP_PCB_FLAGS_RECVDATAIOEVNT
 0x00000400

	)

462 
	#SCTP_PCB_FLAGS_RECVASSOCEVNT
 0x00000800

	)

463 
	#SCTP_PCB_FLAGS_RECVPADDREVNT
 0x00001000

	)

464 
	#SCTP_PCB_FLAGS_RECVPEERERR
 0x00002000

	)

465 
	#SCTP_PCB_FLAGS_RECVSENDFAILEVNT
 0x00004000

	)

466 
	#SCTP_PCB_FLAGS_RECVSHUTDOWNEVNT
 0x00008000

	)

467 
	#SCTP_PCB_FLAGS_ADAPTATIONEVNT
 0x00010000

	)

468 
	#SCTP_PCB_FLAGS_PDAPIEVNT
 0x00020000

	)

469 
	#SCTP_PCB_FLAGS_AUTHEVNT
 0x00040000

	)

470 
	#SCTP_PCB_FLAGS_STREAM_RESETEVNT
 0x00080000

	)

471 
	#SCTP_PCB_FLAGS_NO_FRAGMENT
 0x00100000

	)

472 
	#SCTP_PCB_FLAGS_EXPLICIT_EOR
 0x00400000

	)

480 
	#SCTP_MOBILITY_BASE
 0x00000001

	)

481 
	#SCTP_MOBILITY_FASTHANDOFF
 0x00000002

	)

482 
	#SCTP_MOBILITY_PRIM_DELETED
 0x00000004

	)

485 
	#SCTP_SMALLEST_PMTU
 512

	)

488 
	~<Ãtš‘/sùp_uio.h
>

495 
	#SCTP_PACKET_LOG_SIZE
 65536

	)

500 
	#SCTP_MAX_SACK_DELAY
 500

	)

501 
	#SCTP_MAX_HB_INTERVAL
 14400000

	)

502 
	#SCTP_MAX_COOKIE_LIFE
 3600000

	)

511 
	#SCTP_BLK_LOGGING_ENABLE
 0x00000001

	)

512 
	#SCTP_CWND_MONITOR_ENABLE
 0x00000002

	)

513 
	#SCTP_CWND_LOGGING_ENABLE
 0x00000004

	)

514 
	#SCTP_EARLYFR_LOGGING_ENABLE
 0x00000010

	)

515 
	#SCTP_FLIGHT_LOGGING_ENABLE
 0x00000020

	)

516 
	#SCTP_FR_LOGGING_ENABLE
 0x00000040

	)

517 
	#SCTP_LOCK_LOGGING_ENABLE
 0x00000080

	)

518 
	#SCTP_MAP_LOGGING_ENABLE
 0x00000100

	)

519 
	#SCTP_MBCNT_LOGGING_ENABLE
 0x00000200

	)

520 
	#SCTP_MBUF_LOGGING_ENABLE
 0x00000400

	)

521 
	#SCTP_NAGLE_LOGGING_ENABLE
 0x00000800

	)

522 
	#SCTP_RECV_RWND_LOGGING_ENABLE
 0x00001000

	)

523 
	#SCTP_RTTVAR_LOGGING_ENABLE
 0x00002000

	)

524 
	#SCTP_SACK_LOGGING_ENABLE
 0x00004000

	)

525 
	#SCTP_SACK_RWND_LOGGING_ENABLE
 0x00008000

	)

526 
	#SCTP_SB_LOGGING_ENABLE
 0x00010000

	)

527 
	#SCTP_STR_LOGGING_ENABLE
 0x00020000

	)

528 
	#SCTP_WAKE_LOGGING_ENABLE
 0x00040000

	)

529 
	#SCTP_LOG_MAXBURST_ENABLE
 0x00080000

	)

530 
	#SCTP_LOG_RWND_ENABLE
 0x00100000

	)

531 
	#SCTP_LOG_SACK_ARRIVALS_ENABLE
 0x00200000

	)

532 
	#SCTP_LTRACE_CHUNK_ENABLE
 0x00400000

	)

533 
	#SCTP_LTRACE_ERROR_ENABLE
 0x00800000

	)

534 
	#SCTP_LAST_PACKET_TRACING
 0x01000000

	)

535 
	#SCTP_THRESHOLD_LOGGING
 0x02000000

	)

	@/usr/include/stdio.h

40 #iâdef 
_STDIO_H_


41 
	#_STDIO_H_


	)

43 
	~<sys/cdefs.h
>

44 
	~<sys/_nuÎ.h
>

45 
	~<sys/_ty³s.h
>

47 
__off_t
 
	tåos_t
;

49 #iâdeà
_SIZE_T_DECLARED


50 
__size_t
 
	tsize_t
;

51 
	#_SIZE_T_DECLARED


	)

54 #ià
__BSD_VISIBLE
 || 
__POSIX_VISIBLE
 >ğ200112 || 
__XSI_VISIBLE


55 #iâdeà
_VA_LIST_DECLARED


56 
__va_li¡
 
	tva_li¡
;

57 
	#_VA_LIST_DECLARED


	)

61 
	#_FSTDIO


	)

70 
	s__sbuf
 {

71 *
	m_ba£
;

72 
	m_size
;

76 
	g__sFILEX
;

102 
	s__sFILE
 {

103 *
	m_p
;

104 
	m_r
;

105 
	m_w
;

106 
	m_æags
;

107 
	m_fe
;

108 
__sbuf
 
	m_bf
;

109 
	m_lbfsize
;

112 *
	m_cook›
;

113 (*
	m_şo£
)(*);

114 (*
	m_»ad
)(*, *, );

115 
åos_t
 (*
_£ek
)(*, 
	måos_t
, );

116 (*
	m_wr™e
)(*, const *, );

119 
__sbuf
 
	m_ub
;

120 
__sFILEX
 *
	m_exŒa
;

121 
	m_ur
;

124 
	m_ubuf
[3];

125 
	m_nbuf
[1];

128 
__sbuf
 
	m_lb
;

131 
	m_blksize
;

132 
åos_t
 
	m_off£t
;

133 } 
	tFILE
;

135 #iâdeà
_STDSTREAM_DECLARED


136 
__BEGIN_DECLS


137 
FILE
 *
__¡dšp
;

138 
FILE
 *
__¡dou
;

139 
FILE
 *
__¡d”½
;

140 
	g__END_DECLS


141 
	#_STDSTREAM_DECLARED


	)

144 
	#__SLBF
 0x0001

	)

145 
	#__SNBF
 0x0002

	)

146 
	#__SRD
 0x0004

	)

147 
	#__SWR
 0x0008

	)

149 
	#__SRW
 0x0010

	)

150 
	#__SEOF
 0x0020

	)

151 
	#__SERR
 0x0040

	)

152 
	#__SMBF
 0x0080

	)

153 
	#__SAPP
 0x0100

	)

154 
	#__SSTR
 0x0200

	)

155 
	#__SOPT
 0x0400

	)

156 
	#__SNPT
 0x0800

	)

157 
	#__SOFF
 0x1000

	)

158 
	#__SMOD
 0x2000

	)

159 
	#__SALC
 0x4000

	)

160 
	#__SIGN
 0x8000

	)

171 
	#_IOFBF
 0

	)

172 
	#_IOLBF
 1

	)

173 
	#_IONBF
 2

	)

175 
	#BUFSIZ
 1024

	)

176 
	#EOF
 (-1)

	)

184 
	#FOPEN_MAX
 20

	)

185 
	#FILENAME_MAX
 1024

	)

188 #ià
__XSI_VISIBLE


189 
	#P_tmpdœ
 "/v¬/tmp/"

	)

191 
	#L_tm²am
 1024

	)

192 
	#TMP_MAX
 308915776

	)

194 #iâdeà
SEEK_SET


195 
	#SEEK_SET
 0

	)

197 #iâdeà
SEEK_CUR


198 
	#SEEK_CUR
 1

	)

200 #iâdeà
SEEK_END


201 
	#SEEK_END
 2

	)

204 
	#¡dš
 
__¡dšp


	)

205 
	#¡dout
 
__¡dou


	)

206 
	#¡d”r
 
__¡d”½


	)

208 
__BEGIN_DECLS


212 
ş—»¼
(
FILE
 *);

213 
fşo£
(
FILE
 *);

214 
ãof
(
FILE
 *);

215 
ã¼Ü
(
FILE
 *);

216 
fæush
(
FILE
 *);

217 
fg‘c
(
FILE
 *);

218 
fg‘pos
(
FILE
 * 
__»¡riù
, 
åos_t
 * __restrict);

219 *
fg‘s
(* 
__»¡riù
, , 
FILE
 * __restrict);

220 
FILE
 *
fİ’
(cÚ¡ * 
__»¡riù
, const * __restrict);

221 
årštf
(
FILE
 * 
__»¡riù
, const * __restrict, ...);

222 
åutc
(, 
FILE
 *);

223 
åuts
(cÚ¡ * 
__»¡riù
, 
FILE
 * __restrict);

224 
size_t
 
ä—d
(* 
__»¡riù
, size_t, size_t, 
FILE
 * __restrict);

225 
FILE
 *
äeİ’
(cÚ¡ * 
__»¡riù
, const * __restrict, FILE * __restrict);

226 
fsÿnf
(
FILE
 * 
__»¡riù
, const * __restrict, ...);

227 
f£ek
(
FILE
 *, , );

228 
f£os
(
FILE
 *, cÚ¡ 
åos_t
 *);

229 
á–l
(
FILE
 *);

230 
size_t
 
fwr™e
(cÚ¡ * 
__»¡riù
, size_t, size_t, 
FILE
 * __restrict);

231 
g‘c
(
FILE
 *);

232 
g‘ch¬
();

233 *
g‘s
(*);

234 
³¼Ü
(const *);

235 
´štf
(cÚ¡ * 
__»¡riù
, ...);

236 
putc
(, 
FILE
 *);

237 
putch¬
();

238 
puts
(const *);

239 
»move
(const *);

240 
»Çme
(const *, const *);

241 
»wšd
(
FILE
 *);

242 
sÿnf
(cÚ¡ * 
__»¡riù
, ...);

243 
£tbuf
(
FILE
 * 
__»¡riù
, * __restrict);

244 
£tvbuf
(
FILE
 * 
__»¡riù
, * __»¡riù, , 
size_t
);

245 
¥rštf
(* 
__»¡riù
, const * __restrict, ...);

246 
ssÿnf
(cÚ¡ * 
__»¡riù
, const * __restrict, ...);

247 
FILE
 *
tmpfe
();

248 *
tm²am
(*);

249 
ung‘c
(, 
FILE
 *);

250 
vårštf
(
FILE
 * 
__»¡riù
, const * __restrict,

251 
__va_li¡
);

252 
v´štf
(cÚ¡ * 
__»¡riù
, 
__va_li¡
);

253 
v¥rštf
(* 
__»¡riù
, const * __restrict,

254 
__va_li¡
);

256 #ià
__ISO_C_VISIBLE
 >= 1999

257 
	$¢´štf
(* 
__»¡riù
, 
size_t
, const * __restrict,

258 ...è
	`__´štæike
(3, 4);

259 
	$vfsÿnf
(
FILE
 * 
__»¡riù
, cÚ¡ * __»¡riù, 
__va_li¡
)

260 
	`__sÿnæike
(2, 0);

261 
	$vsÿnf
(cÚ¡ * 
__»¡riù
, 
__va_li¡
è
	`__sÿnæike
(1, 0);

262 
	$v¢´štf
(* 
__»¡riù
, 
size_t
, const * __restrict,

263 
__va_li¡
è
	`__´štæike
(3, 0);

264 
	$vssÿnf
(cÚ¡ * 
__»¡riù
, cÚ¡ * __»¡riù, 
__va_li¡
)

265 
	`__sÿnæike
(2, 0);

271 #ià
__BSD_VISIBLE
 || 
__POSIX_VISIBLE
 <= 199506

273 
	#L_cu£rid
 17

	)

276 #ià
__POSIX_VISIBLE


277 
	#L_ù”mid
 1024

	)

279 *
	`ù”mid
(*);

280 
FILE
 *
	`fdİ’
(, const *);

281 
	`f’o
(
FILE
 *);

284 #ià
__POSIX_VISIBLE
 >= 199209

285 
	`pşo£
(
FILE
 *);

286 
FILE
 *
	`pİ’
(const *, const *);

289 #ià
__POSIX_VISIBLE
 >= 199506

290 
	`árylockfe
(
FILE
 *);

291 
	`æockfe
(
FILE
 *);

292 
	`fuÆockfe
(
FILE
 *);

298 
	`g‘c_uÆocked
(
FILE
 *);

299 
	`g‘ch¬_uÆocked
();

300 
	`putc_uÆocked
(, 
FILE
 *);

301 
	`putch¬_uÆocked
();

303 #ià
__BSD_VISIBLE


304 
	`ş—»¼_uÆocked
(
FILE
 *);

305 
	`ãof_uÆocked
(
FILE
 *);

306 
	`ã¼Ü_uÆocked
(
FILE
 *);

307 
	`f’o_uÆocked
(
FILE
 *);

310 #ià
__POSIX_VISIBLE
 >= 200112

311 
	`f£eko
(
FILE
 *, 
__off_t
, );

312 
__off_t
 
	`á–lo
(
FILE
 *);

315 #ià
__BSD_VISIBLE
 || 
__XSI_VISIBLE
 > 0 && __XSI_VISIBLE < 600

316 
	`g‘w
(
FILE
 *);

317 
	`putw
(, 
FILE
 *);

320 #ià
__XSI_VISIBLE


321 *
	`‹m²am
(const *, const *);

327 #ià
__BSD_VISIBLE


328 
	$a¥rštf
(**, cÚ¡ *, ...è
	`__´štæike
(2, 3);

329 *
	`ù”mid_r
(*);

330 
	`fşo£®l
();

331 *
	`fg‘Ê
(
FILE
 *, 
size_t
 *);

332 
__cÚ¡
 *
	$fmtcheck
(cÚ¡ *, cÚ¡ *è
	`__fÜm©_¬g
(2);

333 
	`åurge
(
FILE
 *);

334 
	`£tbufãr
(
FILE
 *, *, );

335 
	`£šebuf
(
FILE
 *);

336 
	$va¥rštf
(**, cÚ¡ *, 
__va_li¡
)

337 
	`__´štæike
(2, 0);

344 
__cÚ¡
 
sys_Ã¼
;

345 
__cÚ¡
 *__cÚ¡ 
sys_”¾i¡
[];

350 
FILE
 *
	`funİ’
(const *,

353 
	$åos_t
 (*)(*, 
åos_t
, ),

355 
	#äİ’
(
cook›
, 
â
è
	`funİ’
(cook›, fn, 0, 0, 0)

	)

356 
	#fwİ’
(
cook›
, 
â
è
	`funİ’
(cook›, 0, fn, 0, 0)

	)

361 #iâdeà
_FTRUNCATE_DECLARED


362 
	#_FTRUNCATE_DECLARED


	)

363 
	`árunÿ‹
(, 
__off_t
);

365 #iâdeà
_LSEEK_DECLARED


366 
	#_LSEEK_DECLARED


	)

367 
__off_t
 
	`l£ek
(, __off_t, );

369 #iâdeà
_MMAP_DECLARED


370 
	#_MMAP_DECLARED


	)

371 *
	`mm­
(*, 
size_t
, , , , 
__off_t
);

373 #iâdeà
_TRUNCATE_DECLARED


374 
	#_TRUNCATE_DECLARED


	)

375 
	`Œunÿ‹
(cÚ¡ *, 
__off_t
);

382 
	`__¤g‘
(
FILE
 *);

383 
	`__swbuf
(, 
FILE
 *);

389 
	#__sg‘c
(
p
è(--Õ)->
_r
 < 0 ? 
	`__¤g‘
Õè: ()(*Õ)->
_p
++))

	)

390 #ià
	`defšed
(
__GNUC__
è&& defšed(
__STDC__
)

391 
__šlše
 
	$__¥utc
(
_c
, 
FILE
 *
_p
) {

392 ià(--
_p
->
_w
 >ğ0 || (_p->_w >ğ_p->
_lbfsize
 && ()
_c
 != '\n'))

393  (*
_p
->_p++ = 
_c
);

395  (
	`__swbuf
(
_c
, 
_p
));

396 
	}
}

401 
	#__¥utc
(
c
, 
p
) \

402 (--(
p
)->
_w
 < 0 ? \

403 (
p
)->
_w
 >ğÕ)->
_lbfsize
 ? \

404 (*(
p
)->
_p
 = (
c
)), *(p)->_p != '\n' ? \

405 ()*(
p
)->
_p
++ : \

406 
	`__swbuf
('\n', 
p
) : \

407 
	`__swbuf
(()(
c
), 
p
) : \

408 (*(
p
)->
_p
 = (
c
), ()*Õ)->_p++))

	)

411 
	#__sãof
(
p
è((Õ)->
_æags
 & 
__SEOF
è!ğ0)

	)

412 
	#__sã¼Ü
(
p
è((Õ)->
_æags
 & 
__SERR
è!ğ0)

	)

413 
	#__sş—»¼
(
p
è(()(Õ)->
_æags
 &ğ~(
__SERR
|
__SEOF
)))

	)

414 
	#__sf’o
(
p
è(Õ)->
_fe
)

	)

416 
__i¡h»aded
;

418 
	#ãof
(
p
è(!
__i¡h»aded
 ? 
	`__sãof
Õè: (
ãof
)Õ))

	)

419 
	#ã¼Ü
(
p
è(!
__i¡h»aded
 ? 
	`__sã¼Ü
Õè: (
ã¼Ü
)Õ))

	)

420 
	#ş—»¼
(
p
è(!
__i¡h»aded
 ? 
	`__sş—»¼
Õè: (
ş—»¼
)Õ))

	)

422 #ià
__POSIX_VISIBLE


423 
	#f’o
(
p
è(!
__i¡h»aded
 ? 
	`__sf’o
Õè: (
f’o
)Õ))

	)

426 
	#g‘c
(
å
è(!
__i¡h»aded
 ? 
	`__sg‘c
(åè: (
g‘c
)(å))

	)

427 
	#putc
(
x
, 
å
è(!
__i¡h»aded
 ? 
	`__¥utc
(x, fpè: (
putc
)(x, fp))

	)

429 
	#g‘ch¬
(è
	`g‘c
(
¡dš
)

	)

430 
	#putch¬
(
x
è
	`putc
(x, 
¡dout
)

	)

432 #ià
__BSD_VISIBLE


437 
	#ãof_uÆocked
(
p
è
	`__sãof
Õ)

	)

438 
	#ã¼Ü_uÆocked
(
p
è
	`__sã¼Ü
Õ)

	)

439 
	#ş—»¼_uÆocked
(
p
è
	`__sş—»¼
Õ)

	)

440 
	#f’o_uÆocked
(
p
è
	`__sf’o
Õ)

	)

442 #ià
__POSIX_VISIBLE
 >= 199506

443 
	#g‘c_uÆocked
(
å
è
	`__sg‘c
(å)

	)

444 
	#putc_uÆocked
(
x
, 
å
è
	`__¥utc
(x, fp)

	)

446 
	#g‘ch¬_uÆocked
(è
	`g‘c_uÆocked
(
¡dš
)

	)

447 
	#putch¬_uÆocked
(
x
è
	`putc_uÆocked
(x, 
¡dout
)

	)

450 
	g__END_DECLS


	@/usr/include/stdlib.h

37 #iâdeà
_STDLIB_H_


38 
	#_STDLIB_H_


	)

40 
	~<sys/cdefs.h
>

41 
	~<sys/_nuÎ.h
>

42 
	~<sys/_ty³s.h
>

44 #ià
__BSD_VISIBLE


45 #iâdeà
_RUNE_T_DECLARED


46 
__ruÃ_t
 
	truÃ_t
;

47 
	#_RUNE_T_DECLARED


	)

51 #iâdeà
_SIZE_T_DECLARED


52 
__size_t
 
	tsize_t
;

53 
	#_SIZE_T_DECLARED


	)

56 #iâdef 
__ılu¥lus


57 #iâdeà
_WCHAR_T_DECLARED


58 
__wch¬_t
 
	twch¬_t
;

59 
	#_WCHAR_T_DECLARED


	)

64 
	mquÙ
;

65 
	m»m
;

66 } 
	tdiv_t
;

69 
	mquÙ
;

70 
	m»m
;

71 } 
	tldiv_t
;

73 
	#EXIT_FAILURE
 1

	)

74 
	#EXIT_SUCCESS
 0

	)

76 
	#RAND_MAX
 0x7fffffff

	)

78 
__mb_cur_max
;

79 
	#MB_CUR_MAX
 
__mb_cur_max


	)

81 
__BEGIN_DECLS


82 
	$abÜt
(è
__d—d2
;

83 
	$abÜt2
(cÚ¡ *, , **è
__d—d2
;

84 
	$abs
(è
__pu»2
;

85 
	`©ex™
((*)());

86 
	`©of
(const *);

87 
	`©oi
(const *);

88 
	`©Ş
(const *);

89 *
	`b£¬ch
(cÚ¡ *, cÚ¡ *, 
size_t
,

90 
size_t
, (*)(const *, const *));

91 *
	`ÿÎoc
(
size_t
, size_t);

92 
div_t
 
	$div
(, è
__pu»2
;

93 
	$ex™
(è
__d—d2
;

94 
	`ä“
(*);

95 *
	`g‘’v
(const *);

96 
	$Ïbs
(è
__pu»2
;

97 
ldiv_t
 
	$ldiv
(, è
__pu»2
;

98 *
	`m®loc
(
size_t
);

99 
	`mbËn
(cÚ¡ *, 
size_t
);

100 
size_t
 
	`mb¡owcs
(
wch¬_t
 * 
__»¡riù
 , const * __restrict, size_t);

101 
	`mbtowc
(
wch¬_t
 * 
__»¡riù
, cÚ¡ * __»¡riù, 
size_t
);

102 
	`qsÜt
(*, 
size_t
, size_t,

104 
	`¿nd
();

105 *
	`»®loc
(*, 
size_t
);

106 
	`¤ªd
();

107 
	`¡¹od
(cÚ¡ * 
__»¡riù
, ** __restrict);

108 
	`¡¹of
(cÚ¡ * 
__»¡riù
, ** __restrict);

109 
	`¡¹Ş
(cÚ¡ * 
__»¡riù
, ** __restrict, );

111 
	`¡¹Şd
(cÚ¡ * 
__»¡riù
, ** __restrict);

113 
	`¡¹oul
(cÚ¡ * 
__»¡riù
, ** __restrict, );

114 
	`sy¡em
(const *);

115 
	`wùomb
(*, 
wch¬_t
);

116 
size_t
 
	`wc¡ombs
(* 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict, size_t);

128 #ià
__ISO_C_VISIBLE
 >= 1999

129 #ifdeà
__LONG_LONG_SUPPORTED


132 
quÙ
;

133 
»m
;

134 } 
	tÎdiv_t
;

138 
	`©Şl
(const *);

141 
	$Îabs
(è
__pu»2
;

143 
Îdiv_t
 
	$Îdiv
(, è
__pu»2
;

146 
	`¡¹Şl
(cÚ¡ * 
__»¡riù
, ** __restrict, );

149 
	`¡¹ouÎ
(cÚ¡ * 
__»¡riù
, ** __restrict, );

152 
	$_Ex™
(è
__d—d2
;

160 #ià
__POSIX_VISIBLE


161 
	`posix_mem®ign
(**, 
size_t
, size_t);

162 
	`¿nd_r
(*);

163 
	`£‹nv
(const *, const *, );

164 
	`un£‹nv
(const *);

173 #ià
__XSI_VISIBLE


175 
	`a64l
(const *);

176 
	`d¿nd48
();

178 
	`”ªd48
([3]);

181 
	`g‘subİt
(**, *const *, **);

182 
	`g¿Á±
();

183 *
	`š™¡©e
(, *, );

184 
	`j¿nd48
([3]);

185 *
	`l64a
();

186 
	`lcÚg48
([7]);

187 
	`Ìªd48
();

188 #iâdeà
_MKSTEMP_DECLARED


189 
	`mk¡emp
(*);

190 
	#_MKSTEMP_DECLARED


	)

192 #iâdeà
_MKTEMP_DECLARED


193 *
	`mk‹mp
(*);

194 
	#_MKTEMP_DECLARED


	)

196 
	`m¿nd48
();

197 
	`Äªd48
([3]);

198 
	`posix_İ’±
();

199 *
	`±¢ame
();

200 
	`pu‹nv
(*);

201 
	`¿ndom
();

202 *
	`»®·th
(cÚ¡ *, 
»sŞved_·th
[]);

204 *
	`£ed48
([3]);

205 #iâdeà
_SETKEY_DECLARED


206 
	`£tkey
(const *);

207 
	#_SETKEY_DECLARED


	)

209 *
	`£t¡©e
( *);

210 
	`¤ªd48
();

211 
	`¤ªdom
();

212 
	`uÆock±
();

215 #ià
__BSD_VISIBLE


216 cÚ¡ *
_m®loc_İtiÚs
;

217 (*
_m®loc_mes§ge
)(const *, const *, const *,

229 #ià
__GNUC__
 >ğ2 || 
	`defšed
(
__INTEL_COMPILER
)

230 #undeà
®loÿ


231 
	#®loÿ
(
sz
è
	`__butš_®loÿ
(sz)

	)

232 #–ià
	`defšed
(
lšt
)

233 *
	`®loÿ
(
size_t
);

236 
__ušt32_t


237 
	`¬c4¿ndom
();

238 
	`¬c4¿ndom_add¿ndom
(*
d©
, 
d©Ën
);

239 
	`¬c4¿ndom_¡œ
();

240 *
	`g‘bsize
(*, *);

242 *
	`cg‘ÿp
(*, const *, );

243 
	`cg‘şo£
();

244 
	`cg‘’t
(**, **, const *);

245 
	`cg‘fœ¡
(**, **);

246 
	`cg‘m©ch
(const *, const *);

247 
	`cg‘Ãxt
(**, **);

248 
	`cg‘num
(*, const *, *);

249 
	`cg‘£t
(const *);

250 
	`cg‘¡r
(*, const *, **);

251 
	`cg‘u¡r
(*, const *, **);

253 
	`d«mÚ
(, );

254 *
	`devÇme
(
__dev_t
, 
__mode_t
);

255 *
	`devÇme_r
(
__dev_t
, 
__mode_t
, *, );

256 
	`g‘lßdavg
([], );

257 
__cÚ¡
 *

258 
	`g‘´ogÇme
();

260 
	`h—psÜt
(*, 
size_t
, size_t, (*)(const *, const *));

261 
	`l64a_r
(, *, );

262 
	`m”gesÜt
(*, 
size_t
, size_t, (*)(const *, const *));

263 
	`qsÜt_r
(*, 
size_t
, size_t, *,

265 
	`¿dixsÜt
(const **, , const *,

267 *
	`»®locf
(*, 
size_t
);

268 
	`½m©ch
(const *);

269 
	`£rogÇme
(const *);

270 
	`¤adixsÜt
(const **, , const *,

272 
	`¤ªddev
();

273 
	`¤ªdomdev
();

275 
	`¡¹Úum
(const *, , , const **);

278 
__št64_t


279 
	`¡¹oq
(const *, **, );

280 
__ušt64_t


281 
	`¡¹ouq
(const *, **, );

283 *
subİrg
;

285 
__END_DECLS


	@/usr/include/string.h

37 #iâdeà
_STRING_H_


38 
	#_STRING_H_


	)

40 
	~<sys/cdefs.h
>

41 
	~<sys/_nuÎ.h
>

42 
	~<sys/_ty³s.h
>

48 #ià
__BSD_VISIBLE


49 
	~<¡ršgs.h
>

52 #iâdeà
_SIZE_T_DECLARED


53 
__size_t
 
	tsize_t
;

54 
	#_SIZE_T_DECLARED


	)

57 
	g__BEGIN_DECLS


58 #ià
__POSIX_VISIBLE
 >ğ200112 || 
__XSI_VISIBLE


59 *
memcıy
(* 
__»¡riù
, cÚ¡ * __»¡riù, , 
size_t
);

61 *
	$memchr
(cÚ¡ *, , 
size_t
è
__pu»
;

62 
	$memcmp
(cÚ¡ *, cÚ¡ *, 
size_t
è
__pu»
;

63 *
	`memıy
(* 
__»¡riù
, cÚ¡ * __»¡riù, 
size_t
);

64 #ià
__BSD_VISIBLE


65 *
	`memmem
(cÚ¡ *, 
size_t
, const *, size_t);

67 *
	`memmove
(*, cÚ¡ *, 
size_t
);

68 *
	`mem£t
(*, , 
size_t
);

69 #ià
__BSD_VISIBLE


70 *
	`¡pıy
(*, const *);

71 *
	$¡rÿ£¡r
(cÚ¡ *, cÚ¡ *è
__pu»
;

73 *
	`¡rÿt
(* 
__»¡riù
, const * __restrict);

74 *
	$¡rchr
(cÚ¡ *, è
__pu»
;

75 
	$¡rcmp
(cÚ¡ *, cÚ¡ *è
__pu»
;

76 
	`¡rcŞl
(const *, const *);

77 *
	`¡rıy
(* 
__»¡riù
, const * __restrict);

78 
size_t
 
	$¡rc¥n
(cÚ¡ *, cÚ¡ *è
__pu»
;

79 #ià
__POSIX_VISIBLE
 >ğ200112 || 
__XSI_VISIBLE


80 *
	`¡rdup
(const *);

82 *
	`¡»¼Ü
();

83 #ià
__POSIX_VISIBLE
 >= 200112

84 
	`¡»¼Ü_r
(, *, 
size_t
);

86 #ià
__BSD_VISIBLE


87 
size_t
 
	`¡¾ÿt
(*, const *, size_t);

88 
size_t
 
	`¡¾ıy
(*, const *, size_t);

90 
size_t
 
	$¡¾’
(cÚ¡ *è
__pu»
;

91 #ià
__BSD_VISIBLE


92 
	`¡rmode
(, *);

94 *
	`¡ºÿt
(* 
__»¡riù
, cÚ¡ * __»¡riù, 
size_t
);

95 
	$¡ºcmp
(cÚ¡ *, cÚ¡ *, 
size_t
è
__pu»
;

96 *
	`¡ºıy
(* 
__»¡riù
, cÚ¡ * __»¡riù, 
size_t
);

97 #ià
__BSD_VISIBLE


98 *
	$¡º¡r
(cÚ¡ *, cÚ¡ *, 
size_t
è
__pu»
;

100 *
	$¡½brk
(cÚ¡ *, cÚ¡ *è
__pu»
;

101 *
	$¡¼chr
(cÚ¡ *, è
__pu»
;

102 #ià
__BSD_VISIBLE


103 *
	`¡r£p
(**, const *);

104 *
	`¡rsigÇl
();

106 
size_t
 
	$¡r¥n
(cÚ¡ *, cÚ¡ *è
__pu»
;

107 *
	$¡r¡r
(cÚ¡ *, cÚ¡ *è
__pu»
;

108 *
	`¡¹ok
(* 
__»¡riù
, const * __restrict);

109 #ià
__POSIX_VISIBLE
 >ğ199506 || 
__XSI_VISIBLE
 >= 500

110 *
	`¡¹ok_r
(*, const *, **);

112 
size_t
 
	`¡rxäm
(* 
__»¡riù
, const * __restrict, size_t);

113 #ià
__BSD_VISIBLE


115 #iâdeà
_SWAB_DECLARED


116 
	#_SWAB_DECLARED


	)

118 #iâdeà
_SSIZE_T_DECLARED


119 
__ssize_t
 
	tssize_t
;

120 
	#_SSIZE_T_DECLARED


	)

123 
	`swab
(cÚ¡ * 
__»¡riù
, * __»¡riù, 
ssize_t
);

127 
__END_DECLS


	@/usr/include/strings.h

29 #iâdeà
_STRINGS_H_


30 
	#_STRINGS_H_


	)

32 
	~<sys/cdefs.h
>

33 
	~<sys/_ty³s.h
>

35 #iâdeà
_SIZE_T_DECLARED


36 
__size_t
 
	tsize_t
;

37 
	#_SIZE_T_DECLARED


	)

40 
__BEGIN_DECLS


41 
	$bcmp
(cÚ¡ *, cÚ¡ *, 
size_t
è
__pu»
;

42 
	`bcİy
(cÚ¡ *, *, 
size_t
);

43 
	`bz”o
(*, 
size_t
);

44 
	$ffs
(è
__pu»2
;

45 #ifdeà
__BSD_VISIBLE


46 
	$ff¦
(è
__pu»2
;

47 
	$æs
(è
__pu»2
;

48 
	$æ¦
(è
__pu»2
;

50 *
	$šdex
(cÚ¡ *, è
__pu»
;

51 *
	$ršdex
(cÚ¡ *, è
__pu»
;

52 
	$¡rÿ£cmp
(cÚ¡ *, cÚ¡ *è
__pu»
;

53 
	$¡ºÿ£cmp
(cÚ¡ *, cÚ¡ *, 
size_t
è
__pu»
;

54 
__END_DECLS


	@/usr/include/sys/socket.h

33 #iâdeà
_SYS_SOCKET_H_


34 
	#_SYS_SOCKET_H_


	)

36 
	~<sys/cdefs.h
>

37 
	~<sys/_ty³s.h
>

38 
	~<sys/_iovec.h
>

39 
	#_NO_NAMESPACE_POLLUTION


	)

40 
	~<machše/·¿m.h
>

41 #undeà
_NO_NAMESPACE_POLLUTION


50 #ià
__BSD_VISIBLE


51 #iâdeà
_GID_T_DECLARED


52 
__gid_t
 
	tgid_t
;

53 
	#_GID_T_DECLARED


	)

56 #iâdeà
_OFF_T_DECLARED


57 
__off_t
 
	toff_t
;

58 
	#_OFF_T_DECLARED


	)

61 #iâdeà
_PID_T_DECLARED


62 
__pid_t
 
	tpid_t
;

63 
	#_PID_T_DECLARED


	)

67 #iâdeà
_SA_FAMILY_T_DECLARED


68 
__§_çmy_t
 
	t§_çmy_t
;

69 
	#_SA_FAMILY_T_DECLARED


	)

72 #iâdeà
_SOCKLEN_T_DECLARED


73 
__sockËn_t
 
	tsockËn_t
;

74 
	#_SOCKLEN_T_DECLARED


	)

77 #iâdeà
_SSIZE_T_DECLARED


78 
__ssize_t
 
	tssize_t
;

79 
	#_SSIZE_T_DECLARED


	)

82 #ià
__BSD_VISIBLE


83 #iâdeà
_UID_T_DECLARED


84 
__uid_t
 
	tuid_t
;

85 
	#_UID_T_DECLARED


	)

92 
	#SOCK_STREAM
 1

	)

93 
	#SOCK_DGRAM
 2

	)

94 
	#SOCK_RAW
 3

	)

95 #ià
__BSD_VISIBLE


96 
	#SOCK_RDM
 4

	)

98 
	#SOCK_SEQPACKET
 5

	)

103 
	#SO_DEBUG
 0x0001

	)

104 
	#SO_ACCEPTCONN
 0x0002

	)

105 
	#SO_REUSEADDR
 0x0004

	)

106 
	#SO_KEEPALIVE
 0x0008

	)

107 
	#SO_DONTROUTE
 0x0010

	)

108 
	#SO_BROADCAST
 0x0020

	)

109 #ià
__BSD_VISIBLE


110 
	#SO_USELOOPBACK
 0x0040

	)

112 
	#SO_LINGER
 0x0080

	)

113 
	#SO_OOBINLINE
 0x0100

	)

114 #ià
__BSD_VISIBLE


115 
	#SO_REUSEPORT
 0x0200

	)

116 
	#SO_TIMESTAMP
 0x0400

	)

117 
	#SO_NOSIGPIPE
 0x0800

	)

118 
	#SO_ACCEPTFILTER
 0x1000

	)

119 
	#SO_BINTIME
 0x2000

	)

125 
	#SO_SNDBUF
 0x1001

	)

126 
	#SO_RCVBUF
 0x1002

	)

127 
	#SO_SNDLOWAT
 0x1003

	)

128 
	#SO_RCVLOWAT
 0x1004

	)

129 
	#SO_SNDTIMEO
 0x1005

	)

130 
	#SO_RCVTIMEO
 0x1006

	)

131 
	#SO_ERROR
 0x1007

	)

132 
	#SO_TYPE
 0x1008

	)

133 #ià
__BSD_VISIBLE


134 
	#SO_LABEL
 0x1009

	)

135 
	#SO_PEERLABEL
 0x1010

	)

136 
	#SO_LISTENQLIMIT
 0x1011

	)

137 
	#SO_LISTENQLEN
 0x1012

	)

138 
	#SO_LISTENINCQLEN
 0x1013

	)

144 
	slšg”
 {

145 
	ml_Úoff
;

146 
	ml_lšg”
;

149 #ià
__BSD_VISIBLE


150 
	sacû±_f‹r_¬g
 {

151 
	maf_Çme
[16];

152 
	maf_¬g
[256-16];

159 
	#SOL_SOCKET
 0xfffà

	)

164 
	#AF_UNSPEC
 0

	)

165 #ià
__BSD_VISIBLE


166 
	#AF_LOCAL
 
AF_UNIX


	)

168 
	#AF_UNIX
 1

	)

169 
	#AF_INET
 2

	)

170 #ià
__BSD_VISIBLE


171 
	#AF_IMPLINK
 3

	)

172 
	#AF_PUP
 4

	)

173 
	#AF_CHAOS
 5

	)

174 
	#AF_NETBIOS
 6

	)

175 
	#AF_ISO
 7

	)

176 
	#AF_OSI
 
AF_ISO


	)

177 
	#AF_ECMA
 8

	)

178 
	#AF_DATAKIT
 9

	)

179 
	#AF_CCITT
 10

	)

180 
	#AF_SNA
 11

	)

181 
	#AF_DECÃt
 12

	)

182 
	#AF_DLI
 13

	)

183 
	#AF_LAT
 14

	)

184 
	#AF_HYLINK
 15

	)

185 
	#AF_APPLETALK
 16

	)

186 
	#AF_ROUTE
 17

	)

187 
	#AF_LINK
 18

	)

188 
	#p£udo_AF_XTP
 19

	)

189 
	#AF_COIP
 20

	)

190 
	#AF_CNT
 21

	)

191 
	#p£udo_AF_RTIP
 22

	)

192 
	#AF_IPX
 23

	)

193 
	#AF_SIP
 24

	)

194 
	#p£udo_AF_PIP
 25

	)

195 
	#AF_ISDN
 26

	)

196 
	#AF_E164
 
AF_ISDN


	)

197 
	#p£udo_AF_KEY
 27

	)

199 
	#AF_INET6
 28

	)

200 #ià
__BSD_VISIBLE


201 
	#AF_NATM
 29

	)

202 
	#AF_ATM
 30

	)

203 
	#p£udo_AF_HDRCMPLT
 31

	)

206 
	#AF_NETGRAPH
 32

	)

207 
	#AF_SLOW
 33

	)

208 
	#AF_SCLUSTER
 34

	)

209 
	#AF_ARP
 35

	)

210 
	#AF_BLUETOOTH
 36

	)

211 
	#AF_IEEE80211
 37

	)

212 
	#AF_MAX
 38

	)

218 
	#AF_VENDOR00
 39

	)

219 
	#AF_VENDOR01
 41

	)

220 
	#AF_VENDOR02
 43

	)

221 
	#AF_VENDOR03
 45

	)

222 
	#AF_VENDOR04
 47

	)

223 
	#AF_VENDOR05
 49

	)

224 
	#AF_VENDOR06
 51

	)

225 
	#AF_VENDOR07
 53

	)

226 
	#AF_VENDOR08
 55

	)

227 
	#AF_VENDOR09
 57

	)

228 
	#AF_VENDOR10
 59

	)

229 
	#AF_VENDOR11
 61

	)

230 
	#AF_VENDOR12
 63

	)

231 
	#AF_VENDOR13
 65

	)

232 
	#AF_VENDOR14
 67

	)

233 
	#AF_VENDOR15
 69

	)

234 
	#AF_VENDOR16
 71

	)

235 
	#AF_VENDOR17
 73

	)

236 
	#AF_VENDOR18
 75

	)

237 
	#AF_VENDOR19
 77

	)

238 
	#AF_VENDOR20
 79

	)

239 
	#AF_VENDOR21
 81

	)

240 
	#AF_VENDOR22
 83

	)

241 
	#AF_VENDOR23
 85

	)

242 
	#AF_VENDOR24
 87

	)

243 
	#AF_VENDOR25
 89

	)

244 
	#AF_VENDOR26
 91

	)

245 
	#AF_VENDOR27
 93

	)

246 
	#AF_VENDOR28
 95

	)

247 
	#AF_VENDOR29
 97

	)

248 
	#AF_VENDOR30
 99

	)

249 
	#AF_VENDOR31
 101

	)

250 
	#AF_VENDOR32
 103

	)

251 
	#AF_VENDOR33
 105

	)

252 
	#AF_VENDOR34
 107

	)

253 
	#AF_VENDOR35
 109

	)

254 
	#AF_VENDOR36
 111

	)

255 
	#AF_VENDOR37
 113

	)

256 
	#AF_VENDOR38
 115

	)

257 
	#AF_VENDOR39
 117

	)

258 
	#AF_VENDOR40
 119

	)

259 
	#AF_VENDOR41
 121

	)

260 
	#AF_VENDOR42
 123

	)

261 
	#AF_VENDOR43
 125

	)

262 
	#AF_VENDOR44
 127

	)

263 
	#AF_VENDOR45
 129

	)

264 
	#AF_VENDOR46
 131

	)

265 
	#AF_VENDOR47
 133

	)

272 
	ssockaddr
 {

273 
	m§_Ën
;

274 
§_çmy_t
 
	m§_çmy
;

275 
	m§_d©a
[14];

277 #ià
__BSD_VISIBLE


278 
	#SOCK_MAXADDRLEN
 255

	)

284 
	ssock´Ùo
 {

285 
	m¥_çmy
;

286 
	m¥_´ÙocŞ
;

290 #iâdef 
_STRUCT_SOCKADDR_STORAGE_DECLARED


294 
	#_SS_MAXSIZE
 128U

	)

295 
	#_SS_ALIGNSIZE
 ((
__št64_t
))

	)

296 
	#_SS_PAD1SIZE
 (
_SS_ALIGNSIZE
 - () - \

297 (
§_çmy_t
))

	)

298 
	#_SS_PAD2SIZE
 (
_SS_MAXSIZE
 - () - \

299 (
§_çmy_t
è- 
_SS_PAD1SIZE
 - 
_SS_ALIGNSIZE
)

	)

301 
	ssockaddr_¡Üage
 {

302 
	mss_Ën
;

303 
§_çmy_t
 
	mss_çmy
;

304 
	m__ss_·d1
[
_SS_PAD1SIZE
];

305 
__št64_t
 
	m__ss_®ign
;

306 
	m__ss_·d2
[
_SS_PAD2SIZE
];

308 
	#_STRUCT_SOCKADDR_STORAGE_DECLARED


	)

311 #ià
__BSD_VISIBLE


315 
	#PF_UNSPEC
 
AF_UNSPEC


	)

316 
	#PF_LOCAL
 
AF_LOCAL


	)

317 
	#PF_UNIX
 
PF_LOCAL


	)

318 
	#PF_INET
 
AF_INET


	)

319 
	#PF_IMPLINK
 
AF_IMPLINK


	)

320 
	#PF_PUP
 
AF_PUP


	)

321 
	#PF_CHAOS
 
AF_CHAOS


	)

322 
	#PF_NETBIOS
 
AF_NETBIOS


	)

323 
	#PF_ISO
 
AF_ISO


	)

324 
	#PF_OSI
 
AF_ISO


	)

325 
	#PF_ECMA
 
AF_ECMA


	)

326 
	#PF_DATAKIT
 
AF_DATAKIT


	)

327 
	#PF_CCITT
 
AF_CCITT


	)

328 
	#PF_SNA
 
AF_SNA


	)

329 
	#PF_DECÃt
 
AF_DECÃt


	)

330 
	#PF_DLI
 
AF_DLI


	)

331 
	#PF_LAT
 
AF_LAT


	)

332 
	#PF_HYLINK
 
AF_HYLINK


	)

333 
	#PF_APPLETALK
 
AF_APPLETALK


	)

334 
	#PF_ROUTE
 
AF_ROUTE


	)

335 
	#PF_LINK
 
AF_LINK


	)

336 
	#PF_XTP
 
p£udo_AF_XTP


	)

337 
	#PF_COIP
 
AF_COIP


	)

338 
	#PF_CNT
 
AF_CNT


	)

339 
	#PF_SIP
 
AF_SIP


	)

340 
	#PF_IPX
 
AF_IPX


	)

341 
	#PF_RTIP
 
p£udo_AF_RTIP


	)

342 
	#PF_PIP
 
p£udo_AF_PIP


	)

343 
	#PF_ISDN
 
AF_ISDN


	)

344 
	#PF_KEY
 
p£udo_AF_KEY


	)

345 
	#PF_INET6
 
AF_INET6


	)

346 
	#PF_NATM
 
AF_NATM


	)

347 
	#PF_ATM
 
AF_ATM


	)

348 
	#PF_NETGRAPH
 
AF_NETGRAPH


	)

349 
	#PF_SLOW
 
AF_SLOW


	)

350 
	#PF_SCLUSTER
 
AF_SCLUSTER


	)

351 
	#PF_ARP
 
AF_ARP


	)

352 
	#PF_BLUETOOTH
 
AF_BLUETOOTH


	)

354 
	#PF_MAX
 
AF_MAX


	)

364 
	#NET_MAXID
 
AF_MAX


	)

366 
	#CTL_NET_NAMES
 { \

368 { "unix", 
CTLTYPE_NODE
 }, \

369 { "š‘", 
CTLTYPE_NODE
 }, \

370 { "im¶šk", 
CTLTYPE_NODE
 }, \

371 { "pup", 
CTLTYPE_NODE
 }, \

372 { "chaos", 
CTLTYPE_NODE
 }, \

373 { "x”ox_ns", 
CTLTYPE_NODE
 }, \

374 { "iso", 
CTLTYPE_NODE
 }, \

375 { "emÿ", 
CTLTYPE_NODE
 }, \

376 { "d©ak™", 
CTLTYPE_NODE
 }, \

377 { "cc™t", 
CTLTYPE_NODE
 }, \

378 { "ibm_¢a", 
CTLTYPE_NODE
 }, \

379 { "deú‘", 
CTLTYPE_NODE
 }, \

380 { "dec_dli", 
CTLTYPE_NODE
 }, \

381 { "Ït", 
CTLTYPE_NODE
 }, \

382 { "hylšk", 
CTLTYPE_NODE
 }, \

383 { "­¶‘®k", 
CTLTYPE_NODE
 }, \

384 { "rou‹", 
CTLTYPE_NODE
 }, \

385 { "lšk_Ïy”", 
CTLTYPE_NODE
 }, \

386 { "x", 
CTLTYPE_NODE
 }, \

387 { "co", 
CTLTYPE_NODE
 }, \

388 { "út", 
CTLTYPE_NODE
 }, \

389 { "¹", 
CTLTYPE_NODE
 }, \

390 { "x", 
CTLTYPE_NODE
 }, \

391 { "s", 
CTLTYPE_NODE
 }, \

392 { "p", 
CTLTYPE_NODE
 }, \

393 { "isdn", 
CTLTYPE_NODE
 }, \

394 { "key", 
CTLTYPE_NODE
 }, \

395 { "š‘6", 
CTLTYPE_NODE
 }, \

396 { "Çtm", 
CTLTYPE_NODE
 }, \

397 { "©m", 
CTLTYPE_NODE
 }, \

398 { "hdrcom¶‘e", 
CTLTYPE_NODE
 }, \

399 { "Ãtg¿ph", 
CTLTYPE_NODE
 }, \

400 { "¢p", 
CTLTYPE_NODE
 }, \

401 { "sı", 
CTLTYPE_NODE
 }, \

402 }

	)

412 
	#NET_RT_DUMP
 1

	)

413 
	#NET_RT_FLAGS
 2

	)

414 
	#NET_RT_IFLIST
 3

	)

415 
	#NET_RT_IFMALIST
 4

	)

416 
	#NET_RT_MAXID
 5

	)

418 
	#CTL_NET_RT_NAMES
 { \

420 { "dump", 
CTLTYPE_STRUCT
 }, \

421 { "æags", 
CTLTYPE_STRUCT
 }, \

422 { "iæi¡", 
CTLTYPE_STRUCT
 }, \

423 { "ifm®i¡", 
CTLTYPE_STRUCT
 }, \

424 }

	)

430 
	#SOMAXCONN
 128

	)

436 
	smsghdr
 {

437 *
	mmsg_Çme
;

438 
sockËn_t
 
	mmsg_Çm–’
;

439 
iovec
 *
	mmsg_iov
;

440 
	mmsg_iovËn
;

441 *
	mmsg_cÚŒŞ
;

442 
sockËn_t
 
	mmsg_cÚŒŞËn
;

443 
	mmsg_æags
;

446 
	#MSG_OOB
 0x1

	)

447 
	#MSG_PEEK
 0x2

	)

448 
	#MSG_DONTROUTE
 0x4

	)

449 
	#MSG_EOR
 0x8

	)

450 
	#MSG_TRUNC
 0x10

	)

451 
	#MSG_CTRUNC
 0x20

	)

452 
	#MSG_WAITALL
 0x40

	)

453 
	#MSG_NOTIFICATION
 0x2000

	)

454 #ià
__BSD_VISIBLE


455 
	#MSG_DONTWAIT
 0x80

	)

456 
	#MSG_EOF
 0x100

	)

457 
	#MSG_NBIO
 0x4000

	)

458 
	#MSG_COMPAT
 0x8000

	)

460 #ifdeà
_KERNEL


461 
	#MSG_SOCALLBCK
 0x10000

	)

463 #ià
__BSD_VISIBLE


464 
	#MSG_NOSIGNAL
 0x20000

	)

473 
	scmsghdr
 {

474 
sockËn_t
 
	mcmsg_Ën
;

475 
	mcmsg_Ëv–
;

476 
	mcmsg_ty³
;

480 #ià
__BSD_VISIBLE


486 
	#CMGROUP_MAX
 16

	)

495 
	scmsgüed
 {

496 
pid_t
 
	mcmüed_pid
;

497 
uid_t
 
	mcmüed_uid
;

498 
uid_t
 
	mcmüed_euid
;

499 
gid_t
 
	mcmüed_gid
;

500 
	mcmüed_ngroups
;

501 
gid_t
 
	mcmüed_groups
[
CMGROUP_MAX
];

507 
	ssocküed
 {

508 
uid_t
 
	msc_uid
;

509 
uid_t
 
	msc_euid
;

510 
gid_t
 
	msc_gid
;

511 
gid_t
 
	msc_egid
;

512 
	msc_ngroups
;

513 
gid_t
 
	msc_groups
[1];

519 
	#SOCKCREDSIZE
(
ng½s
) \

520 ((
socküed
è+ ((
gid_t
è* ((
ng½s
è- 1)))

	)

525 
	#CMSG_DATA
(
cmsg
) ((*)(cmsg) + \

526 
	`_ALIGN
((
cmsghdr
)))

	)

529 
	#CMSG_NXTHDR
(
mhdr
, 
cmsg
) \

530 ((*)(
cmsg
è=ğ
NULL
 ? 
	`CMSG_FIRSTHDR
(
mhdr
) : \

531 ((*)(
cmsg
è+ 
	`_ALIGN
(((
cmsghdr
 *)(cmsg))->
cmsg_Ën
) + \

532 
	`_ALIGN
((
cmsghdr
)) > \

533 (*)(
mhdr
)->
msg_cÚŒŞ
 + (mhdr)->
msg_cÚŒŞËn
) ? \

534 (
cmsghdr
 *)0 : \

535 (
cmsghdr
 *)((*)(
cmsg
) + \

536 
	`_ALIGN
(((
cmsghdr
 *)(
cmsg
))->
cmsg_Ën
)))

	)

542 
	#CMSG_FIRSTHDR
(
mhdr
) \

543 ((
mhdr
)->
msg_cÚŒŞËn
 >ğ(
cmsghdr
) ? \

544 (
cmsghdr
 *)(
mhdr
)->
msg_cÚŒŞ
 : \

545 (
cmsghdr
 *)
NULL
)

	)

547 #ià
__BSD_VISIBLE


549 
	#CMSG_SPACE
(
l
è(
	`_ALIGN
((
cmsghdr
)è+ _ALIGNÖ))

	)

550 
	#CMSG_LEN
(
l
è(
	`_ALIGN
((
cmsghdr
)è+ (l))

	)

553 #ifdeà
_KERNEL


554 
	#CMSG_ALIGN
(
n
è
	`_ALIGN
Ò)

	)

558 
	#SCM_RIGHTS
 0x01

	)

559 #ià
__BSD_VISIBLE


560 
	#SCM_TIMESTAMP
 0x02

	)

561 
	#SCM_CREDS
 0x03

	)

562 
	#SCM_BINTIME
 0x04

	)

565 #ià
__BSD_VISIBLE


569 
	sosockaddr
 {

570 
	m§_çmy
;

571 
	m§_d©a
[14];

577 
	somsghdr
 {

578 *
	mmsg_Çme
;

579 
	mmsg_Çm–’
;

580 
iovec
 *
	mmsg_iov
;

581 
	mmsg_iovËn
;

582 *
	mmsg_acüights
;

583 
	mmsg_acüight¦’
;

590 
	#SHUT_RD
 0

	)

591 
	#SHUT_WR
 1

	)

592 
	#SHUT_RDWR
 2

	)

594 #ià
__BSD_VISIBLE


598 
	ssf_hdŒ
 {

599 
iovec
 *
	mh—d”s
;

600 
	mhdr_út
;

601 
iovec
 *
	mŒa”s
;

602 
	mŒl_út
;

608 
	#SF_NODISKIO
 0x00000001

	)

609 
	#SF_MNOWAIT
 0x00000002

	)

612 #iâdef 
_KERNEL


614 
	~<sys/cdefs.h
>

616 
__BEGIN_DECLS


617 
acû±
(, 
sockaddr
 * 
__»¡riù
, 
sockËn_t
 * __restrict);

618 
bšd
(, cÚ¡ 
sockaddr
 *, 
sockËn_t
);

619 
cÚÃù
(, cÚ¡ 
sockaddr
 *, 
sockËn_t
);

620 
g‘³”Çme
(, 
sockaddr
 * 
__»¡riù
, 
sockËn_t
 * __restrict);

621 
g‘sockÇme
(, 
sockaddr
 * 
__»¡riù
, 
sockËn_t
 * __restrict);

622 
g‘sockİt
(, , , * 
__»¡riù
, 
sockËn_t
 * __restrict);

623 
li¡’
(, );

624 
ssize_t
 
»cv
(, *, 
size_t
, );

625 
ssize_t
 
»cväom
(, *, 
size_t
, , 
sockaddr
 * 
__»¡riù
, 
sockËn_t
 * __restrict);

626 
ssize_t
 
»cvmsg
(, 
msghdr
 *, );

627 
ssize_t
 
£nd
(, cÚ¡ *, 
size_t
, );

628 
ssize_t
 
£ndto
(, const *,

629 
size_t
, , cÚ¡ 
sockaddr
 *, 
sockËn_t
);

630 
ssize_t
 
£ndmsg
(, cÚ¡ 
msghdr
 *, );

631 #ià
__BSD_VISIBLE


632 
£ndfe
(, , 
off_t
, 
size_t
, 
sf_hdŒ
 *, off_t *, );

634 
£tsockİt
(, , , cÚ¡ *, 
sockËn_t
);

635 
shutdown
(, );

636 
sock©m¬k
();

637 
sock‘
(, , );

638 
sock‘·œ
(, , , *);

639 
	g__END_DECLS


	@/usr/include/sys/time.h

33 #iâdeà
_SYS_TIME_H_


34 
	#_SYS_TIME_H_


	)

36 
	~<sys/_timev®.h
>

37 
	~<sys/ty³s.h
>

38 
	~<sys/time¥ec.h
>

40 
	stimezÚe
 {

41 
	mtz_mšu‹swe¡
;

42 
	mtz_d¡time
;

44 
	#DST_NONE
 0

	)

45 
	#DST_USA
 1

	)

46 
	#DST_AUST
 2

	)

47 
	#DST_WET
 3

	)

48 
	#DST_MET
 4

	)

49 
	#DST_EET
 5

	)

50 
	#DST_CAN
 6

	)

52 #ià
__BSD_VISIBLE


53 
	sbštime
 {

54 
time_t
 
	m£c
;

55 
ušt64_t
 
	mäac
;

58 
__šlše
 

59 
	$bštime_addx
(
bštime
 *
bt
, 
ušt64_t
 
x
)

61 
ušt64_t
 
u
;

63 
u
 = 
bt
->
äac
;

64 
bt
->
äac
 +ğ
x
;

65 ià(
u
 > 
bt
->
äac
)

66 
bt
->
£c
++;

67 
	}
}

69 
__šlše
 

70 
	$bštime_add
(
bštime
 *
bt
, cÚ¡ bštim*
bt2
)

72 
ušt64_t
 
u
;

74 
u
 = 
bt
->
äac
;

75 
bt
->
äac
 +ğ
bt2
->frac;

76 ià(
u
 > 
bt
->
äac
)

77 
bt
->
£c
++;

78 
bt
->
£c
 +ğ
bt2
->sec;

79 
	}
}

81 
__šlše
 

82 
	$bštime_sub
(
bštime
 *
bt
, cÚ¡ bštim*
bt2
)

84 
ušt64_t
 
u
;

86 
u
 = 
bt
->
äac
;

87 
bt
->
äac
 -ğ
bt2
->frac;

88 ià(
u
 < 
bt
->
äac
)

89 
bt
->
£c
--;

90 
bt
->
£c
 -ğ
bt2
->sec;

91 
	}
}

107 
__šlše
 

108 
	$bštime2time¥ec
(cÚ¡ 
bštime
 *
bt
, 
time¥ec
 *
ts
)

111 
ts
->
tv_£c
 = 
bt
->
£c
;

112 
ts
->
tv_n£c
 = ((
ušt64_t
)1000000000 * (
ušt32_t
)(
bt
->
äac
 >> 32)) >> 32;

113 
	}
}

115 
__šlše
 

116 
	$time¥ec2bštime
(cÚ¡ 
time¥ec
 *
ts
, 
bštime
 *
bt
)

119 
bt
->
£c
 = 
ts
->
tv_£c
;

121 
bt
->
äac
 = 
ts
->
tv_n£c
 * (
ušt64_t
)18446744073LL;

122 
	}
}

124 
__šlše
 

125 
	$bštime2timev®
(cÚ¡ 
bštime
 *
bt
, 
timev®
 *
tv
)

128 
tv
->
tv_£c
 = 
bt
->
£c
;

129 
tv
->
tv_u£c
 = ((
ušt64_t
)1000000 * (
ušt32_t
)(
bt
->
äac
 >> 32)) >> 32;

130 
	}
}

132 
__šlše
 

133 
	$timev®2bštime
(cÚ¡ 
timev®
 *
tv
, 
bštime
 *
bt
)

136 
bt
->
£c
 = 
tv
->
tv_£c
;

138 
bt
->
äac
 = 
tv
->
tv_u£c
 * (
ušt64_t
)18446744073709LL;

139 
	}
}

142 #ifdeà
_KERNEL


145 
	#time¥ecş—r
(
tvp
è(Ñvp)->
tv_£c
 = (tvp)->
tv_n£c
 = 0)

	)

146 
	#time¥ecis£t
(
tvp
è(Ñvp)->
tv_£c
 || (tvp)->
tv_n£c
)

	)

147 
	#time¥eccmp
(
tvp
, 
uvp
, 
cmp
) \

148 (((
tvp
)->
tv_£c
 =ğ(
uvp
)->tv_sec) ? \

149 ((
tvp
)->
tv_n£c
 
	`cmp
 (
uvp
)->tv_nsec) : \

150 ((
tvp
)->
tv_£c
 
	`cmp
 (
uvp
)->tv_£c))

	)

151 
	#time¥eÿdd
(
vvp
, 
uvp
) \

153 (
vvp
)->
tv_£c
 +ğ(
uvp
)->tv_sec; \

154 (
vvp
)->
tv_n£c
 +ğ(
uvp
)->tv_nsec; \

155 ià((
vvp
)->
tv_n£c
 >= 1000000000) { \

156 (
vvp
)->
tv_£c
++; \

157 (
vvp
)->
tv_n£c
 -= 1000000000; \

159 } 0)

	)

160 
	#time¥ecsub
(
vvp
, 
uvp
) \

162 (
vvp
)->
tv_£c
 -ğ(
uvp
)->tv_sec; \

163 (
vvp
)->
tv_n£c
 -ğ(
uvp
)->tv_nsec; \

164 ià((
vvp
)->
tv_n£c
 < 0) { \

165 (
vvp
)->
tv_£c
--; \

166 (
vvp
)->
tv_n£c
 += 1000000000; \

168 } 0)

	)

172 
	#timev®ş—r
(
tvp
è(Ñvp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0)

	)

173 
	#timev®is£t
(
tvp
è(Ñvp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

174 
	#timev®cmp
(
tvp
, 
uvp
, 
cmp
) \

175 (((
tvp
)->
tv_£c
 =ğ(
uvp
)->tv_sec) ? \

176 ((
tvp
)->
tv_u£c
 
	`cmp
 (
uvp
)->tv_usec) : \

177 ((
tvp
)->
tv_£c
 
	`cmp
 (
uvp
)->tv_£c))

	)

183 #iâdeà
_KERNEL


185 
	#tim”ş—r
(
tvp
è(Ñvp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0)

	)

186 
	#tim”is£t
(
tvp
è(Ñvp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

187 
	#tim”cmp
(
tvp
, 
uvp
, 
cmp
) \

188 (((
tvp
)->
tv_£c
 =ğ(
uvp
)->tv_sec) ? \

189 ((
tvp
)->
tv_u£c
 
	`cmp
 (
uvp
)->tv_usec) : \

190 ((
tvp
)->
tv_£c
 
	`cmp
 (
uvp
)->tv_£c))

	)

191 
	#tim”add
(
tvp
, 
uvp
, 
vvp
) \

193 (
vvp
)->
tv_£c
 = (
tvp
)->tv_£ø+ (
uvp
)->tv_sec; \

194 (
vvp
)->
tv_u£c
 = (
tvp
)->tv_u£ø+ (
uvp
)->tv_usec; \

195 ià((
vvp
)->
tv_u£c
 >= 1000000) { \

196 (
vvp
)->
tv_£c
++; \

197 (
vvp
)->
tv_u£c
 -= 1000000; \

199 } 0)

	)

200 
	#tim”sub
(
tvp
, 
uvp
, 
vvp
) \

202 (
vvp
)->
tv_£c
 = (
tvp
)->tv_£ø- (
uvp
)->tv_sec; \

203 (
vvp
)->
tv_u£c
 = (
tvp
)->tv_u£ø- (
uvp
)->tv_usec; \

204 ià((
vvp
)->
tv_u£c
 < 0) { \

205 (
vvp
)->
tv_£c
--; \

206 (
vvp
)->
tv_u£c
 += 1000000; \

208 } 0)

	)

215 
	#ITIMER_REAL
 0

	)

216 
	#ITIMER_VIRTUAL
 1

	)

217 
	#ITIMER_PROF
 2

	)

219 
	s™im”v®
 {

220 
timev®
 
	m™_š‹rv®
;

221 
timev®
 
	m™_v®ue
;

227 
	sşockšfo
 {

228 
	mhz
;

229 
	mtick
;

230 
	m¥¬e
;

231 
	m¡©hz
;

232 
	m´ofhz
;

236 #iâdeà
CLOCK_REALTIME


237 
	#CLOCK_REALTIME
 0

	)

238 
	#CLOCK_VIRTUAL
 1

	)

239 
	#CLOCK_PROF
 2

	)

240 
	#CLOCK_MONOTONIC
 4

	)

241 
	#CLOCK_UPTIME
 5

	)

242 
	#CLOCK_UPTIME_PRECISE
 7

	)

243 
	#CLOCK_UPTIME_FAST
 8

	)

244 
	#CLOCK_REALTIME_PRECISE
 9

	)

245 
	#CLOCK_REALTIME_FAST
 10

	)

246 
	#CLOCK_MONOTONIC_PRECISE
 11

	)

247 
	#CLOCK_MONOTONIC_FAST
 12

	)

248 
	#CLOCK_SECOND
 13

	)

251 #iâdeà
TIMER_ABSTIME


252 
	#TIMER_RELTIME
 0x0

	)

253 
	#TIMER_ABSTIME
 0x1

	)

256 #ifdeà
_KERNEL


257 
time_t
 
time_£cÚd
;

258 
time_t
 
time_u±ime
;

259 
timev®
 
boÙtime
;

283 
bšu±ime
(
bštime
 *
bt
);

284 
Çnou±ime
(
time¥ec
 *
t¥
);

285 
miüou±ime
(
timev®
 *
tvp
);

287 
bštime
(bštim*
bt
);

288 
ÇnÙime
(
time¥ec
 *
t¥
);

289 
miüÙime
(
timev®
 *
tvp
);

291 
g‘bšu±ime
(
bštime
 *
bt
);

292 
g‘Çnou±ime
(
time¥ec
 *
t¥
);

293 
g‘miüou±ime
(
timev®
 *
tvp
);

295 
g‘bštime
(
bštime
 *
bt
);

296 
g‘ÇnÙime
(
time¥ec
 *
t¥
);

297 
g‘miüÙime
(
timev®
 *
tvp
);

300 
™im”deü
(
™im”v®
 *
™p
, 
u£c
);

301 
™im”fix
(
timev®
 *
tv
);

302 
µ¤©echeck
(
timev®
 *, *, );

303 
¿‹check
(
timev®
 *, const timeval *);

304 
timev®add
(
timev®
 *
t1
, cÚ¡ timev® *
t2
);

305 
timev®sub
(
timev®
 *
t1
, cÚ¡ timev® *
t2
);

306 
tvtohz
(
timev®
 *
tv
);

307 
ušt64_t
 
dŒaû_g‘h¹ime
();

308 
ušt64_t
 
dŒaû_g‘h»¡ime
();

310 
	~<time.h
>

312 
	~<sys/cdefs.h
>

314 
__BEGIN_DECLS


315 
adjtime
(cÚ¡ 
timev®
 *, timeval *);

316 
futimes
(, cÚ¡ 
timev®
 *);

317 
g‘™im”
(, 
™im”v®
 *);

318 
g‘timeofday
(
timev®
 *, 
timezÚe
 *);

319 
lutimes
(cÚ¡ *, cÚ¡ 
timev®
 *);

320 
£t™im”
(, cÚ¡ 
™im”v®
 *, itimerval *);

321 
£‰imeofday
(cÚ¡ 
timev®
 *, cÚ¡ 
timezÚe
 *);

322 
utimes
(cÚ¡ *, cÚ¡ 
timev®
 *);

323 
	g__END_DECLS


330 #ifdeà
_SOLARIS_C_SOURCE


334 
	#SEC
 1

	)

335 
	#MILLISEC
 1000

	)

336 
	#MICROSEC
 1000000

	)

337 
	#NANOSEC
 1000000000

	)

339 
lÚglÚg_t
 
	th¹ime_t
;

341 #iâdeà
_KERNEL


342 
__šlše
 
h¹ime_t
 
	$g‘h¹ime
() {

343 
time¥ec
 
ts
;

344 
	`şock_g‘time
(
CLOCK_UPTIME
,&
ts
);

345  (((
u_št64_t
è
ts
.
tv_£c
è* 
NANOSEC
 +s.
tv_n£c
);

346 
	}
}

	@/usr/include/sys/types.h

38 #iâdeà
_SYS_TYPES_H_


39 
	#_SYS_TYPES_H_


	)

41 
	~<sys/cdefs.h
>

44 
	~<machše/’dŸn.h
>

45 
	~<sys/_ty³s.h
>

47 
	~<sys/_±h»adty³s.h
>

49 #ià
__BSD_VISIBLE


50 
	tu_ch¬
;

51 
	tu_shÜt
;

52 
	tu_št
;

53 
	tu_lÚg
;

54 #iâdeà
_KERNEL


55 
	tushÜt
;

56 
	tušt
;

63 #iâdeà
_INT8_T_DECLARED


64 
__št8_t
 
	tšt8_t
;

65 
	#_INT8_T_DECLARED


	)

68 #iâdeà
_INT16_T_DECLARED


69 
__št16_t
 
	tšt16_t
;

70 
	#_INT16_T_DECLARED


	)

73 #iâdeà
_INT32_T_DECLARED


74 
__št32_t
 
	tšt32_t
;

75 
	#_INT32_T_DECLARED


	)

78 #iâdeà
_INT64_T_DECLARED


79 
__št64_t
 
	tšt64_t
;

80 
	#_INT64_T_DECLARED


	)

83 #iâdeà
_UINT8_T_DECLARED


84 
__ušt8_t
 
	tušt8_t
;

85 
	#_UINT8_T_DECLARED


	)

88 #iâdeà
_UINT16_T_DECLARED


89 
__ušt16_t
 
	tušt16_t
;

90 
	#_UINT16_T_DECLARED


	)

93 #iâdeà
_UINT32_T_DECLARED


94 
__ušt32_t
 
	tušt32_t
;

95 
	#_UINT32_T_DECLARED


	)

98 #iâdeà
_UINT64_T_DECLARED


99 
__ušt64_t
 
	tušt64_t
;

100 
	#_UINT64_T_DECLARED


	)

103 #iâdeà
_INTPTR_T_DECLARED


104 
__šŒ_t
 
	tšŒ_t
;

105 
__ušŒ_t
 
	tušŒ_t
;

106 
	#_INTPTR_T_DECLARED


	)

109 
__ušt8_t
 
	tu_št8_t
;

110 
__ušt16_t
 
	tu_št16_t
;

111 
__ušt32_t
 
	tu_št32_t
;

112 
__ušt64_t
 
	tu_št64_t
;

114 
__ušt64_t
 
	tu_quad_t
;

115 
__št64_t
 
	tquad_t
;

116 
quad_t
 * 
	tqaddr_t
;

118 * 
	tÿddr_t
;

119 
__cÚ¡
 * 
	tc_ÿddr_t
;

120 
__vŞ©e
 *
	tv_ÿddr_t
;

122 #iâdeà
_BLKSIZE_T_DECLARED


123 
__blksize_t
 
	tblksize_t
;

124 
	#_BLKSIZE_T_DECLARED


	)

127 #iâdeà
_BLKCNT_T_DECLARED


128 
__blkút_t
 
	tblkút_t
;

129 
	#_BLKCNT_T_DECLARED


	)

132 #iâdeà
_CLOCK_T_DECLARED


133 
__şock_t
 
	tşock_t
;

134 
	#_CLOCK_T_DECLARED


	)

137 #iâdeà
_CLOCKID_T_DECLARED


138 
__şockid_t
 
	tşockid_t
;

139 
	#_CLOCKID_T_DECLARED


	)

142 
__ü™iÿl_t
 
	tü™iÿl_t
;

143 
__št64_t
 
	tdaddr_t
;

145 #iâdeà
_DEV_T_DECLARED


146 
__dev_t
 
	tdev_t
;

147 
	#_DEV_T_DECLARED


	)

150 #iâdeà
_FFLAGS_T_DECLARED


151 
__fæags_t
 
	tfæags_t
;

152 
	#_FFLAGS_T_DECLARED


	)

155 
__fix±_t
 
	tfix±_t
;

157 #iâdeà
_FSBLKCNT_T_DECLARED


158 
__fsblkút_t
 
	tfsblkút_t
;

159 
__fsfút_t
 
	tfsfút_t
;

160 
	#_FSBLKCNT_T_DECLARED


	)

163 #iâdeà
_GID_T_DECLARED


164 
__gid_t
 
	tgid_t
;

165 
	#_GID_T_DECLARED


	)

168 #iâdeà
_IN_ADDR_T_DECLARED


169 
__ušt32_t
 
	tš_addr_t
;

170 
	#_IN_ADDR_T_DECLARED


	)

173 #iâdeà
_IN_PORT_T_DECLARED


174 
__ušt16_t
 
	tš_pÜt_t
;

175 
	#_IN_PORT_T_DECLARED


	)

178 #iâdeà
_ID_T_DECLARED


179 
__id_t
 
	tid_t
;

180 
	#_ID_T_DECLARED


	)

183 #iâdeà
_INO_T_DECLARED


184 
__šo_t
 
	tšo_t
;

185 
	#_INO_T_DECLARED


	)

188 #iâdeà
_KEY_T_DECLARED


189 
__key_t
 
	tkey_t
;

190 
	#_KEY_T_DECLARED


	)

193 #iâdeà
_LWPID_T_DECLARED


194 
__lwpid_t
 
	tlwpid_t
;

195 
	#_LWPID_T_DECLARED


	)

198 #iâdeà
_MODE_T_DECLARED


199 
__mode_t
 
	tmode_t
;

200 
	#_MODE_T_DECLARED


	)

203 #iâdeà
_NLINK_T_DECLARED


204 
__Æšk_t
 
	tÆšk_t
;

205 
	#_NLINK_T_DECLARED


	)

208 #iâdeà
_OFF_T_DECLARED


209 
__off_t
 
	toff_t
;

210 
	#_OFF_T_DECLARED


	)

213 #iâdeà
_PID_T_DECLARED


214 
__pid_t
 
	tpid_t
;

215 
	#_PID_T_DECLARED


	)

218 
__»gi¡”_t
 
	t»gi¡”_t
;

220 #iâdeà
_RLIM_T_DECLARED


221 
__¾im_t
 
	t¾im_t
;

222 
	#_RLIM_T_DECLARED


	)

225 
__£gsz_t
 
	t£gsz_t
;

227 #iâdeà
_SIZE_T_DECLARED


228 
__size_t
 
	tsize_t
;

229 
	#_SIZE_T_DECLARED


	)

232 #iâdeà
_SSIZE_T_DECLARED


233 
__ssize_t
 
	tssize_t
;

234 
	#_SSIZE_T_DECLARED


	)

237 #iâdeà
_SUSECONDS_T_DECLARED


238 
__su£cÚds_t
 
	tsu£cÚds_t
;

239 
	#_SUSECONDS_T_DECLARED


	)

242 #iâdeà
_TIME_T_DECLARED


243 
__time_t
 
	ttime_t
;

244 
	#_TIME_T_DECLARED


	)

247 #iâdeà
_TIMER_T_DECLARED


248 
__tim”_t
 
	ttim”_t
;

249 
	#_TIMER_T_DECLARED


	)

252 #iâdeà
_MQD_T_DECLARED


253 
__mqd_t
 
	tmqd_t
;

254 
	#_MQD_T_DECLARED


	)

257 
__u_»gi¡”_t
 
	tu_»gi¡”_t
;

259 #iâdeà
_UID_T_DECLARED


260 
__uid_t
 
	tuid_t
;

261 
	#_UID_T_DECLARED


	)

264 #iâdeà
_USECONDS_T_DECLARED


265 
__u£cÚds_t
 
	tu£cÚds_t
;

266 
	#_USECONDS_T_DECLARED


	)

269 
__vm_off£t_t
 
	tvm_off£t_t
;

270 
__vm_ooff£t_t
 
	tvm_ooff£t_t
;

271 
__vm_·ddr_t
 
	tvm_·ddr_t
;

272 
__vm_pšdex_t
 
	tvm_pšdex_t
;

273 
__vm_size_t
 
	tvm_size_t
;

275 #ifdeà
_KERNEL


276 
	tboŞ—n_t
;

277 
__ıumask_t
 
	tıumask_t
;

278 
deviû
 *
	tdeviû_t
;

279 
__štåŒ_t
 
	tštåŒ_t
;

289 
__ušt32_t
 
	tšŒmask_t
;

291 
__uštåŒ_t
 
	tuštåŒ_t
;

292 
__ušt64_t
 
	tuoff_t
;

293 
vm_·ge
 *
	tvm_·ge_t
;

295 
	#off£tof
(
ty³
, 
f›ld
è
	`__off£tof
Ñy³, f›ld)

	)

302 #ifdeà
_SOLARIS_C_SOURCE


303 
u_št
 
	tušt_t
;

304 
u_ch¬
 
	tuch¬_t
;

305 
u_shÜt
 
	tushÜt_t
;

306 
u_lÚg
 
	tulÚg_t
;

308 
	tlÚglÚg_t
;

309 
	tu_lÚglÚg_t
;

311 
off_t
 
	toff64_t
;

313 
id_t
 
	tskid_t
;

314 
id_t
 
	t´ojid_t
;

315 
id_t
 
	tpoŞid_t
;

316 
id_t
 
	tzÚeid_t
;

317 
id_t
 
	tùid_t
;

319 #iâdeà
_KERNEL


320 #ià
defšed
(
__XOPEN_OR_POSIX
)

321 ’um { 
	m_B_FALSE
, 
	m_B_TRUE
 } 
	tboŞ—n_t
;

323 ’um { 
	mB_FALSE
, 
	mB_TRUE
 } 
	tboŞ—n_t
;

333 #ià
__BSD_VISIBLE


335 
	~<sys/£Ëù.h
>

337 #iâdeà
_KERNEL


343 
	#majÜ
(
x
è(()(((
u_št
)(xè>> 8)&0xff)è

	)

344 
	#mšÜ
(
x
è(()((x)&0xffff00ff)è

	)

347 
	#makedev
(
x
,
y
è((
dev_t
)(((xè<< 8è| (y))è

	)

354 #iâdeà
_KERNEL


355 
	g__BEGIN_DECLS


356 #iâdeà
_FTRUNCATE_DECLARED


357 
	#_FTRUNCATE_DECLARED


	)

358 
árunÿ‹
(, 
off_t
);

360 #iâdeà
_LSEEK_DECLARED


361 
	#_LSEEK_DECLARED


	)

362 
off_t
 
l£ek
(, off_t, );

364 #iâdeà
_MMAP_DECLARED


365 
	#_MMAP_DECLARED


	)

366 * 
mm­
(*, 
size_t
, , , , 
off_t
);

368 #iâdeà
_TRUNCATE_DECLARED


369 
	#_TRUNCATE_DECLARED


	)

370 
Œunÿ‹
(cÚ¡ *, 
off_t
);

372 
	g__END_DECLS


	@/usr/include/unistd.h

37 #iâdeà
_UNISTD_H_


38 
	#_UNISTD_H_


	)

40 
	~<sys/cdefs.h
>

41 
	~<sys/ty³s.h
>

42 
	~<sys/uni¡d.h
>

43 
	~<sys/_nuÎ.h
>

44 
	~<sys/_ty³s.h
>

46 #iâdeà
_GID_T_DECLARED


47 
__gid_t
 
	tgid_t
;

48 
	#_GID_T_DECLARED


	)

51 #iâdeà
_OFF_T_DECLARED


52 
__off_t
 
	toff_t
;

53 
	#_OFF_T_DECLARED


	)

56 #iâdeà
_PID_T_DECLARED


57 
__pid_t
 
	tpid_t
;

58 
	#_PID_T_DECLARED


	)

61 #iâdeà
_SIZE_T_DECLARED


62 
__size_t
 
	tsize_t
;

63 
	#_SIZE_T_DECLARED


	)

66 #iâdeà
_SSIZE_T_DECLARED


67 
__ssize_t
 
	tssize_t
;

68 
	#_SSIZE_T_DECLARED


	)

71 #iâdeà
_UID_T_DECLARED


72 
__uid_t
 
	tuid_t
;

73 
	#_UID_T_DECLARED


	)

76 #iâdeà
_USECONDS_T_DECLARED


77 
__u£cÚds_t
 
	tu£cÚds_t
;

78 
	#_USECONDS_T_DECLARED


	)

81 
	#STDIN_FILENO
 0

	)

82 
	#STDOUT_FILENO
 1

	)

83 
	#STDERR_FILENO
 2

	)

85 #ià
__XSI_VISIBLE
 || 
__POSIX_VISIBLE
 >= 200112

86 
	#F_ULOCK
 0

	)

87 
	#F_LOCK
 1

	)

88 
	#F_TLOCK
 2

	)

89 
	#F_TEST
 3

	)

106 
	#_POSIX_BARRIERS
 200112L

	)

107 
	#_POSIX_READER_WRITER_LOCKS
 200112L

	)

108 
	#_POSIX_REGEXP
 1

	)

109 
	#_POSIX_SHELL
 1

	)

110 
	#_POSIX_SPAWN
 -1

	)

111 
	#_POSIX_SPIN_LOCKS
 200112L

	)

112 
	#_POSIX_THREAD_ATTR_STACKADDR
 200112L

	)

113 
	#_POSIX_THREAD_ATTR_STACKSIZE
 200112L

	)

114 
	#_POSIX_THREAD_CPUTIME
 -1

	)

115 
	#_POSIX_THREAD_PRIO_INHERIT
 200112L

	)

116 
	#_POSIX_THREAD_PRIO_PROTECT
 200112L

	)

117 
	#_POSIX_THREAD_PRIORITY_SCHEDULING
 200112L

	)

118 
	#_POSIX_THREAD_PROCESS_SHARED
 -1

	)

119 
	#_POSIX_THREAD_SAFE_FUNCTIONS
 -1

	)

120 
	#_POSIX_THREAD_SPORADIC_SERVER
 -1

	)

121 
	#_POSIX_THREADS
 200112L

	)

122 
	#_POSIX_TRACE
 -1

	)

123 
	#_POSIX_TRACE_EVENT_FILTER
 -1

	)

124 
	#_POSIX_TRACE_INHERIT
 -1

	)

125 
	#_POSIX_TRACE_LOG
 -1

	)

126 
	#_POSIX2_C_BIND
 200112L

	)

127 
	#_POSIX2_C_DEV
 -1

	)

128 
	#_POSIX2_CHAR_TERM
 1

	)

129 
	#_POSIX2_FORT_DEV
 -1

	)

130 
	#_POSIX2_FORT_RUN
 200112L

	)

131 
	#_POSIX2_LOCALEDEF
 -1

	)

132 
	#_POSIX2_PBS
 -1

	)

133 
	#_POSIX2_PBS_ACCOUNTING
 -1

	)

134 
	#_POSIX2_PBS_CHECKPOINT
 -1

	)

135 
	#_POSIX2_PBS_LOCATE
 -1

	)

136 
	#_POSIX2_PBS_MESSAGE
 -1

	)

137 
	#_POSIX2_PBS_TRACK
 -1

	)

138 
	#_POSIX2_SW_DEV
 -1

	)

139 
	#_POSIX2_UPE
 200112L

	)

140 
	#_V6_ILP32_OFF32
 -1

	)

141 
	#_V6_ILP32_OFFBIG
 0

	)

142 
	#_V6_LP64_OFF64
 0

	)

143 
	#_V6_LPBIG_OFFBIG
 -1

	)

145 #ià
__XSI_VISIBLE


146 
	#_XOPEN_CRYPT
 -1

	)

147 
	#_XOPEN_ENH_I18N
 -1

	)

148 
	#_XOPEN_LEGACY
 -1

	)

149 
	#_XOPEN_REALTIME
 -1

	)

150 
	#_XOPEN_REALTIME_THREADS
 -1

	)

151 
	#_XOPEN_UNIX
 -1

	)

155 
	#_POSIX2_VERSION
 199212L

	)

166 
	#_SC_ARG_MAX
 1

	)

167 
	#_SC_CHILD_MAX
 2

	)

168 
	#_SC_CLK_TCK
 3

	)

169 
	#_SC_NGROUPS_MAX
 4

	)

170 
	#_SC_OPEN_MAX
 5

	)

171 
	#_SC_JOB_CONTROL
 6

	)

172 
	#_SC_SAVED_IDS
 7

	)

173 
	#_SC_VERSION
 8

	)

174 
	#_SC_BC_BASE_MAX
 9

	)

175 
	#_SC_BC_DIM_MAX
 10

	)

176 
	#_SC_BC_SCALE_MAX
 11

	)

177 
	#_SC_BC_STRING_MAX
 12

	)

178 
	#_SC_COLL_WEIGHTS_MAX
 13

	)

179 
	#_SC_EXPR_NEST_MAX
 14

	)

180 
	#_SC_LINE_MAX
 15

	)

181 
	#_SC_RE_DUP_MAX
 16

	)

182 
	#_SC_2_VERSION
 17

	)

183 
	#_SC_2_C_BIND
 18

	)

184 
	#_SC_2_C_DEV
 19

	)

185 
	#_SC_2_CHAR_TERM
 20

	)

186 
	#_SC_2_FORT_DEV
 21

	)

187 
	#_SC_2_FORT_RUN
 22

	)

188 
	#_SC_2_LOCALEDEF
 23

	)

189 
	#_SC_2_SW_DEV
 24

	)

190 
	#_SC_2_UPE
 25

	)

191 
	#_SC_STREAM_MAX
 26

	)

192 
	#_SC_TZNAME_MAX
 27

	)

194 #ià
__POSIX_VISIBLE
 >= 199309

195 
	#_SC_ASYNCHRONOUS_IO
 28

	)

196 
	#_SC_MAPPED_FILES
 29

	)

197 
	#_SC_MEMLOCK
 30

	)

198 
	#_SC_MEMLOCK_RANGE
 31

	)

199 
	#_SC_MEMORY_PROTECTION
 32

	)

200 
	#_SC_MESSAGE_PASSING
 33

	)

201 
	#_SC_PRIORITIZED_IO
 34

	)

202 
	#_SC_PRIORITY_SCHEDULING
 35

	)

203 
	#_SC_REALTIME_SIGNALS
 36

	)

204 
	#_SC_SEMAPHORES
 37

	)

205 
	#_SC_FSYNC
 38

	)

206 
	#_SC_SHARED_MEMORY_OBJECTS
 39

	)

207 
	#_SC_SYNCHRONIZED_IO
 40

	)

208 
	#_SC_TIMERS
 41

	)

209 
	#_SC_AIO_LISTIO_MAX
 42

	)

210 
	#_SC_AIO_MAX
 43

	)

211 
	#_SC_AIO_PRIO_DELTA_MAX
 44

	)

212 
	#_SC_DELAYTIMER_MAX
 45

	)

213 
	#_SC_MQ_OPEN_MAX
 46

	)

214 
	#_SC_PAGESIZE
 47

	)

215 
	#_SC_RTSIG_MAX
 48

	)

216 
	#_SC_SEM_NSEMS_MAX
 49

	)

217 
	#_SC_SEM_VALUE_MAX
 50

	)

218 
	#_SC_SIGQUEUE_MAX
 51

	)

219 
	#_SC_TIMER_MAX
 52

	)

222 #ià
__POSIX_VISIBLE
 >= 200112

223 
	#_SC_2_PBS
 59

	)

224 
	#_SC_2_PBS_ACCOUNTING
 60

	)

225 
	#_SC_2_PBS_CHECKPOINT
 61

	)

226 
	#_SC_2_PBS_LOCATE
 62

	)

227 
	#_SC_2_PBS_MESSAGE
 63

	)

228 
	#_SC_2_PBS_TRACK
 64

	)

229 
	#_SC_ADVISORY_INFO
 65

	)

230 
	#_SC_BARRIERS
 66

	)

231 
	#_SC_CLOCK_SELECTION
 67

	)

232 
	#_SC_CPUTIME
 68

	)

233 
	#_SC_FILE_LOCKING
 69

	)

234 
	#_SC_GETGR_R_SIZE_MAX
 70

	)

235 
	#_SC_GETPW_R_SIZE_MAX
 71

	)

236 
	#_SC_HOST_NAME_MAX
 72

	)

237 
	#_SC_LOGIN_NAME_MAX
 73

	)

238 
	#_SC_MONOTONIC_CLOCK
 74

	)

239 
	#_SC_MQ_PRIO_MAX
 75

	)

240 
	#_SC_READER_WRITER_LOCKS
 76

	)

241 
	#_SC_REGEXP
 77

	)

242 
	#_SC_SHELL
 78

	)

243 
	#_SC_SPAWN
 79

	)

244 
	#_SC_SPIN_LOCKS
 80

	)

245 
	#_SC_SPORADIC_SERVER
 81

	)

246 
	#_SC_THREAD_ATTR_STACKADDR
 82

	)

247 
	#_SC_THREAD_ATTR_STACKSIZE
 83

	)

248 
	#_SC_THREAD_CPUTIME
 84

	)

249 
	#_SC_THREAD_DESTRUCTOR_ITERATIONS
 85

	)

250 
	#_SC_THREAD_KEYS_MAX
 86

	)

251 
	#_SC_THREAD_PRIO_INHERIT
 87

	)

252 
	#_SC_THREAD_PRIO_PROTECT
 88

	)

253 
	#_SC_THREAD_PRIORITY_SCHEDULING
 89

	)

254 
	#_SC_THREAD_PROCESS_SHARED
 90

	)

255 
	#_SC_THREAD_SAFE_FUNCTIONS
 91

	)

256 
	#_SC_THREAD_SPORADIC_SERVER
 92

	)

257 
	#_SC_THREAD_STACK_MIN
 93

	)

258 
	#_SC_THREAD_THREADS_MAX
 94

	)

259 
	#_SC_TIMEOUTS
 95

	)

260 
	#_SC_THREADS
 96

	)

261 
	#_SC_TRACE
 97

	)

262 
	#_SC_TRACE_EVENT_FILTER
 98

	)

263 
	#_SC_TRACE_INHERIT
 99

	)

264 
	#_SC_TRACE_LOG
 100

	)

265 
	#_SC_TTY_NAME_MAX
 101

	)

266 
	#_SC_TYPED_MEMORY_OBJECTS
 102

	)

267 
	#_SC_V6_ILP32_OFF32
 103

	)

268 
	#_SC_V6_ILP32_OFFBIG
 104

	)

269 
	#_SC_V6_LP64_OFF64
 105

	)

270 
	#_SC_V6_LPBIG_OFFBIG
 106

	)

271 
	#_SC_IPV6
 118

	)

272 
	#_SC_RAW_SOCKETS
 119

	)

273 
	#_SC_SYMLOOP_MAX
 120

	)

276 #ià
__XSI_VISIBLE


277 
	#_SC_ATEXIT_MAX
 107

	)

278 
	#_SC_IOV_MAX
 56

	)

279 
	#_SC_PAGE_SIZE
 
_SC_PAGESIZE


	)

280 
	#_SC_XOPEN_CRYPT
 108

	)

281 
	#_SC_XOPEN_ENH_I18N
 109

	)

282 
	#_SC_XOPEN_LEGACY
 110

	)

283 
	#_SC_XOPEN_REALTIME
 111

	)

284 
	#_SC_XOPEN_REALTIME_THREADS
 112

	)

285 
	#_SC_XOPEN_SHM
 113

	)

286 
	#_SC_XOPEN_STREAMS
 114

	)

287 
	#_SC_XOPEN_UNIX
 115

	)

288 
	#_SC_XOPEN_VERSION
 116

	)

289 
	#_SC_XOPEN_XCU_VERSION
 117

	)

292 #ià
__BSD_VISIBLE


293 
	#_SC_NPROCESSORS_CONF
 57

	)

294 
	#_SC_NPROCESSORS_ONLN
 58

	)

298 
	#_SC_PHYS_PAGES
 121

	)

301 #ià
__POSIX_VISIBLE
 >= 199209

302 
	#_CS_PATH
 1

	)

305 #ià
__POSIX_VISIBLE
 >= 200112

306 
	#_CS_POSIX_V6_ILP32_OFF32_CFLAGS
 2

	)

307 
	#_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
 3

	)

308 
	#_CS_POSIX_V6_ILP32_OFF32_LIBS
 4

	)

309 
	#_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
 5

	)

310 
	#_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
 6

	)

311 
	#_CS_POSIX_V6_ILP32_OFFBIG_LIBS
 7

	)

312 
	#_CS_POSIX_V6_LP64_OFF64_CFLAGS
 8

	)

313 
	#_CS_POSIX_V6_LP64_OFF64_LDFLAGS
 9

	)

314 
	#_CS_POSIX_V6_LP64_OFF64_LIBS
 10

	)

315 
	#_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
 11

	)

316 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
 12

	)

317 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
 13

	)

318 
	#_CS_POSIX_V6_WIDTH_RESTRICTED_ENVS
 14

	)

321 
__BEGIN_DECLS


323 
	$_ex™
(è
__d—d2
;

324 
	`acûss
(const *, );

325 
	`®¬m
();

326 
	`chdœ
(const *);

327 
	`chown
(cÚ¡ *, 
uid_t
, 
gid_t
);

328 
	`şo£
();

329 
	`dup
();

330 
	`dup2
(, );

331 
	`—cûss
(const *, );

332 
	`exeş
(const *, const *, ...);

333 
	`exeşe
(const *, const *, ...);

334 
	`exeşp
(const *, const *, ...);

335 
	`execv
(const *, * const *);

336 
	`execve
(const *, * const *, * const *);

337 
	`execvp
(const *, * const *);

338 
pid_t
 
	`fÜk
();

339 
	`å©hcÚf
(, );

340 *
	`g‘cwd
(*, 
size_t
);

341 
gid_t
 
	`g‘egid
();

342 
uid_t
 
	`g‘euid
();

343 
gid_t
 
	`g‘gid
();

344 
	`g‘groups
(, 
gid_t
 []);

345 *
	`g‘logš
();

346 
pid_t
 
	`g‘pg½
();

347 
pid_t
 
	`g‘pid
();

348 
pid_t
 
	`g‘µid
();

349 
uid_t
 
	`g‘uid
();

350 
	`i§‰y
();

351 
	`lšk
(const *, const *);

352 #iâdeà
_LSEEK_DECLARED


353 
	#_LSEEK_DECLARED


	)

354 
off_t
 
	`l£ek
(, off_t, );

356 
	`·thcÚf
(const *, );

357 
	`·u£
();

358 
	`pe
(*);

359 
ssize_t
 
	`»ad
(, *, 
size_t
);

360 
	`rmdœ
(const *);

361 
	`£tgid
(
gid_t
);

362 
	`£gid
(
pid_t
,…id_t);

363 
	$£roù™Ë
(cÚ¡ *
_fmt
, ...è
	`__´štf0like
(1, 2);

364 
pid_t
 
	`£tsid
();

365 
	`£tuid
(
uid_t
);

366 
	`¦“p
();

367 
	`syscÚf
();

368 
pid_t
 
	`tcg‘pg½
();

369 
	`tc£g½
(, 
pid_t
);

370 *
	`‰yÇme
();

371 
	`‰yÇme_r
(, *, 
size_t
);

372 
	`uÆšk
(const *);

373 
ssize_t
 
	`wr™e
(, cÚ¡ *, 
size_t
);

376 #ià
__POSIX_VISIBLE
 >ğ199209 || 
__XSI_VISIBLE


377 
size_t
 
	`cÚf¡r
(, *, size_t);

378 #iâdeà
_GETOPT_DECLARED


379 
	#_GETOPT_DECLARED


	)

380 
	`g‘İt
(, * const [], const *);

382 *
İrg
;

383 
İtšd
, 
İ‹¼
, 
İtİt
;

388 #ià
__POSIX_VISIBLE
 >ğ199506 || 
__XSI_VISIBLE


389 
	`fsync
();

395 #iâdeà
_FTRUNCATE_DECLARED


396 
	#_FTRUNCATE_DECLARED


	)

397 
	`árunÿ‹
(, 
off_t
);

401 #ià
__POSIX_VISIBLE
 >= 199506

402 
	`g‘logš_r
(*, );

406 #ià
__POSIX_VISIBLE
 >ğ200112 || 
__XSI_VISIBLE


407 
	`fchown
(, 
uid_t
, 
gid_t
);

408 
	`»adlšk
(const *, *, );

410 #ià
__POSIX_VISIBLE
 >= 200112

411 
	`g‘ho¡Çme
(*, 
size_t
);

412 
	`£‹gid
(
gid_t
);

413 
	`£‹uid
(
uid_t
);

421 #ià
__POSIX_VISIBLE
 >ğ200112 || 
__XSI_VISIBLE
 >ğ402 || 
__BSD_VISIBLE


422 
	`symlšk
(cÚ¡ * 
__»¡riù
, const * __restrict);

426 #ià
__XSI_VISIBLE


427 *
	`üy±
(const *, const *);

429 
	`’üy±
(*, );

430 
	`fchdœ
();

431 
	`g‘ho¡id
();

432 
	`g‘pgid
(
pid_t
 
_pid
);

433 
	`g‘sid
(
pid_t
 
_pid
);

434 *
	`g‘wd
(*);

435 
	`lchown
(cÚ¡ *, 
uid_t
, 
gid_t
);

436 
	`lockf
(, , 
off_t
);

437 
	`niû
();

438 
ssize_t
 
	`´—d
(, *, 
size_t
, 
off_t
);

439 
ssize_t
 
	`pwr™e
(, cÚ¡ *, 
size_t
, 
off_t
);

440 
	`£g½
(
pid_t
 
_pid
,…id_ˆ
_pg½
);

441 
	`£Œegid
(
gid_t
, gid_t);

442 
	`£Œeuid
(
uid_t
, uid_t);

444 #iâdeà
_SWAB_DECLARED


445 
	#_SWAB_DECLARED


	)

446 
	`swab
(cÚ¡ * 
__»¡riù
, * __»¡riù, 
ssize_t
);

449 
	`sync
();

450 
u£cÚds_t
 
	`u®¬m
(useconds_t, useconds_t);

451 
	`u¦“p
(
u£cÚds_t
);

452 
pid_t
 
	`vfÜk
();

455 #iâdeà
_TRUNCATE_DECLARED


456 
	#_TRUNCATE_DECLARED


	)

457 
	`Œunÿ‹
(cÚ¡ *, 
off_t
);

461 #ià
__XSI_VISIBLE
 <ğ500 || 
__BSD_VISIBLE


462 
	`brk
(const *);

463 
	`chroÙ
(const *);

464 
	`g‘dbËsize
();

465 
	$g‘·gesize
(è
__pu»2
;

466 *
	`g‘·ss
(const *);

467 *
	`sbrk
(
šŒ_t
);

470 #ià
__BSD_VISIBLE


471 
timev®
;

472 
	`acù
(const *);

473 
	`async_d«mÚ
();

474 
	`check_ut™y_com·t
(const *);

476 
	`üy±_g‘_fÜm©
();

477 
	`üy±_£t_fÜm©
(const *);

478 
	`des_ch”
(const *, *, , );

479 
	`des_£tkey
(cÚ¡ *
key
);

480 
	`’du£rsh–l
();

481 
	`exeù
(const *, * const *, * const *);

482 
	`execvP
(const *, const *, * const *);

483 *
	`fæag¡o¡r
(
u_lÚg
);

484 
	`g‘domašÇme
(*, );

485 
	`g‘grou¶i¡
(cÚ¡ *, 
gid_t
, gid_t *, *);

486 
mode_t
 
	`g‘mode
(const *, mode_t);

487 
	`g‘³”eid
(, 
uid_t
 *, 
gid_t
 *);

488 
	`g‘»sgid
(
gid_t
 *, gid_t *, gid_t *);

489 
	`g‘»suid
(
uid_t
 *, uid_t *, uid_t *);

490 *
	`g‘u£rsh–l
();

491 
	`š™groups
(cÚ¡ *, 
gid_t
);

492 
	`œu£rok
(, , const *, const *);

493 
	`œu£rok_§
(const *, , , const *, const *);

494 
	`is£tugid
();

495 *
	`mkd‹mp
(*);

496 #iâdef 
_MKNOD_DECLARED


497 
	`mknod
(cÚ¡ *, 
mode_t
, 
dev_t
);

498 
	#_MKNOD_DECLARED


	)

500 #iâdeà
_MKSTEMP_DECLARED


501 
	`mk¡emp
(*);

502 
	#_MKSTEMP_DECLARED


	)

504 
	`mk¡emps
(*, );

505 #iâdeà
_MKTEMP_DECLARED


506 *
	`mk‹mp
(*);

507 
	#_MKTEMP_DECLARED


	)

509 
	`nfssvc
(, *);

510 
	`´of
(*, 
size_t
, 
vm_off£t_t
, );

511 
	`rcmd
(**, , const *, const *, const *, *);

512 
	`rcmd_af
(**, , const *,

514 
	`rcmdsh
(**, , const *,

516 *
	`»_comp
(const *);

517 
	`»_exec
(const *);

518 
	`»boÙ
();

519 
	`»voke
(const *);

520 
pid_t
 
	`rfÜk
();

521 
pid_t
 
	`rfÜk_th»ad
(, *, (*)(*), *);

522 
	`¼esvpÜt
(*);

523 
	`¼esvpÜt_af
(*, );

524 
	`ru£rok
(const *, , const *, const *);

525 #ià
__BSD_VISIBLE


526 #iâdeà
_SELECT_DECLARED


527 
	#_SELECT_DECLARED


	)

528 
	`£Ëù
(, 
fd_£t
 *, fd_£ˆ*, fd_£ˆ*, 
timev®
 *);

531 
	`£tdomašÇme
(const *, );

532 
	`£tgroups
(, cÚ¡ 
gid_t
 *);

533 
	`£tho¡id
();

534 
	`£tho¡Çme
(const *, );

535 #iâdeà
_SETKEY_DECLARED


536 
	`£tkey
(const *);

537 
	#_SETKEY_DECLARED


	)

539 
	`£ogš
(const *);

540 *
	`£tmode
(const *);

541 
	`£Œesgid
(
gid_t
, gid_t, gid_t);

542 
	`£Œesuid
(
uid_t
, uid_t, uid_t);

543 
	`£Œgid
(
gid_t
);

544 
	`£Œuid
(
uid_t
);

545 
	`£tu£rsh–l
();

546 
	`¡¹ofæags
(**, 
u_lÚg
 *, u_long *);

547 
	`sw­Ú
(const *);

548 
	`sw­off
(const *);

549 
	`sysÿÎ
(, ...);

550 
off_t
 
	`__sysÿÎ
(
quad_t
, ...);

551 
	`‰y¦Ù
();

552 
	`und–‘e
(const *);

553 
	`unwh™eout
(const *);

554 *
	`v®loc
(
size_t
);

556 #iâdeà
_OPTRESET_DECLARED


557 
	#_OPTRESET_DECLARED


	)

558 
İŒe£t
;

561 
__END_DECLS


	@/usr/include/machine/endian.h

33 #iâdeà
_MACHINE_ENDIAN_H_


34 
	#_MACHINE_ENDIAN_H_


	)

36 
	~<sys/cdefs.h
>

37 
	~<sys/_ty³s.h
>

39 #ifdeà
__ılu¥lus


46 
	#_QUAD_HIGHWORD
 1

	)

47 
	#_QUAD_LOWWORD
 0

	)

53 
	#_LITTLE_ENDIAN
 1234

	)

54 
	#_BIG_ENDIAN
 4321

	)

55 
	#_PDP_ENDIAN
 3412

	)

57 
	#_BYTE_ORDER
 
_LITTLE_ENDIAN


	)

63 #ià
__BSD_VISIBLE


64 
	#LITTLE_ENDIAN
 
_LITTLE_ENDIAN


	)

65 
	#BIG_ENDIAN
 
_BIG_ENDIAN


	)

66 
	#PDP_ENDIAN
 
_PDP_ENDIAN


	)

67 
	#BYTE_ORDER
 
_BYTE_ORDER


	)

70 #ià
defšed
(
__GNUCLIKE_ASM
è&& defšed(
__GNUCLIKE_BUILTIN_CONSTANT_P
)

72 
	#__wÜd_sw­_št_v¬
(
x
) \

73 
	`__ex‹nsiÚ__
 ({ 
__ušt32_t
 
__X
 = (
x
); \

74 
	`__asm
 ("rÜÈ$16, %0" : "+r" (
__X
)); \

75 
__X
; })

	)

77 #ifdeà
__OPTIMIZE__


79 
	#__wÜd_sw­_št_cÚ¡
(
x
) \

80 ((((
x
) & 0xffff0000) >> 16) | \

81 (((
x
è& 0x0000ffffè<< 16))

	)

82 
	#__wÜd_sw­_št
(
x
è(
	`__butš_cÚ¡ªt_p
(x) ? \

83 
	`__wÜd_sw­_št_cÚ¡
(
x
è: 
	`__wÜd_sw­_št_v¬
(x))

	)

87 
	#__wÜd_sw­_št
(
x
è
	`__wÜd_sw­_št_v¬
(x)

	)

91 
	#__by‹_sw­_št_v¬
(
x
) \

92 
	`__ex‹nsiÚ__
 ({ 
__ušt32_t
 
__X
 = (
x
); \

93 
	`__asm
 ("bsw­ %0" : "+r" (
__X
)); \

94 
__X
; })

	)

96 #ifdeà
__OPTIMIZE__


98 
	#__by‹_sw­_št_cÚ¡
(
x
) \

99 ((((
x
) & 0xff000000) >> 24) | \

100 (((
x
) & 0x00ff0000) >> 8) | \

101 (((
x
) & 0x0000ff00) << 8) | \

102 (((
x
è& 0x000000ffè<< 24))

	)

103 
	#__by‹_sw­_št
(
x
è(
	`__butš_cÚ¡ªt_p
(x) ? \

104 
	`__by‹_sw­_št_cÚ¡
(
x
è: 
	`__by‹_sw­_št_v¬
(x))

	)

108 
	#__by‹_sw­_št
(
x
è
	`__by‹_sw­_št_v¬
(x)

	)

112 
	#__by‹_sw­_wÜd_v¬
(
x
) \

113 
	`__ex‹nsiÚ__
 ({ 
__ušt16_t
 
__X
 = (
x
); \

114 
	`__asm
 ("xchgb %h0, %b0" : "+q" (
__X
)); \

115 
__X
; })

	)

117 #ifdeà
__OPTIMIZE__


119 
	#__by‹_sw­_wÜd_cÚ¡
(
x
) \

120 ((((
x
) & 0xff00) >> 8) | \

121 (((
x
è& 0x00ffè<< 8))

	)

123 
	#__by‹_sw­_wÜd
(
x
è(
	`__butš_cÚ¡ªt_p
(x) ? \

124 
	`__by‹_sw­_wÜd_cÚ¡
(
x
è: 
	`__by‹_sw­_wÜd_v¬
(x))

	)

128 
	#__by‹_sw­_wÜd
(
x
è
	`__by‹_sw­_wÜd_v¬
(x)

	)

132 
__šlše
 
__ušt64_t


133 
__bsw­64
(
__ušt64_t
 
_x
)

136  ((
_x
 >> 56) | ((_x >> 40) & 0xff00) | ((_x >> 24) & 0xff0000) |

137 ((
_x
 >> 8è& 0xff000000è| ((_x << 8è& ((
__ušt64_t
)0xff << 32)) |

138 ((
_x
 << 24è& ((
__ušt64_t
)0xff << 40)) |

139 ((
_x
 << 40è& ((
__ušt64_t
)0xff << 48)) | ((_x << 56)));

142 
__šlše
 
__ušt32_t


143 
__bsw­32
(
__ušt32_t
 
_x
)

146  (
__by‹_sw­_št
(
_x
));

149 
__šlše
 
__ušt16_t


150 
__bsw­16
(
__ušt16_t
 
_x
)

153  (
__by‹_sw­_wÜd
(
_x
));

156 
	#__htÚl
(
x
è
	`__bsw­32
(x)

	)

157 
	#__htÚs
(
x
è
	`__bsw­16
(x)

	)

158 
	#__Áohl
(
x
è
	`__bsw­32
(x)

	)

159 
	#__Áohs
(
x
è
	`__bsw­16
(x)

	)

168 
	#_BYTEORDER_FUNC_DEFINED


	)

172 #ifdeà
__ılu¥lus


	@/usr/include/machine/param.h

45 #iâdeà
_ALIGNBYTES


46 
	#_ALIGNBYTES
 ((è- 1)

	)

48 #iâdeà
_ALIGN


49 
	#_ALIGN
(
p
è((()Õè+ 
_ALIGNBYTES
è& ~_ALIGNBYTES)

	)

52 #iâdeà
_NO_NAMESPACE_POLLUTION


54 
	#__HAVE_ACPI


	)

55 
	#__PCI_REROUTE_INTERRUPT


	)

57 #iâdeà
_MACHINE_PARAM_H_


58 
	#_MACHINE_PARAM_H_


	)

60 #iâdeà
MACHINE


61 
	#MACHINE
 "i386"

	)

63 #iâdeà
MACHINE_ARCH


64 
	#MACHINE_ARCH
 "i386"

	)

66 
	#MID_MACHINE
 
MID_I386


	)

68 #ifdeà
SMP


69 
	#MAXCPU
 16

	)

71 
	#MAXCPU
 1

	)

74 
	#ALIGNBYTES
 
_ALIGNBYTES


	)

75 
	#ALIGN
(
p
è
	`_ALIGN
Õ)

	)

77 
	#PAGE_SHIFT
 12

	)

78 
	#PAGE_SIZE
 (1<<
PAGE_SHIFT
è

	)

79 
	#PAGE_MASK
 (
PAGE_SIZE
-1)

	)

80 
	#NPTEPG
 (
PAGE_SIZE
/( (
±_’Œy_t
)))

	)

82 #ifdeà
PAE


83 
	#NPGPTD
 4

	)

84 
	#PDRSHIFT
 21

	)

86 
	#NPGPTD
 1

	)

87 
	#PDRSHIFT
 22

	)

90 
	#NBPTD
 (
NPGPTD
<<
PAGE_SHIFT
)

	)

91 
	#NPDEPTD
 (
NBPTD
/( (
pd_’Œy_t
)))

	)

92 
	#NPDEPG
 (
PAGE_SIZE
/( (
pd_’Œy_t
)))

	)

93 
	#NBPDR
 (1<<
PDRSHIFT
è

	)

94 
	#PDRMASK
 (
NBPDR
-1)

	)

96 
	#IOPAGES
 2

	)

98 #iâdeà
KSTACK_PAGES


99 
	#KSTACK_PAGES
 2

	)

101 
	#KSTACK_GUARD_PAGES
 1

	)

107 #iâdeà
VM_SWZONE_SIZE_MAX


108 
	#VM_SWZONE_SIZE_MAX
 (32 * 1024 * 1024)

	)

116 #iâdeà
VM_BCACHE_SIZE_MAX


117 
	#VM_BCACHE_SIZE_MAX
 (200 * 1024 * 1024)

	)

123 
	#Œunc_·ge
(
x
è((xè& ~
PAGE_MASK
)

	)

124 
	#round_·ge
(
x
è(((xè+ 
PAGE_MASK
è& ~PAGE_MASK)

	)

125 
	#Œunc_4m·ge
(
x
è((xè& ~
PDRMASK
)

	)

126 
	#round_4m·ge
(
x
è((((x)è+ 
PDRMASK
è& ~PDRMASK)

	)

128 
	#©İ
(
x
è((xè>> 
PAGE_SHIFT
)

	)

129 
	#±ß
(
x
è((xè<< 
PAGE_SHIFT
)

	)

131 
	#i386_btİ
(
x
è((xè>> 
PAGE_SHIFT
)

	)

132 
	#i386_±ob
(
x
è((xè<< 
PAGE_SHIFT
)

	)

134 
	#pgtok
(
x
è((xè* (
PAGE_SIZE
 / 1024))

	)

	@/usr/include/netinet/sctp_uio.h

32 
	~<sys/cdefs.h
>

33 
__FBSDID
("$FreeBSD: src/sys/netinet/sctp_uio.h,v 1.29 2007/09/18 15:16:39„rs Exp $");

35 #iâdeà
__sùp_uio_h__


36 
	#__sùp_uio_h__


	)

39 #ià! 
defšed
(
_KERNEL
)

40 
	~<¡dšt.h
>

42 
	~<sys/ty³s.h
>

43 
	~<sys/sock‘.h
>

44 
	~<Ãtš‘/š.h
>

46 
ušt32_t
 
	tsùp_assoc_t
;

49 
	ssùp_ev’t_subsüibe
 {

50 
ušt8_t
 
	msùp_d©a_io_ev’t
;

51 
ušt8_t
 
	msùp_assocŸtiÚ_ev’t
;

52 
ušt8_t
 
	msùp_add»ss_ev’t
;

53 
ušt8_t
 
	msùp_£nd_çu»_ev’t
;

54 
ušt8_t
 
	msùp_³”_”rÜ_ev’t
;

55 
ušt8_t
 
	msùp_shutdown_ev’t
;

56 
ušt8_t
 
	msùp_·¹Ÿl_d–iv”y_ev’t
;

57 
ušt8_t
 
	msùp_ad­tiÚ_Ïy”_ev’t
;

58 
ušt8_t
 
	msùp_auth’tiÿtiÚ_ev’t
;

59 
ušt8_t
 
	msùp_¡»am_»£t_ev’ts
;

63 
	#SCTP_INIT
 0x0001

	)

64 
	#SCTP_SNDRCV
 0x0002

	)

65 
	#SCTP_EXTRCV
 0x0003

	)

69 
	ssùp_š™msg
 {

70 
ušt32_t
 
	msš™_num_o¡»ams
;

71 
ušt32_t
 
	msš™_max_š¡»ams
;

72 
ušt16_t
 
	msš™_max_©‹m±s
;

73 
ušt16_t
 
	msš™_max_š™_timeo
;

90 
	#SCTP_ALIGN_RESV_PAD
 96

	)

91 
	#SCTP_ALIGN_RESV_PAD_SHORT
 80

	)

93 
	ssùp_¢drcvšfo
 {

94 
ušt16_t
 
	msšfo_¡»am
;

95 
ušt16_t
 
	msšfo_s¢
;

96 
ušt16_t
 
	msšfo_æags
;

97 
ušt16_t
 
	msšfo_´_pŞicy
;

98 
ušt32_t
 
	msšfo_µid
;

99 
ušt32_t
 
	msšfo_cÚ‹xt
;

100 
ušt32_t
 
	msšfo_tim‘Şive
;

101 
ušt32_t
 
	msšfo_t¢
;

102 
ušt32_t
 
	msšfo_cumt¢
;

103 
sùp_assoc_t
 
	msšfo_assoc_id
;

104 
ušt8_t
 
	m__»£rve_·d
[
SCTP_ALIGN_RESV_PAD
];

107 
	ssùp_exŒcvšfo
 {

108 
ušt16_t
 
	msšfo_¡»am
;

109 
ušt16_t
 
	msšfo_s¢
;

110 
ušt16_t
 
	msšfo_æags
;

111 
ušt16_t
 
	msšfo_´_pŞicy
;

112 
ušt32_t
 
	msšfo_µid
;

113 
ušt32_t
 
	msšfo_cÚ‹xt
;

114 
ušt32_t
 
	msšfo_tim‘Şive
;

115 
ušt32_t
 
	msšfo_t¢
;

116 
ušt32_t
 
	msšfo_cumt¢
;

117 
sùp_assoc_t
 
	msšfo_assoc_id
;

118 
ušt16_t
 
	m¤ešfo_Ãxt_æags
;

119 
ušt16_t
 
	m¤ešfo_Ãxt_¡»am
;

120 
ušt32_t
 
	m¤ešfo_Ãxt_aid
;

121 
ušt32_t
 
	m¤ešfo_Ãxt_Ëngth
;

122 
ušt32_t
 
	m¤ešfo_Ãxt_µid
;

123 
ušt8_t
 
	m__»£rve_·d
[
SCTP_ALIGN_RESV_PAD_SHORT
];

126 
	#SCTP_NO_NEXT_MSG
 0x0000

	)

127 
	#SCTP_NEXT_MSG_AVAIL
 0x0001

	)

128 
	#SCTP_NEXT_MSG_ISCOMPLETE
 0x0002

	)

129 
	#SCTP_NEXT_MSG_IS_UNORDERED
 0x0004

	)

130 
	#SCTP_NEXT_MSG_IS_NOTIFICATION
 0x0008

	)

132 
	ssùp_¢d_®l_com¶‘es
 {

133 
ušt16_t
 
	m§Î_¡»am
;

134 
ušt16_t
 
	m§Î_æags
;

135 
ušt32_t
 
	m§Î_µid
;

136 
ušt32_t
 
	m§Î_cÚ‹xt
;

137 
ušt32_t
 
	m§Î_num_£Á
;

138 
ušt32_t
 
	m§Î_num_çed
;

142 
	#SCTP_EOF
 0x0100

	)

143 
	#SCTP_ABORT
 0x0200

	)

144 
	#SCTP_UNORDERED
 0x0400

	)

145 
	#SCTP_ADDR_OVER
 0x0800

	)

146 
	#SCTP_SENDALL
 0x1000

	)

147 
	#SCTP_EOR
 0x2000

	)

148 
	#SCTP_PR_POLICY_VALID
 0x4000

	)

150 
	#INVALID_SINFO_FLAG
(
x
) (((x) & 0xffffff00 \

151 & ~(
SCTP_EOF
 | 
SCTP_ABORT
 | 
SCTP_UNORDERED
 |\

152 
SCTP_ADDR_OVER
 | 
SCTP_SENDALL
 | 
SCTP_EOR
)è!ğ0)

	)

156 
	#SCTP_PR_SCTP_TTL
 0x0001

	)

157 
	#SCTP_PR_SCTP_BUF
 0x0002

	)

158 
	#SCTP_PR_SCTP_RTX
 0x0003

	)

160 
	#PR_SCTP_POLICY
(
x
è((xè& 0xff)

	)

161 
	#PR_SCTP_ENABLED
(
x
è(
	`PR_SCTP_POLICY
(xè!ğ0)

	)

162 
	#PR_SCTP_TTL_ENABLED
(
x
è(
	`PR_SCTP_POLICY
(xè=ğ
SCTP_PR_SCTP_TTL
)

	)

163 
	#PR_SCTP_BUF_ENABLED
(
x
è(
	`PR_SCTP_POLICY
(xè=ğ
SCTP_PR_SCTP_BUF
)

	)

164 
	#PR_SCTP_RTX_ENABLED
(
x
è(
	`PR_SCTP_POLICY
(xè=ğ
SCTP_PR_SCTP_RTX
)

	)

165 
	#PR_SCTP_INVALID_POLICY
(
x
è(
	`PR_SCTP_POLICY
(xè> 
SCTP_PR_SCTP_RTX
)

	)

167 
	ssùp_pcbšfo
 {

168 
ušt32_t
 
	m•_couÁ
;

169 
ušt32_t
 
	masoc_couÁ
;

170 
ušt32_t
 
	mÏddr_couÁ
;

171 
ušt32_t
 
	m¿ddr_couÁ
;

172 
ušt32_t
 
	mchk_couÁ
;

173 
ušt32_t
 
	m»adq_couÁ
;

174 
ušt32_t
 
	mä“_chunks
;

175 
ušt32_t
 
	m¡»am_oque
;

178 
	ssùp_sock¡©
 {

179 
sùp_assoc_t
 
	mss_assoc_id
;

180 
ušt32_t
 
	mss_tÙ®_¢dbuf
;

181 
ušt32_t
 
	mss_tÙ®_»cv_buf
;

191 
	ssùp_assoc_chªge
 {

192 
ušt16_t
 
	m§c_ty³
;

193 
ušt16_t
 
	m§c_æags
;

194 
ušt32_t
 
	m§c_Ëngth
;

195 
ušt16_t
 
	m§c_¡©e
;

196 
ušt16_t
 
	m§c_”rÜ
;

197 
ušt16_t
 
	m§c_outbound_¡»ams
;

198 
ušt16_t
 
	m§c_šbound_¡»ams
;

199 
sùp_assoc_t
 
	m§c_assoc_id
;

203 
	#SCTP_COMM_UP
 0x0001

	)

204 
	#SCTP_COMM_LOST
 0x0002

	)

205 
	#SCTP_RESTART
 0x0003

	)

206 
	#SCTP_SHUTDOWN_COMP
 0x0004

	)

207 
	#SCTP_CANT_STR_ASSOC
 0x0005

	)

213 
	ssùp_·ddr_chªge
 {

214 
ušt16_t
 
	m¥c_ty³
;

215 
ušt16_t
 
	m¥c_æags
;

216 
ušt32_t
 
	m¥c_Ëngth
;

217 
sockaddr_¡Üage
 
	m¥c_¯ddr
;

218 
ušt32_t
 
	m¥c_¡©e
;

219 
ušt32_t
 
	m¥c_”rÜ
;

220 
sùp_assoc_t
 
	m¥c_assoc_id
;

221 
ušt8_t
 
	m¥c_·ddšg
[4];

225 
	#SCTP_ADDR_AVAILABLE
 0x0001

	)

226 
	#SCTP_ADDR_UNREACHABLE
 0x0002

	)

227 
	#SCTP_ADDR_REMOVED
 0x0003

	)

228 
	#SCTP_ADDR_ADDED
 0x0004

	)

229 
	#SCTP_ADDR_MADE_PRIM
 0x0005

	)

230 
	#SCTP_ADDR_CONFIRMED
 0x0006

	)

236 #ifdeà
SCTP_ACTIVE


237 #undeà
SCTP_ACTIVE


239 
	#SCTP_ACTIVE
 0x0001

	)

241 #ifdeà
SCTP_INACTIVE


242 #undeà
SCTP_INACTIVE


244 
	#SCTP_INACTIVE
 0x0002

	)

246 #ifdeà
SCTP_UNCONFIRMED


247 #undeà
SCTP_UNCONFIRMED


249 
	#SCTP_UNCONFIRMED
 0x0200

	)

251 #ifdeà
SCTP_NOHEARTBEAT


252 #undeà
SCTP_NOHEARTBEAT


254 
	#SCTP_NOHEARTBEAT
 0x0040

	)

258 
	ssùp_»mÙe_”rÜ
 {

259 
ušt16_t
 
	m¤e_ty³
;

260 
ušt16_t
 
	m¤e_æags
;

261 
ušt32_t
 
	m¤e_Ëngth
;

262 
ušt16_t
 
	m¤e_”rÜ
;

263 
sùp_assoc_t
 
	m¤e_assoc_id
;

264 
ušt8_t
 
	m¤e_d©a
[4];

268 
	ssùp_£nd_çed
 {

269 
ušt16_t
 
	mssf_ty³
;

270 
ušt16_t
 
	mssf_æags
;

271 
ušt32_t
 
	mssf_Ëngth
;

272 
ušt32_t
 
	mssf_”rÜ
;

273 
sùp_¢drcvšfo
 
	mssf_šfo
;

274 
sùp_assoc_t
 
	mssf_assoc_id
;

275 
ušt8_t
 
	mssf_d©a
[0];

279 
	#SCTP_DATA_UNSENT
 0x0001

	)

280 
	#SCTP_DATA_SENT
 0x0002

	)

283 
	ssùp_shutdown_ev’t
 {

284 
ušt16_t
 
	ms£_ty³
;

285 
ušt16_t
 
	ms£_æags
;

286 
ušt32_t
 
	ms£_Ëngth
;

287 
sùp_assoc_t
 
	ms£_assoc_id
;

291 
	ssùp_ad­tiÚ_ev’t
 {

292 
ušt16_t
 
	m§i_ty³
;

293 
ušt16_t
 
	m§i_æags
;

294 
ušt32_t
 
	m§i_Ëngth
;

295 
ušt32_t
 
	m§i_ad­tiÚ_šd
;

296 
sùp_assoc_t
 
	m§i_assoc_id
;

299 
	ssùp_£d­tiÚ
 {

300 
ušt32_t
 
	mssb_ad­tiÚ_šd
;

304 
	ssùp_ad­tiÚ_ev’t
 {

305 
ušt16_t
 
	m§i_ty³
;

306 
ušt16_t
 
	m§i_æags
;

307 
ušt32_t
 
	m§i_Ëngth
;

308 
ušt32_t
 
	m§i_ad­tiÚ_šd
;

309 
sùp_assoc_t
 
	m§i_assoc_id
;

312 
	ssùp_£d­tiÚ
 {

313 
ušt32_t
 
	mssb_ad­tiÚ_šd
;

320 
	ssùp_pd­i_ev’t
 {

321 
ušt16_t
 
	mpd­i_ty³
;

322 
ušt16_t
 
	mpd­i_æags
;

323 
ušt32_t
 
	mpd­i_Ëngth
;

324 
ušt32_t
 
	mpd­i_šdiÿtiÚ
;

325 
ušt16_t
 
	mpd­i_¡»am
;

326 
ušt16_t
 
	mpd­i_£q
;

327 
sùp_assoc_t
 
	mpd­i_assoc_id
;

331 
	#SCTP_PARTIAL_DELIVERY_ABORTED
 0x0001

	)

337 
	ssùp_authkey_ev’t
 {

338 
ušt16_t
 
	mauth_ty³
;

339 
ušt16_t
 
	mauth_æags
;

340 
ušt32_t
 
	mauth_Ëngth
;

341 
ušt16_t
 
	mauth_keynumb”
;

342 
ušt16_t
 
	mauth_®tkeynumb”
;

343 
ušt32_t
 
	mauth_šdiÿtiÚ
;

344 
sùp_assoc_t
 
	mauth_assoc_id
;

348 
	#SCTP_AUTH_NEWKEY
 0x0001

	)

354 
	ssùp_¡»am_»£t_ev’t
 {

355 
ušt16_t
 
	m¡¼e£t_ty³
;

356 
ušt16_t
 
	m¡¼e£t_æags
;

357 
ušt32_t
 
	m¡¼e£t_Ëngth
;

358 
sùp_assoc_t
 
	m¡¼e£t_assoc_id
;

359 
ušt16_t
 
	m¡¼e£t_li¡
[0];

363 
	#SCTP_STRRESET_INBOUND_STR
 0x0001

	)

364 
	#SCTP_STRRESET_OUTBOUND_STR
 0x0002

	)

365 
	#SCTP_STRRESET_ALL_STREAMS
 0x0004

	)

366 
	#SCTP_STRRESET_STREAM_LIST
 0x0008

	)

367 
	#SCTP_STRRESET_FAILED
 0x0010

	)

371 
	ssùp_v
 {

372 
ušt16_t
 
	m¢_ty³
;

373 
ušt16_t
 
	m¢_æags
;

374 
ušt32_t
 
	m¢_Ëngth
;

377 
	usùp_nÙifiÿtiÚ
 {

378 
sùp_v
 
	m¢_h—d”
;

379 
sùp_assoc_chªge
 
	m¢_assoc_chªge
;

380 
sùp_·ddr_chªge
 
	m¢_·ddr_chªge
;

381 
sùp_»mÙe_”rÜ
 
	m¢_»mÙe_”rÜ
;

382 
sùp_£nd_çed
 
	m¢_£nd_çed
;

383 
sùp_shutdown_ev’t
 
	m¢_shutdown_ev’t
;

384 
sùp_ad­tiÚ_ev’t
 
	m¢_ad­tiÚ_ev’t
;

386 
sùp_ad­tiÚ_ev’t
 
	m¢_ad­tiÚ_ev’t
;

387 
sùp_pd­i_ev’t
 
	m¢_pd­i_ev’t
;

388 
sùp_authkey_ev’t
 
	m¢_auth_ev’t
;

389 
sùp_¡»am_»£t_ev’t
 
	m¢_¡¼e£t_ev’t
;

393 
	#SCTP_ASSOC_CHANGE
 0x0001

	)

394 
	#SCTP_PEER_ADDR_CHANGE
 0x0002

	)

395 
	#SCTP_REMOTE_ERROR
 0x0003

	)

396 
	#SCTP_SEND_FAILED
 0x0004

	)

397 
	#SCTP_SHUTDOWN_EVENT
 0x0005

	)

398 
	#SCTP_ADAPTATION_INDICATION
 0x0006

	)

400 
	#SCTP_ADAPTION_INDICATION
 0x0006

	)

401 
	#SCTP_PARTIAL_DELIVERY_EVENT
 0x0007

	)

402 
	#SCTP_AUTHENTICATION_EVENT
 0x0008

	)

403 
	#SCTP_STREAM_RESET_EVENT
 0x0009

	)

410 
	ssùp_·dd½¬ams
 {

411 
sockaddr_¡Üage
 
	m¥p_add»ss
;

412 
sùp_assoc_t
 
	m¥p_assoc_id
;

413 
ušt32_t
 
	m¥p_hbš‹rv®
;

414 
ušt32_t
 
	m¥p_·thmtu
;

415 
ušt32_t
 
	m¥p_æags
;

416 
ušt32_t
 
	m¥p_v6_æowÏb–
;

417 
ušt16_t
 
	m¥p_·thmaxrxt
;

418 
ušt8_t
 
	m¥p_v4_tos
;

421 
	#SPP_HB_ENABLE
 0x00000001

	)

422 
	#SPP_HB_DISABLE
 0x00000002

	)

423 
	#SPP_HB_DEMAND
 0x00000004

	)

424 
	#SPP_PMTUD_ENABLE
 0x00000008

	)

425 
	#SPP_PMTUD_DISABLE
 0x00000010

	)

426 
	#SPP_HB_TIME_IS_ZERO
 0x00000080

	)

427 
	#SPP_IPV6_FLOWLABEL
 0x00000100

	)

428 
	#SPP_IPV4_TOS
 0x00000200

	)

430 
	ssùp_·ddršfo
 {

431 
sockaddr_¡Üage
 
	m¥šfo_add»ss
;

432 
sùp_assoc_t
 
	m¥šfo_assoc_id
;

433 
št32_t
 
	m¥šfo_¡©e
;

434 
ušt32_t
 
	m¥šfo_cwnd
;

435 
ušt32_t
 
	m¥šfo_¤‰
;

436 
ušt32_t
 
	m¥šfo_¹o
;

437 
ušt32_t
 
	m¥šfo_mtu
;

440 
	ssùp_¹ošfo
 {

441 
sùp_assoc_t
 
	m¤to_assoc_id
;

442 
ušt32_t
 
	m¤to_š™Ÿl
;

443 
ušt32_t
 
	m¤to_max
;

444 
ušt32_t
 
	m¤to_mš
;

447 
	ssùp_assoı¬ams
 {

448 
sùp_assoc_t
 
	m§soc_assoc_id
;

449 
ušt32_t
 
	m§soc_³”_rwnd
;

450 
ušt32_t
 
	m§soc_loÿl_rwnd
;

451 
ušt32_t
 
	m§soc_cook›_liã
;

452 
ušt16_t
 
	m§soc_asocmaxrxt
;

453 
ušt16_t
 
	m§soc_numb”_³”_de¡š©iÚs
;

456 
	ssùp_£rim
 {

457 
sockaddr_¡Üage
 
	ms¥_addr
;

458 
sùp_assoc_t
 
	ms¥_assoc_id
;

459 
ušt8_t
 
	ms¥_·ddšg
[4];

462 
	ssùp_£“½rim
 {

463 
sockaddr_¡Üage
 
	ms¥p_addr
;

464 
sùp_assoc_t
 
	ms¥p_assoc_id
;

465 
ušt8_t
 
	ms¥p_·ddšg
[4];

468 
	ssùp_g‘add»s£s
 {

469 
sùp_assoc_t
 
	msg‘_assoc_id
;

471 
sockaddr
 
	maddr
[1];

474 
	ssùp_£t¡rm_timeout
 {

475 
sùp_assoc_t
 
	ms¡o_assoc_id
;

476 
ušt32_t
 
	ms¡o_timeout
;

477 
ušt32_t
 
	ms¡o_¡»amid_¡¬t
;

478 
ušt32_t
 
	ms¡o_¡»amid_’d
;

481 
	ssùp_¡©us
 {

482 
sùp_assoc_t
 
	ms¡©_assoc_id
;

483 
št32_t
 
	ms¡©_¡©e
;

484 
ušt32_t
 
	ms¡©_rwnd
;

485 
ušt16_t
 
	ms¡©_uÇckd©a
;

486 
ušt16_t
 
	ms¡©_³ndd©a
;

487 
ušt16_t
 
	ms¡©_š¡rms
;

488 
ušt16_t
 
	ms¡©_out¡rms
;

489 
ušt32_t
 
	ms¡©_äagm’tiÚ_pošt
;

490 
sùp_·ddršfo
 
	ms¡©_´im¬y
;

497 
	ssùp_authchunk
 {

498 
ušt8_t
 
	m§uth_chunk
;

502 
	ssùp_authkey
 {

503 
sùp_assoc_t
 
	msÿ_assoc_id
;

504 
ušt16_t
 
	msÿ_keynumb”
;

505 
ušt8_t
 
	msÿ_key
[0];

509 
	ssùp_hmaÿlgo
 {

510 
ušt16_t
 
	mshmac_id’ts
[0];

514 
	#SCTP_AUTH_HMAC_ID_RSVD
 0x0000

	)

515 
	#SCTP_AUTH_HMAC_ID_SHA1
 0x0001

	)

516 
	#SCTP_AUTH_HMAC_ID_MD5
 0x0002

	)

517 
	#SCTP_AUTH_HMAC_ID_SHA256
 0x0003

	)

518 
	#SCTP_AUTH_HMAC_ID_SHA224
 0x0004

	)

519 
	#SCTP_AUTH_HMAC_ID_SHA384
 0x0005

	)

520 
	#SCTP_AUTH_HMAC_ID_SHA512
 0x0006

	)

524 
	ssùp_authkeyid
 {

525 
sùp_assoc_t
 
	msÿù_assoc_id
;

526 
ušt16_t
 
	msÿù_keynumb”
;

530 
	ssùp_authchunks
 {

531 
sùp_assoc_t
 
	mgauth_assoc_id
;

532 
ušt8_t
 
	mgauth_chunks
[0];

535 
	ssùp_assoc_v®ue
 {

536 
sùp_assoc_t
 
	massoc_id
;

537 
ušt32_t
 
	massoc_v®ue
;

540 
	ssùp_assoc_ids
 {

541 
sùp_assoc_t
 
	mgaids_assoc_id
[0];

544 
	ssùp_§ck_šfo
 {

545 
sùp_assoc_t
 
	m§ck_assoc_id
;

546 
ušt32_t
 
	m§ck_d–ay
;

547 
ušt32_t
 
	m§ck_äeq
;

550 
	ssùp_cwnd_¬gs
 {

551 
sùp_Ãts
 *
	mÃt
;

552 
ušt32_t
 
	mcwnd_Ãw_v®ue
;

553 
ušt32_t
 
	mšæight
;

554 
ušt32_t
 
	mp£udo_cumack
;

555 
ušt32_t
 
	mcwnd_augm’t
;

556 
ušt8_t
 
	mm“ts_p£udo_cumack
;

557 
ušt8_t
 
	mÃed_Ãw_p£udo_cumack
;

558 
ušt8_t
 
	mút_š_£nd
;

559 
ušt8_t
 
	mút_š_¡r
;

562 
	ssùp_blk_¬gs
 {

563 
ušt32_t
 
	mÚsb
;

564 
ušt32_t
 
	m¢dËn
;

565 
ušt32_t
 
	m³”_rwnd
;

566 
ušt16_t
 
	m£nd_£Á_qút
;

567 
ušt16_t
 
	m¡»am_qút
;

568 
ušt16_t
 
	mchunks_Ú_oque
;

569 
ušt16_t
 
	mæight_size
;

578 
	#SCTP_MAX_EXPLICT_STR_RESET
 1000

	)

580 
	#SCTP_RESET_LOCAL_RECV
 0x0001

	)

581 
	#SCTP_RESET_LOCAL_SEND
 0x0002

	)

582 
	#SCTP_RESET_BOTH
 0x0003

	)

583 
	#SCTP_RESET_TSN
 0x0004

	)

585 
	ssùp_¡»am_»£t
 {

586 
sùp_assoc_t
 
	m¡¼¡_assoc_id
;

587 
ušt16_t
 
	m¡¼¡_æags
;

588 
ušt16_t
 
	m¡¼¡_num_¡»ams
;

589 
ušt16_t
 
	m¡¼¡_li¡
[0];

593 
	ssùp_g‘_nÚû_v®ues
 {

594 
sùp_assoc_t
 
	mgn_assoc_id
;

595 
ušt32_t
 
	mgn_³”s_g
;

596 
ušt32_t
 
	mgn_loÿl_g
;

600 
	ssùp_¡r_log
 {

601 *
	m¡cb
;

602 
ušt32_t
 
	mn_t¢
;

603 
ušt32_t
 
	me_t¢
;

604 
ušt16_t
 
	mn_s£q
;

605 
ušt16_t
 
	me_s£q
;

606 
ušt16_t
 
	m¡rm
;

609 
	ssùp_sb_log
 {

610 *
	m¡cb
;

611 
ušt32_t
 
	mso_sbcc
;

612 
ušt32_t
 
	m¡cb_sbcc
;

613 
ušt32_t
 
	mšü
;

616 
	ssùp_ä_log
 {

617 
ušt32_t
 
	mÏrge¡_t¢
;

618 
ušt32_t
 
	mÏrge¡_Ãw_t¢
;

619 
ušt32_t
 
	mt¢
;

622 
	ssùp_ä_m­
 {

623 
ušt32_t
 
	mba£
;

624 
ušt32_t
 
	mcum
;

625 
ušt32_t
 
	mhigh
;

628 
	ssùp_rwnd_log
 {

629 
ušt32_t
 
	mrwnd
;

630 
ušt32_t
 
	m£nd_size
;

631 
ušt32_t
 
	mov”h—d
;

632 
ušt32_t
 
	mÃw_rwnd
;

635 
	ssùp_mbút_log
 {

636 
ušt32_t
 
	mtÙ®_queue_size
;

637 
ušt32_t
 
	msize_chªge
;

638 
ušt32_t
 
	mtÙ®_queue_mb_size
;

639 
ušt32_t
 
	mmbút_chªge
;

642 
	ssùp_§ck_log
 {

643 
ušt32_t
 
	mcumack
;

644 
ušt32_t
 
	mŞdcumack
;

645 
ušt32_t
 
	mt¢
;

646 
ušt16_t
 
	mnumG­s
;

647 
ušt16_t
 
	mnumDups
;

650 
	ssùp_lock_log
 {

651 *
	msock
;

652 *
	mšp
;

653 
ušt8_t
 
	mtcb_lock
;

654 
ušt8_t
 
	mšp_lock
;

655 
ušt8_t
 
	mšfo_lock
;

656 
ušt8_t
 
	msock_lock
;

657 
ušt8_t
 
	msockrcvbuf_lock
;

658 
ušt8_t
 
	msock¢dbuf_lock
;

659 
ušt8_t
 
	mü—‹_lock
;

660 
ušt8_t
 
	m»sv
;

663 
	ssùp_¹o_log
 {

664 *
	mÃt
;

665 
ušt32_t
 
	m¹t
;

668 
	ssùp_ÇgË_log
 {

669 *
	m¡cb
;

670 
ušt32_t
 
	mtÙ®_æight
;

671 
ušt32_t
 
	mtÙ®_š_queue
;

672 
ušt16_t
 
	mcouÁ_š_queue
;

673 
ušt16_t
 
	mcouÁ_š_æight
;

676 
	ssùp_sbwake_log
 {

677 *
	m¡cb
;

678 
ušt16_t
 
	m£nd_q
;

679 
ušt16_t
 
	m£Á_q
;

680 
ušt16_t
 
	mæight
;

681 
ušt16_t
 
	mwake_út
;

682 
ušt8_t
 
	m¡»am_qút
;

683 
ušt8_t
 
	mchunks_Ú_oque
;

684 
ušt8_t
 
	msbæags
;

685 
ušt8_t
 
	msùpæags
;

688 
	ssùp_misc_šfo
 {

689 
ušt32_t
 
	mlog1
;

690 
ušt32_t
 
	mlog2
;

691 
ušt32_t
 
	mlog3
;

692 
ušt32_t
 
	mlog4
;

695 
	ssùp_log_şosšg
 {

696 *
	mšp
;

697 *
	m¡cb
;

698 
ušt32_t
 
	msùp_æags
;

699 
ušt16_t
 
	m¡©e
;

700 
št16_t
 
	mloc
;

703 
	ssùp_mbuf_log
 {

704 
mbuf
 *
	mmp
;

705 
ÿddr_t
 
	mext
;

706 
ÿddr_t
 
	md©a
;

707 
ušt16_t
 
	msize
;

708 
ušt8_t
 
	m»fút
;

709 
ušt8_t
 
	mmbuf_æags
;

712 
	ssùp_cwnd_log
 {

713 
ušt64_t
 
	mtime_ev’t
;

714 
ušt8_t
 
	mäom
;

715 
ušt8_t
 
	mev’t_ty³
;

716 
ušt8_t
 
	m»sv
[2];

718 
sùp_log_şosšg
 
	mşo£
;

719 
sùp_blk_¬gs
 
	mblk
;

720 
sùp_cwnd_¬gs
 
	mcwnd
;

721 
sùp_¡r_log
 
	m¡¾og
;

722 
sùp_ä_log
 
	mä
;

723 
sùp_ä_m­
 
	mm­
;

724 
sùp_rwnd_log
 
	mrwnd
;

725 
sùp_mbút_log
 
	mmbút
;

726 
sùp_§ck_log
 
	m§ck
;

727 
sùp_lock_log
 
	mlock
;

728 
sùp_¹o_log
 
	m¹o
;

729 
sùp_sb_log
 
	msb
;

730 
sùp_ÇgË_log
 
	mÇgË
;

731 
sùp_sbwake_log
 
	mwake
;

732 
sùp_mbuf_log
 
	mmb
;

733 
sùp_misc_šfo
 
	mmisc
;

734 } 
	mx
;

737 
	ssùp_cwnd_log_»q
 {

738 
št32_t
 
	mnum_š_log
;

739 
št32_t
 
	mnum_»t
;

740 
št32_t
 
	m¡¬t_©
;

741 
št32_t
 
	m’d_©
;

742 
sùp_cwnd_log
 
	mlog
[0];

745 
	ssùp_timev®
 {

746 
ušt32_t
 
	mtv_£c
;

747 
ušt32_t
 
	mtv_u£c
;

750 
	ssùp¡©
 {

752 
ušt32_t
 
	msùps_cu¼e¡ab
;

753 
ušt32_t
 
	msùps_aùiv“¡ab
;

754 
ušt32_t
 
	msùps_»¡¬‹¡ab
;

755 
ušt32_t
 
	msùps_cŞlisiÚe¡ab
;

756 
ušt32_t
 
	msùps_·ssiv“¡ab
;

757 
ušt32_t
 
	msùps_abÜ‹d
;

758 
ušt32_t
 
	msùps_shutdown
;

759 
ušt32_t
 
	msùps_outoáheblue
;

760 
ušt32_t
 
	msùps_checksum”rÜs
;

761 
ušt32_t
 
	msùps_outcÚŒŞchunks
;

762 
ušt32_t
 
	msùps_outÜd”chunks
;

763 
ušt32_t
 
	msùps_outunÜd”chunks
;

764 
ušt32_t
 
	msùps_šcÚŒŞchunks
;

765 
ušt32_t
 
	msùps_šÜd”chunks
;

766 
ušt32_t
 
	msùps_šunÜd”chunks
;

767 
ušt32_t
 
	msùps_äagu¤msgs
;

768 
ušt32_t
 
	msùps_»asmu¤msgs
;

769 
ušt32_t
 
	msùps_ouack‘s
;

770 
ušt32_t
 
	msùps_š·ck‘s
;

773 
ušt32_t
 
	msùps_»cv·ck‘s
;

774 
ušt32_t
 
	msùps_»cvd©ag¿ms
;

775 
ušt32_t
 
	msùps_»cvpktw™hd©a
;

776 
ušt32_t
 
	msùps_»cv§cks
;

777 
ušt32_t
 
	msùps_»cvd©a
;

778 
ušt32_t
 
	msùps_»cvdupd©a
;

779 
ušt32_t
 
	msùps_»cvh—¹b—t
;

780 
ušt32_t
 
	msùps_»cvh—¹b—ck
;

781 
ušt32_t
 
	msùps_»cveúe
;

782 
ušt32_t
 
	msùps_»cvauth
;

783 
ušt32_t
 
	msùps_»cvauthmissšg
;

784 
ušt32_t
 
	msùps_»cviv®hmacid
;

786 
ušt32_t
 
	msùps_»cviv®keyid
;

788 
ušt32_t
 
	msùps_»cvauthçed
;

789 
ušt32_t
 
	msùps_»cvex´ess
;

791 
ušt32_t
 
	msùps_»cvex´essm
;

793 
ušt32_t
 
	msùps_£nd·ck‘s
;

794 
ušt32_t
 
	msùps_£nd§cks
;

795 
ušt32_t
 
	msùps_£ndd©a
;

796 
ušt32_t
 
	msùps_£nd»Œªsd©a
;

798 
ušt32_t
 
	msùps_£ndç¡»Œªs
;

800 
ušt32_t
 
	msùps_£ndmuÉç¡»Œªs
;

804 
ušt32_t
 
	msùps_£ndh—¹b—t
;

805 
ušt32_t
 
	msùps_£ndeúe
;

806 
ušt32_t
 
	msùps_£ndauth
;

807 
ušt32_t
 
	msùps_£nd”rÜs
;

809 
ušt32_t
 
	msùps_pd½fmbox
;

810 
ušt32_t
 
	msùps_pd½ãhos
;

811 
ušt32_t
 
	msùps_pd½mbda
;

812 
ušt32_t
 
	msùps_pd½mbù
;

813 
ušt32_t
 
	msùps_pd½bw½t
;

815 
ušt32_t
 
	msùps_pd½üu±
;

816 
ušt32_t
 
	msùps_pd½Ãd©
;

817 
ušt32_t
 
	msùps_pd½pdbrk
;

819 
ušt32_t
 
	msùps_pd½t¢nf
;

820 
ušt32_t
 
	msùps_pd½dnâd
;

821 
ušt32_t
 
	msùps_pd½diwÅ
;

822 
ušt32_t
 
	msùps_pd½dizrw
;

823 
ušt32_t
 
	msùps_pd½badd
;

824 
ušt32_t
 
	msùps_pd½m¬k
;

826 
ušt32_t
 
	msùps_timo™”©Ü
;

828 
ušt32_t
 
	msùps_timod©a
;

829 
ušt32_t
 
	msùps_timowšdow´obe
;

831 
ušt32_t
 
	msùps_timoš™
;

832 
ušt32_t
 
	msùps_timo§ck
;

833 
ušt32_t
 
	msùps_timoshutdown
;

835 
ušt32_t
 
	msùps_timoh—¹b—t
;

837 
ušt32_t
 
	msùps_timocook›
;

839 
ušt32_t
 
	msùps_timo£ü‘
;

841 
ušt32_t
 
	msùps_timİ©hmtu
;

842 
ušt32_t
 
	msùps_timoshutdowÇck
;

844 
ušt32_t
 
	msùps_timoshutdowngu¬d
;

846 
ušt32_t
 
	msùps_timo¡rmr¡
;

848 
ušt32_t
 
	msùps_timÛ¬lyä
;

850 
ušt32_t
 
	msùps_timßscÚf
;

852 
ušt32_t
 
	msùps_timod–´im
;

854 
ušt32_t
 
	msùps_timßutoşo£
;

856 
ušt32_t
 
	msùps_timßssockl
;

857 
ušt32_t
 
	msùps_timošpkl
;

859 
ušt32_t
 
	msùps_—¾yä¡¬t
;

860 
ušt32_t
 
	msùps_—¾yä¡İ
;

861 
ušt32_t
 
	msùps_—¾yämrk»Œªs
;

862 
ušt32_t
 
	msùps_—¾yä¡pout
;

863 
ušt32_t
 
	msùps_—¾yä¡pidsck1
;

864 
ušt32_t
 
	msùps_—¾yä¡pidsck2
;

865 
ušt32_t
 
	msùps_—¾yä¡pidsck3
;

866 
ušt32_t
 
	msùps_—¾yä¡pidsck4
;

867 
ušt32_t
 
	msùps_—¾yä¡rid
;

868 
ušt32_t
 
	msùps_—¾yä¡rout
;

869 
ušt32_t
 
	msùps_—¾yä¡¹mr
;

871 
ušt32_t
 
	msùps_hdrİs
;

872 
ušt32_t
 
	msùps_badsum
;

873 
ušt32_t
 
	msùps_nİÜt
;

874 
ušt32_t
 
	msùps_badvg
;

875 
ušt32_t
 
	msùps_badsid
;

876 
ušt32_t
 
	msùps_nomem
;

877 
ušt32_t
 
	msùps_ç¡»Œªsš¹t
;

879 
ušt32_t
 
	msùps_m¬ked»Œªs
;

880 
ušt32_t
 
	msùps_ÇgË£Á
;

881 
ušt32_t
 
	msùps_ÇgËqueued
;

882 
ušt32_t
 
	msùps_maxbur¡queued
;

883 
ušt32_t
 
	msùps_iâomemqueued
;

887 
ušt32_t
 
	msùps_wšdow´obed
;

888 
ušt32_t
 
	msùps_lowËv–”r
;

890 
ušt32_t
 
	msùps_lowËv–”ru¤
;

893 
ušt32_t
 
	msùps_d©adrİchklmt
;

895 
ušt32_t
 
	msùps_d©adrİrwnd
;

897 
ušt32_t
 
	msùps_eú”eduûdcwnd
;

899 
ušt32_t
 
	msùps_vgex´ess
;

900 
ušt32_t
 
	msùps_vgbogus
;

901 
ušt32_t
 
	msùps_´im¬y_¿ndry
;

903 
ušt32_t
 
	msùps_cmt_¿ndry
;

904 
ušt32_t
 
	msùps_¦ow·th_§ck
;

905 
ušt32_t
 
	msùps_wu_§cks_£Á
;

906 
ušt32_t
 
	msùps_£nds_w™h_æags
;

908 
ušt32_t
 
	msùps_£nds_w™h_unÜd
 ;

909 
ušt32_t
 
	msùps_£nds_w™h_eof
;

910 
ušt32_t
 
	msùps_£nds_w™h_abÜt
;

912 
ušt32_t
 
	msùps_´ÙocŞ_d¿š_ÿÎs
;

914 
ušt32_t
 
	msùps_´ÙocŞ_d¿šs_dÚe
;

916 
ušt32_t
 
	msùps_»ad_³eks
;

918 
ušt32_t
 
	msùps_ÿched_chk
;

919 
ušt32_t
 
	msùps_ÿched_¡rmoq
;

920 
ušt32_t
 
	msùps_Ëá_abªdÚ
;

922 
ušt32_t
 
	msùps_£nd_bur¡_avoid
;

925 
ušt32_t
 
	msùps_£nd_cwnd_avoid
;

927 
ušt32_t
 
	msùps_fwdt¢_m­_ov”
;

930 
sùp_timev®
 
	msùps_discÚtšu™ytime
;

934 
	#SCTP_STAT_INCR
(
_x
è
	`SCTP_STAT_INCR_BY
(_x,1)

	)

935 
	#SCTP_STAT_DECR
(
_x
è
	`SCTP_STAT_DECR_BY
(_x,1)

	)

936 
	#SCTP_STAT_INCR_BY
(
_x
,
_d
è
	`©omic_add_št
(&
sùp¡©
._x, _d)

	)

937 
	#SCTP_STAT_DECR_BY
(
_x
,
_d
è
	`©omic_subŒaù_št
(&
sùp¡©
._x, _d)

	)

940 
	#SCTP_STAT_INCR_COUNTER32
(
_x
è
	`SCTP_STAT_INCR
(_x)

	)

941 
	#SCTP_STAT_INCR_COUNTER64
(
_x
è
	`SCTP_STAT_INCR
(_x)

	)

942 
	#SCTP_STAT_INCR_GAUGE32
(
_x
è
	`SCTP_STAT_INCR
(_x)

	)

943 
	#SCTP_STAT_DECR_COUNTER32
(
_x
è
	`SCTP_STAT_DECR
(_x)

	)

944 
	#SCTP_STAT_DECR_COUNTER64
(
_x
è
	`SCTP_STAT_DECR
(_x)

	)

945 
	#SCTP_STAT_DECR_GAUGE32
(
_x
è
	`SCTP_STAT_DECR
(_x)

	)

947 
	usùp_sock¡Üe
 {

948 #ià
defšed
(
INET
è|| !defšed(
_KERNEL
)

949 
sockaddr_š
 
	msš
;

951 #ià
defšed
(
INET6
è|| !defšed(
_KERNEL
)

952 
sockaddr_š6
 
	msš6
;

954 
sockaddr
 
	m§
;

957 
	sxsùp_špcb
 {

958 
ušt32_t
 
	mÏ¡
;

959 
ušt32_t
 
	mæags
;

960 
ušt32_t
 
	mã©u»s
;

961 
ušt32_t
 
	mtÙ®_£nds
;

962 
ušt32_t
 
	mtÙ®_»cvs
;

963 
ušt32_t
 
	mtÙ®_no¥aûs
;

964 
ušt32_t
 
	mäagm’tiÚ_pošt
;

965 
ušt16_t
 
	mloÿl_pÜt
;

966 
ušt16_t
 
	mqËn
;

967 
ušt16_t
 
	mmaxqËn
;

970 
	sxsùp_tcb
 {

971 
sùp_sock¡Üe
 
	m´im¬y_addr
;

972 
ušt32_t
 
	mÏ¡
;

973 
ušt32_t
 
	mh—¹b—t_š‹rv®
;

974 
ušt32_t
 
	m¡©e
;

975 
ušt32_t
 
	mš_¡»ams
;

976 
ušt32_t
 
	mout_¡»ams
;

977 
ušt32_t
 
	mmax_Ä_»Œªs
;

978 
ušt32_t
 
	m´im¬y_´oûss
;

979 
ušt32_t
 
	mT1_expœ”›s
;

980 
ušt32_t
 
	mT2_expœ”›s
;

981 
ušt32_t
 
	m»Œªsm™‹d_t¢s
;

982 
ušt32_t
 
	mtÙ®_£nds
;

983 
ušt32_t
 
	mtÙ®_»cvs
;

984 
ušt32_t
 
	mloÿl_g
;

985 
ušt32_t
 
	m»mÙe_g
;

986 
ušt32_t
 
	mš™Ÿl_t¢
;

987 
ušt32_t
 
	mhighe¡_t¢
;

988 
ušt32_t
 
	mcumuÏtive_t¢
;

989 
ušt32_t
 
	mcumuÏtive_t¢_ack
;

990 
ušt32_t
 
	mmtu
;

991 
ušt32_t
 
	m»fút
;

992 
ušt16_t
 
	mloÿl_pÜt
;

993 
ušt16_t
 
	m»mÙe_pÜt
;

994 
sùp_timev®
 
	m¡¬t_time
;

995 
sùp_timev®
 
	mdiscÚtšu™y_time
;

998 
	sxsùp_Ïddr
 {

999 
sùp_sock¡Üe
 
	madd»ss
;

1000 
ušt32_t
 
	mÏ¡
;

1001 
sùp_timev®
 
	m¡¬t_time
;

1004 
	sxsùp_¿ddr
 {

1005 
sùp_sock¡Üe
 
	madd»ss
;

1006 
ušt32_t
 
	mÏ¡
;

1007 
ušt32_t
 
	m¹o
;

1008 
ušt32_t
 
	mmax_·th_¹x
;

1009 
ušt32_t
 
	m¹x
;

1010 
ušt32_t
 
	m”rÜ_couÁ”
;

1011 
ušt32_t
 
	mcwnd
;

1012 
ušt32_t
 
	mæight_size
;

1013 
ušt32_t
 
	mmtu
;

1014 
ušt8_t
 
	maùive
;

1015 
ušt8_t
 
	mcÚfœmed
;

1016 
ušt8_t
 
	mh—¹b—t_’abËd
;

1017 
sùp_timev®
 
	m¡¬t_time
;

1020 
	#SCTP_MAX_LOGGING_SIZE
 30000

	)

1021 
	#SCTP_TRACE_PARAMS
 6

	)

1023 
	ssùp_log_’Œy
 {

1024 
ušt64_t
 
	mtime¡amp
;

1025 
ušt32_t
 
	msubsys
;

1026 
ušt32_t
 
	m·ddšg
;

1027 
ušt32_t
 
	m·¿ms
[
SCTP_TRACE_PARAMS
];

1030 
	ssùp_log
 {

1031 
sùp_log_’Œy
 
	m’Œy
[
SCTP_MAX_LOGGING_SIZE
];

1032 
ušt32_t
 
	mšdex
;

1033 
ušt32_t
 
	m·ddšg
;

1039 #ià
defšed
(
_KERNEL
)

1041 
sùp_low”_so£nd
(
sock‘
 *
so
,

1042 
sockaddr
 *
addr
,

1043 
uio
 *uio,

1044 
mbuf
 *
i_·k
,

1045 
mbuf
 *
cÚŒŞ
,

1046 
æags
,

1047 
u£_rcvšfo
,

1048 
sùp_¢drcvšfo
 *
¤cv


1049 ,
th»ad
 *
p


1053 
sùp_sÜecvmsg
(
sock‘
 *
so
,

1054 
uio
 *uio,

1055 
mbuf
 **
mp
,

1056 
sockaddr
 *
äom
,

1057 
äomËn
,

1058 *
msg_æags
,

1059 
sùp_¢drcvšfo
 *
sšfo
,

1060 
flšg_sšfo
);

1067 #ià!(
defšed
(
_KERNEL
))

1069 
__BEGIN_DECLS


1070 
sùp_³–off
 
__P
((, 
sùp_assoc_t
));

1071 
sùp_bšdx
 
__P
((, 
sockaddr
 *, , ));

1072 
sùp_cÚÃùx
 
__P
((, cÚ¡ 
sockaddr
 *, , 
sùp_assoc_t
 *));

1073 
sùp_g‘add¾’
 
__P
((
§_çmy_t
));

1074 
sùp_g‘·ddrs
 
__P
((, 
sùp_assoc_t
, 
sockaddr
 **));

1075 
sùp_ä“·ddrs
 
__P
((
sockaddr
 *));

1076 
sùp_g‘Ïddrs
 
__P
((, 
sùp_assoc_t
, 
sockaddr
 **));

1077 
sùp_ä“Ïddrs
 
__P
((
sockaddr
 *));

1078 
sùp_İt_šfo
 
__P
((, 
sùp_assoc_t
, , *, 
sockËn_t
 *));

1080 
ssize_t
 
sùp_£ndmsg


1081 
__P
((, cÚ¡ *, 
size_t
,

1082 cÚ¡ 
sockaddr
 *,

1083 
sockËn_t
, 
ušt32_t
, ušt32_t, 
ušt16_t
, uint32_t, uint32_t));

1085 
ssize_t
 
sùp_£nd
 
__P
((
sd
, cÚ¡ *
msg
, 
size_t
 
Ën
,

1086 cÚ¡ 
sùp_¢drcvšfo
 *
sšfo
, 
æags
));

1088 
ssize_t
 
sùp_£ndx
 
__P
((
sd
, cÚ¡ *
msg
, 
size_t
 
Ën
,

1089 
sockaddr
 *
addrs
, 
addrút
,

1090 
sùp_¢drcvšfo
 *
sšfo
, 
æags
));

1092 
ssize_t
 
sùp_£ndmsgx
 
__P
((
sd
, cÚ¡ *, 
size_t
,

1093 
sockaddr
 *, ,

1094 
ušt32_t
, ušt32_t, 
ušt16_t
, uint32_t, uint32_t));

1096 
sùp_assoc_t
 
sùp_g‘associd
 
__P
((
sd
, 
sockaddr
 *
§
));

1098 
ssize_t
 
sùp_»cvmsg
 
__P
((, *, 
size_t
, 
sockaddr
 *,

1099 
sockËn_t
 *, 
sùp_¢drcvšfo
 *, *));

1101 
	g__END_DECLS


	@/usr/include/netinet6/in6.h

64 #iâdeà
__KAME_NETINET_IN_H_INCLUDED_


68 #iâdeà
_NETINET6_IN6_H_


69 
	#_NETINET6_IN6_H_


	)

76 
	#__KAME__


	)

77 
	#__KAME_VERSION
 "F»eBSD"

	)

84 #ià
__BSD_VISIBLE


85 
	#IPV6PORT_RESERVED
 1024

	)

86 
	#IPV6PORT_ANONMIN
 49152

	)

87 
	#IPV6PORT_ANONMAX
 65535

	)

88 
	#IPV6PORT_RESERVEDMIN
 600

	)

89 
	#IPV6PORT_RESERVEDMAX
 (
IPV6PORT_RESERVED
-1)

	)

95 
	sš6_addr
 {

97 
ušt8_t
 
	m__u6_addr8
[16];

98 
ušt16_t
 
	m__u6_addr16
[8];

99 
ušt32_t
 
	m__u6_addr32
[4];

100 } 
	m__u6_addr
;

103 
	#s6_addr
 
__u6_addr
.
__u6_addr8


	)

104 #ifdeà
_KERNEL


105 
	#s6_addr8
 
__u6_addr
.
__u6_addr8


	)

106 
	#s6_addr16
 
__u6_addr
.
__u6_addr16


	)

107 
	#s6_addr32
 
__u6_addr
.
__u6_addr32


	)

110 
	#INET6_ADDRSTRLEN
 46

	)

119 #ià
__BSD_VISIBLE


120 
	#SIN6_LEN


	)

123 
	ssockaddr_š6
 {

124 
ušt8_t
 
	msš6_Ën
;

125 
§_çmy_t
 
	msš6_çmy
;

126 
š_pÜt_t
 
	msš6_pÜt
;

127 
ušt32_t
 
	msš6_æowšfo
;

128 
š6_addr
 
	msš6_addr
;

129 
ušt32_t
 
	msš6_scİe_id
;

135 #ifdeà
_KERNEL


136 
	#IN6MASK0
 {{{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }}}

	)

137 
	#IN6MASK32
 {{{ 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, \

138 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }}}

	)

139 
	#IN6MASK64
 {{{ 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, \

140 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }}}

	)

141 
	#IN6MASK96
 {{{ 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, \

142 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00 }}}

	)

143 
	#IN6MASK128
 {{{ 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, \

144 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xfà}}}

	)

147 #ifdeà
_KERNEL


148 cÚ¡ 
sockaddr_š6
 
§6_ªy
;

150 cÚ¡ 
š6_addr
 
š6mask0
;

151 cÚ¡ 
š6_addr
 
š6mask32
;

152 cÚ¡ 
š6_addr
 
š6mask64
;

153 cÚ¡ 
š6_addr
 
š6mask96
;

154 cÚ¡ 
š6_addr
 
š6mask128
;

160 #ifdeà
_KERNEL


161 #ià
_BYTE_ORDER
 =ğ
_BIG_ENDIAN


162 
	#IPV6_ADDR_INT32_ONE
 1

	)

163 
	#IPV6_ADDR_INT32_TWO
 2

	)

164 
	#IPV6_ADDR_INT32_MNL
 0xff010000

	)

165 
	#IPV6_ADDR_INT32_MLL
 0xff020000

	)

166 
	#IPV6_ADDR_INT32_SMP
 0x0000ffff

	)

167 
	#IPV6_ADDR_INT16_ULL
 0xã80

	)

168 
	#IPV6_ADDR_INT16_USL
 0xãc0

	)

169 
	#IPV6_ADDR_INT16_MLL
 0xff02

	)

170 #–ià
_BYTE_ORDER
 =ğ
_LITTLE_ENDIAN


171 
	#IPV6_ADDR_INT32_ONE
 0x01000000

	)

172 
	#IPV6_ADDR_INT32_TWO
 0x02000000

	)

173 
	#IPV6_ADDR_INT32_MNL
 0x000001ff

	)

174 
	#IPV6_ADDR_INT32_MLL
 0x000002ff

	)

175 
	#IPV6_ADDR_INT32_SMP
 0xffff0000

	)

176 
	#IPV6_ADDR_INT16_ULL
 0x80ã

	)

177 
	#IPV6_ADDR_INT16_USL
 0xc0ã

	)

178 
	#IPV6_ADDR_INT16_MLL
 0x02ff

	)

185 #ià
__BSD_VISIBLE


186 
	#IN6ADDR_ANY_INIT
 \

188 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }}}

	)

189 
	#IN6ADDR_LOOPBACK_INIT
 \

191 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01 }}}

	)

192 
	#IN6ADDR_NODELOCAL_ALLNODES_INIT
 \

194 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01 }}}

	)

195 
	#IN6ADDR_INTFACELOCAL_ALLNODES_INIT
 \

197 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01 }}}

	)

198 
	#IN6ADDR_LINKLOCAL_ALLNODES_INIT
 \

200 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01 }}}

	)

201 
	#IN6ADDR_LINKLOCAL_ALLROUTERS_INIT
 \

203 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02 }}}

	)

206 cÚ¡ 
š6_addr
 
š6addr_ªy
;

207 cÚ¡ 
š6_addr
 
š6addr_loİback
;

208 #ià
__BSD_VISIBLE


209 cÚ¡ 
š6_addr
 
š6addr_nod–oÿl_®Êodes
;

210 cÚ¡ 
š6_addr
 
š6addr_lškloÿl_®Êodes
;

211 cÚ¡ 
š6_addr
 
š6addr_lškloÿl_®Ìou‹rs
;

220 #ifdeà
_KERNEL


221 
	#IN6_ARE_ADDR_EQUAL
(
a
, 
b
) \

222 (
	`bcmp
(&(
a
)->
s6_addr
[0], &(
b
)->s6_addr[0], (
š6_addr
)è=ğ0)

	)

224 #ià
__BSD_VISIBLE


225 
	#IN6_ARE_ADDR_EQUAL
(
a
, 
b
) \

226 (
	`memcmp
(&(
a
)->
s6_addr
[0], &(
b
)->s6_addr[0], (
š6_addr
)è=ğ0)

	)

233 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

234 ((*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[0]) == 0) && \

235 (*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[4]) == 0) && \

236 (*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[8]) == 0) && \

237 (*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[12]è=ğ0))

	)

242 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

243 ((*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[0]) == 0) && \

244 (*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[4]) == 0) && \

245 (*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[8]) == 0) && \

246 (*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[12]è=ğ
	`Áohl
(1)))

	)

251 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

252 ((*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[0]) == 0) && \

253 (*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[4]) == 0) && \

254 (*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[8]) == 0) && \

255 (*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[12]) != 0) && \

256 (*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[12]è!ğ
	`Áohl
(1)))

	)

261 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

262 ((*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[0]) == 0) && \

263 (*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[4]) == 0) && \

264 (*(cÚ¡ 
u_št32_t
 *)(cÚ¡ *)(&(
a
)->
s6_addr
[8]è=ğ
	`Áohl
(0x0000ffff)))

	)

270 #ifdeà
_KERNEL


271 
	#IPV6_ADDR_SCOPE_NODELOCAL
 0x01

	)

272 
	#IPV6_ADDR_SCOPE_INTFACELOCAL
 0x01

	)

273 
	#IPV6_ADDR_SCOPE_LINKLOCAL
 0x02

	)

274 
	#IPV6_ADDR_SCOPE_SITELOCAL
 0x05

	)

275 
	#IPV6_ADDR_SCOPE_ORGLOCAL
 0x08

	)

276 
	#IPV6_ADDR_SCOPE_GLOBAL
 0x0e

	)

278 
	#__IPV6_ADDR_SCOPE_NODELOCAL
 0x01

	)

279 
	#__IPV6_ADDR_SCOPE_INTFACELOCAL
 0x01

	)

280 
	#__IPV6_ADDR_SCOPE_LINKLOCAL
 0x02

	)

281 
	#__IPV6_ADDR_SCOPE_SITELOCAL
 0x05

	)

282 
	#__IPV6_ADDR_SCOPE_ORGLOCAL
 0x08

	)

283 
	#__IPV6_ADDR_SCOPE_GLOBAL
 0x0e

	)

290 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

291 (((
a
)->
s6_addr
[0] =ğ0xãè&& ((×)->s6_addr[1] & 0xc0è=ğ0x80))

	)

292 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

293 (((
a
)->
s6_addr
[0] =ğ0xãè&& ((×)->s6_addr[1] & 0xc0è=ğ0xc0))

	)

298 
	#IN6_IS_ADDR_MULTICAST
(
a
è(×)->
s6_addr
[0] =ğ0xff)

	)

300 #ifdeà
_KERNEL


301 
	#IPV6_ADDR_MC_SCOPE
(
a
è(×)->
s6_addr
[1] & 0x0f)

	)

303 
	#__IPV6_ADDR_MC_SCOPE
(
a
è(×)->
s6_addr
[1] & 0x0f)

	)

309 #ifdeà
_KERNEL


310 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

311 (
	`IN6_IS_ADDR_MULTICAST
(
a
) && \

312 (
	`IPV6_ADDR_MC_SCOPE
(
a
è=ğ
IPV6_ADDR_SCOPE_NODELOCAL
))

	)

313 
	#IN6_IS_ADDR_MC_INTFACELOCAL
(
a
) \

314 (
	`IN6_IS_ADDR_MULTICAST
(
a
) && \

315 (
	`IPV6_ADDR_MC_SCOPE
(
a
è=ğ
IPV6_ADDR_SCOPE_INTFACELOCAL
))

	)

316 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

317 (
	`IN6_IS_ADDR_MULTICAST
(
a
) && \

318 (
	`IPV6_ADDR_MC_SCOPE
(
a
è=ğ
IPV6_ADDR_SCOPE_LINKLOCAL
))

	)

319 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

320 (
	`IN6_IS_ADDR_MULTICAST
(
a
) && \

321 (
	`IPV6_ADDR_MC_SCOPE
(
a
è=ğ
IPV6_ADDR_SCOPE_SITELOCAL
))

	)

322 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

323 (
	`IN6_IS_ADDR_MULTICAST
(
a
) && \

324 (
	`IPV6_ADDR_MC_SCOPE
(
a
è=ğ
IPV6_ADDR_SCOPE_ORGLOCAL
))

	)

325 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

326 (
	`IN6_IS_ADDR_MULTICAST
(
a
) && \

327 (
	`IPV6_ADDR_MC_SCOPE
(
a
è=ğ
IPV6_ADDR_SCOPE_GLOBAL
))

	)

329 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

330 (
	`IN6_IS_ADDR_MULTICAST
(
a
) && \

331 (
	`__IPV6_ADDR_MC_SCOPE
(
a
è=ğ
__IPV6_ADDR_SCOPE_NODELOCAL
))

	)

332 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

333 (
	`IN6_IS_ADDR_MULTICAST
(
a
) && \

334 (
	`__IPV6_ADDR_MC_SCOPE
(
a
è=ğ
__IPV6_ADDR_SCOPE_LINKLOCAL
))

	)

335 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

336 (
	`IN6_IS_ADDR_MULTICAST
(
a
) && \

337 (
	`__IPV6_ADDR_MC_SCOPE
(
a
è=ğ
__IPV6_ADDR_SCOPE_SITELOCAL
))

	)

338 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

339 (
	`IN6_IS_ADDR_MULTICAST
(
a
) && \

340 (
	`__IPV6_ADDR_MC_SCOPE
(
a
è=ğ
__IPV6_ADDR_SCOPE_ORGLOCAL
))

	)

341 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

342 (
	`IN6_IS_ADDR_MULTICAST
(
a
) && \

343 (
	`__IPV6_ADDR_MC_SCOPE
(
a
è=ğ
__IPV6_ADDR_SCOPE_GLOBAL
))

	)

346 #ifdeà
_KERNEL


350 
	#IN6_IS_SCOPE_LINKLOCAL
(
a
) \

351 ((
	`IN6_IS_ADDR_LINKLOCAL
(
a
)) || \

352 (
	`IN6_IS_ADDR_MC_LINKLOCAL
(
a
)))

	)

353 
	#IN6_IS_SCOPE_EMBED
(
a
) \

354 ((
	`IN6_IS_ADDR_LINKLOCAL
(
a
)) || \

355 (
	`IN6_IS_ADDR_MC_LINKLOCAL
(
a
)) || \

356 (
	`IN6_IS_ADDR_MC_INTFACELOCAL
(
a
)))

	)

358 
	#IFA6_IS_DEPRECATED
(
a
) \

359 ((
a
)->
Ÿ6_liãtime
.
Ÿ6t_¶time
 !ğ
ND6_INFINITE_LIFETIME
 && \

360 (
u_št32_t
)((
time_£cÚd
 - (
a
)->
Ÿ6_upd©‘ime
)) > \

361 (
a
)->
Ÿ6_liãtime
.
Ÿ6t_¶time
)

	)

362 
	#IFA6_IS_INVALID
(
a
) \

363 ((
a
)->
Ÿ6_liãtime
.
Ÿ6t_vÉime
 !ğ
ND6_INFINITE_LIFETIME
 && \

364 (
u_št32_t
)((
time_£cÚd
 - (
a
)->
Ÿ6_upd©‘ime
)) > \

365 (
a
)->
Ÿ6_liãtime
.
Ÿ6t_vÉime
)

	)

371 #ià
__BSD_VISIBLE


372 
	srou‹_š6
 {

373 
¹’Œy
 *
	mro_¹
;

374 
sockaddr_š6
 
	mro_d¡
;

384 
	#IPV6_OPTIONS
 1

	)

385 
	#IPV6_RECVOPTS
 5

	)

386 
	#IPV6_RECVRETOPTS
 6

	)

387 
	#IPV6_RECVDSTADDR
 7

	)

388 
	#IPV6_RETOPTS
 8

	)

390 
	#IPV6_SOCKOPT_RESERVED1
 3

	)

391 
	#IPV6_UNICAST_HOPS
 4

	)

392 
	#IPV6_MULTICAST_IF
 9

	)

393 
	#IPV6_MULTICAST_HOPS
 10

	)

394 
	#IPV6_MULTICAST_LOOP
 11

	)

395 
	#IPV6_JOIN_GROUP
 12

	)

396 
	#IPV6_LEAVE_GROUP
 13

	)

397 
	#IPV6_PORTRANGE
 14

	)

398 
	#ICMP6_FILTER
 18

	)

400 #ifdeà
_KERNEL


401 
	#IPV6_2292PKTINFO
 19

	)

402 
	#IPV6_2292HOPLIMIT
 20

	)

403 
	#IPV6_2292NEXTHOP
 21

	)

404 
	#IPV6_2292HOPOPTS
 22

	)

405 
	#IPV6_2292DSTOPTS
 23

	)

406 
	#IPV6_2292RTHDR
 24

	)

407 
	#IPV6_2292PKTOPTIONS
 25

	)

410 
	#IPV6_CHECKSUM
 26

	)

411 
	#IPV6_V6ONLY
 27

	)

412 #iâdeà
_KERNEL


413 
	#IPV6_BINDV6ONLY
 
IPV6_V6ONLY


	)

417 
	#IPV6_IPSEC_POLICY
 28

	)

420 
	#IPV6_FAITH
 29

	)

423 
	#IPV6_FW_ADD
 30

	)

424 
	#IPV6_FW_DEL
 31

	)

425 
	#IPV6_FW_FLUSH
 32

	)

426 
	#IPV6_FW_ZERO
 33

	)

427 
	#IPV6_FW_GET
 34

	)

431 
	#IPV6_RTHDRDSTOPTS
 35

	)

433 
	#IPV6_RECVPKTINFO
 36

	)

434 
	#IPV6_RECVHOPLIMIT
 37

	)

435 
	#IPV6_RECVRTHDR
 38

	)

436 
	#IPV6_RECVHOPOPTS
 39

	)

437 
	#IPV6_RECVDSTOPTS
 40

	)

438 #ifdeà
_KERNEL


439 
	#IPV6_RECVRTHDRDSTOPTS
 41

	)

442 
	#IPV6_USE_MIN_MTU
 42

	)

443 
	#IPV6_RECVPATHMTU
 43

	)

445 
	#IPV6_PATHMTU
 44

	)

448 
	#IPV6_REACHCONF
 45

	)

453 
	#IPV6_PKTINFO
 46

	)

454 
	#IPV6_HOPLIMIT
 47

	)

455 
	#IPV6_NEXTHOP
 48

	)

456 
	#IPV6_HOPOPTS
 49

	)

457 
	#IPV6_DSTOPTS
 50

	)

458 
	#IPV6_RTHDR
 51

	)

460 
	#IPV6_PKTOPTIONS
 52

	)

464 
	#IPV6_RECVTCLASS
 57

	)

466 
	#IPV6_AUTOFLOWLABEL
 59

	)

468 
	#IPV6_TCLASS
 61

	)

469 
	#IPV6_DONTFRAG
 62

	)

471 
	#IPV6_PREFER_TEMPADDR
 63

	)

479 
	#IPV6_MSFILTER
 74

	)

485 
	#IPV6_RTHDR_LOOSE
 0

	)

486 
	#IPV6_RTHDR_STRICT
 1

	)

487 
	#IPV6_RTHDR_TYPE_0
 0

	)

492 
	#IPV6_DEFAULT_MULTICAST_HOPS
 1

	)

493 
	#IPV6_DEFAULT_MULTICAST_LOOP
 1

	)

498 
	sv6_m»q
 {

499 
š6_addr
 
	mv6mr_muÉŸddr
;

500 
	mv6mr_š‹rçû
;

503 #ifdeà
nÙy‘


508 
	sv6_m»q_sourû
 {

509 
š6_addr
 
	mv6mr_muÉŸddr
;

510 
š6_addr
 
	mv6mr_sourûaddr
;

511 
ušt32_t
 
	mv6mr_š‹rçû
;

518 
	sš6_pktšfo
 {

519 
š6_addr
 
	mi6_addr
;

520 
	mi6_ifšdex
;

526 
	s6_mtušfo
 {

527 
sockaddr_š6
 
	m6m_addr
;

528 
ušt32_t
 
	m6m_mtu
;

535 
	#IPV6_PORTRANGE_DEFAULT
 0

	)

536 
	#IPV6_PORTRANGE_HIGH
 1

	)

537 
	#IPV6_PORTRANGE_LOW
 2

	)

539 #ià
__BSD_VISIBLE


546 
	#IPV6PROTO_MAXID
 (
IPPROTO_PIM
 + 1è

	)

551 
	#IPV6CTL_FORWARDING
 1

	)

552 
	#IPV6CTL_SENDREDIRECTS
 2

	)

553 
	#IPV6CTL_DEFHLIM
 3

	)

554 #ifdeà
nÙy‘


555 
	#IPV6CTL_DEFMTU
 4

	)

557 
	#IPV6CTL_FORWSRCRT
 5

	)

558 
	#IPV6CTL_STATS
 6

	)

559 
	#IPV6CTL_MRTSTATS
 7

	)

560 
	#IPV6CTL_MRTPROTO
 8

	)

561 
	#IPV6CTL_MAXFRAGPACKETS
 9

	)

562 
	#IPV6CTL_SOURCECHECK
 10

	)

563 
	#IPV6CTL_SOURCECHECK_LOGINT
 11

	)

564 
	#IPV6CTL_ACCEPT_RTADV
 12

	)

565 
	#IPV6CTL_KEEPFAITH
 13

	)

566 
	#IPV6CTL_LOG_INTERVAL
 14

	)

567 
	#IPV6CTL_HDRNESTLIMIT
 15

	)

568 
	#IPV6CTL_DAD_COUNT
 16

	)

569 
	#IPV6CTL_AUTO_FLOWLABEL
 17

	)

570 
	#IPV6CTL_DEFMCASTHLIM
 18

	)

571 
	#IPV6CTL_GIF_HLIM
 19

	)

572 
	#IPV6CTL_KAME_VERSION
 20

	)

573 
	#IPV6CTL_USE_DEPRECATED
 21

	)

574 
	#IPV6CTL_RR_PRUNE
 22

	)

576 
	#IPV6CTL_MAPPED_ADDR
 23

	)

578 
	#IPV6CTL_V6ONLY
 24

	)

579 
	#IPV6CTL_RTEXPIRE
 25

	)

580 
	#IPV6CTL_RTMINEXPIRE
 26

	)

581 
	#IPV6CTL_RTMAXCACHE
 27

	)

583 
	#IPV6CTL_USETEMPADDR
 32

	)

584 
	#IPV6CTL_TEMPPLTIME
 33

	)

585 
	#IPV6CTL_TEMPVLTIME
 34

	)

586 
	#IPV6CTL_AUTO_LINKLOCAL
 35

	)

587 
	#IPV6CTL_RIP6STATS
 36

	)

588 
	#IPV6CTL_PREFER_TEMPADDR
 37

	)

589 
	#IPV6CTL_ADDRCTLPOLICY
 38

	)

590 
	#IPV6CTL_USE_DEFAULTZONE
 39

	)

592 
	#IPV6CTL_MAXFRAGS
 41

	)

594 
	#IPV6CTL_IFQ
 42

	)

595 
	#IPV6CTL_ISATAPRTR
 43

	)

597 
	#IPV6CTL_MCAST_PMTU
 44

	)

601 
	#IPV6CTL_STEALTH
 45

	)

602 
	#IPV6CTL_MAXID
 46

	)

608 
	#M_AUTHIPHDR
 
M_PROTO2


	)

609 
	#M_DECRYPTED
 
M_PROTO3


	)

610 
	#M_LOOP
 
M_PROTO4


	)

611 
	#M_AUTHIPDGM
 
M_PROTO5


	)

613 #ifdeà
_KERNEL


614 
	gcmsghdr
;

616 
š6_cksum
 
__P
((
mbuf
 *, 
u_št8_t
, 
u_št32_t
, u_int32_t));

617 
š6_loÿÏddr
 
__P
((
š6_addr
 *));

618 
š6_addrscİe
 
__P
((
š6_addr
 *));

619 
š6_içddr
 *
š6_içw™hiå
 
__P
((
iâ‘
 *, 
š6_addr
 *));

620 
š6_if_up
 
__P
((
iâ‘
 *));

621 
	gsockaddr
;

622 
u_ch¬
 
6_´Ùox
[];

624 
š6_sš6_2_sš
 
__P
((
sockaddr_š
 *
sš
,

625 
sockaddr_š6
 *
sš6
));

626 
š6_sš_2_v4m­sš6
 
__P
((
sockaddr_š
 *
sš
,

627 
sockaddr_š6
 *
sš6
));

628 
š6_sš6_2_sš_š_sock
 
__P
((
sockaddr
 *
Çm
));

629 
š6_sš_2_v4m­sš6_š_sock
 
__P
((
sockaddr
 **
Çm
));

630 
addr£l_pŞicy_š™
 
__P
(());

632 
	#§tosš6
(
§
è((
sockaddr_š6
 *)(§))

	)

633 
	#sš6to§
(
sš6
è((
sockaddr
 *)(sš6))

	)

634 
	#içtoŸ6
(
iç
è((
š6_içddr
 *)(iç))

	)

636 (*
ç™h´efix_p
)(
š6_addr
 *);

639 #iâdeà
_SIZE_T_DECLARED


640 
__size_t
 
	tsize_t
;

641 
	#_SIZE_T_DECLARED


	)

644 #iâdeà
_SOCKLEN_T_DECLARED


645 
__sockËn_t
 
	tsockËn_t
;

646 
	#_SOCKLEN_T_DECLARED


	)

649 #ià
__BSD_VISIBLE


651 
__BEGIN_DECLS


652 
cmsghdr
;

654 
š‘6_İtiÚ_¥aû
 
	`__P
(());

655 
š‘6_İtiÚ_š™
 
	`__P
((*, 
cmsghdr
 **, ));

656 
š‘6_İtiÚ_­³nd
 
	`__P
((
cmsghdr
 *, cÚ¡ 
ušt8_t
 *,

658 
ušt8_t
 *
š‘6_İtiÚ_®loc
 
	`__P
((
cmsghdr
 *, , , ));

659 
š‘6_İtiÚ_Ãxt
 
	`__P
((cÚ¡ 
cmsghdr
 *, 
ušt8_t
 **));

660 
š‘6_İtiÚ_fšd
 
	`__P
((cÚ¡ 
cmsghdr
 *, 
ušt8_t
 **, ));

662 
size_t
 
š‘6_¹hdr_¥aû
 
	`__P
((, ));

663 
cmsghdr
 *
š‘6_¹hdr_š™
 
	`__P
((*, ));

664 
š‘6_¹hdr_add
 
	`__P
((
cmsghdr
 *, cÚ¡ 
š6_addr
 *,

666 
š‘6_¹hdr_Ï¡hİ
 
	`__P
((
cmsghdr
 *, ));

668 
š‘6_¹hdr_»v”£
 
	`__P
((cÚ¡ 
cmsghdr
 *, cmsghdr *));

670 
š‘6_¹hdr_£gm’ts
 
	`__P
((cÚ¡ 
cmsghdr
 *));

671 
š6_addr
 *
š‘6_¹hdr_g‘addr
 
	`__P
((
cmsghdr
 *, ));

672 
š‘6_¹hdr_g‘æags
 
	`__P
((cÚ¡ 
cmsghdr
 *, ));

674 
š‘6_İt_š™
 
	`__P
((*, 
sockËn_t
));

675 
š‘6_İt_­³nd
 
	`__P
((*, 
sockËn_t
, , 
ušt8_t
, socklen_t,

676 
ušt8_t
, **));

677 
š‘6_İt_fšish
 
	`__P
((*, 
sockËn_t
, ));

678 
š‘6_İt_£t_v®
 
	`__P
((*, , *, 
sockËn_t
));

680 
š‘6_İt_Ãxt
 
	`__P
((*, 
sockËn_t
, , 
ušt8_t
 *, socklen_t *,

682 
š‘6_İt_fšd
 
	`__P
((*, 
sockËn_t
, , 
ušt8_t
, socklen_t *,

684 
š‘6_İt_g‘_v®
 
	`__P
((*, , *, 
sockËn_t
));

685 
sockËn_t
 
š‘6_¹h_¥aû
 
	`__P
((, ));

686 *
š‘6_¹h_š™
 
	`__P
((*, 
sockËn_t
, , ));

687 
š‘6_¹h_add
 
	`__P
((*, cÚ¡ 
š6_addr
 *));

688 
š‘6_¹h_»v”£
 
	`__P
((const *, *));

689 
š‘6_¹h_£gm’ts
 
	`__P
((const *));

690 
š6_addr
 *
š‘6_¹h_g‘addr
 
	`__P
((const *, ));

691 
__END_DECLS


	@/usr/include/sys/_iovec.h

33 #iâdeà
_SYS__IOVEC_H_


34 
	#_SYS__IOVEC_H_


	)

36 
	~<sys/_ty³s.h
>

38 #iâdeà
_SIZE_T_DECLARED


39 
__size_t
 
	tsize_t
;

40 
	#_SIZE_T_DECLARED


	)

43 
	siovec
 {

44 *
	miov_ba£
;

45 
size_t
 
	miov_Ën
;

	@/usr/include/sys/_null.h

29 #iâdeà
NULL


31 #ià
defšed
(
_KERNEL
è|| !defšed(
__ılu¥lus
)

32 
	#NULL
 ((*)0)

	)

34 #ià
defšed
(
__LP64__
)

35 
	#NULL
 (0L)

	)

37 
	#NULL
 0

	)

	@/usr/include/sys/_pthreadtypes.h

36 #iâdeà
_SYS__PTHREADTYPES_H_


37 
	#_SYS__PTHREADTYPES_H_


	)

44 
	g±h»ad
;

45 
	g±h»ad_©Œ
;

46 
	g±h»ad_cÚd
;

47 
	g±h»ad_cÚd_©Œ
;

48 
	g±h»ad_mu‹x
;

49 
	g±h»ad_mu‹x_©Œ
;

50 
	g±h»ad_Úû
;

51 
	g±h»ad_rwlock
;

52 
	g±h»ad_rwlock©Œ
;

53 
	g±h»ad_b¬r›r
;

54 
	g±h»ad_b¬r›r_©Œ
;

55 
	g±h»ad_¥šlock
;

64 
±h»ad
 *
	t±h»ad_t
;

65 
±h»ad_©Œ
 *
	t±h»ad_©Œ_t
;

66 
±h»ad_mu‹x
 *
	t±h»ad_mu‹x_t
;

67 
±h»ad_mu‹x_©Œ
 *
	t±h»ad_mu‹x©Œ_t
;

68 
±h»ad_cÚd
 *
	t±h»ad_cÚd_t
;

69 
±h»ad_cÚd_©Œ
 *
	t±h»ad_cÚd©Œ_t
;

70 
	t±h»ad_key_t
;

71 
±h»ad_Úû
 
	t±h»ad_Úû_t
;

72 
±h»ad_rwlock
 *
	t±h»ad_rwlock_t
;

73 
±h»ad_rwlock©Œ
 *
	t±h»ad_rwlock©Œ_t
;

74 
±h»ad_b¬r›r
 *
	t±h»ad_b¬r›r_t
;

75 
±h»ad_b¬r›¿‰r
 *
	t±h»ad_b¬r›¿‰r_t
;

76 
±h»ad_¥šlock
 *
	t±h»ad_¥šlock_t
;

84 *
	t±h»ad_addr_t
;

85 *(*
	t±h»ad_¡¬Œoutše_t
)(*);

90 
	s±h»ad_Úû
 {

91 
	m¡©e
;

92 
±h»ad_mu‹x_t
 
	mmu‹x
;

	@/usr/include/sys/_timeval.h

29 #iâdeà
_SYS__TIMEVAL_H_


30 
	#_SYS__TIMEVAL_H_


	)

32 
	~<sys/_ty³s.h
>

34 #iâdeà
_SUSECONDS_T_DECLARED


35 
__su£cÚds_t
 
	tsu£cÚds_t
;

36 
	#_SUSECONDS_T_DECLARED


	)

39 #iâdeà
_TIME_T_DECLARED


40 
__time_t
 
	ttime_t
;

41 
	#_TIME_T_DECLARED


	)

47 
	stimev®
 {

48 
time_t
 
	mtv_£c
;

49 
su£cÚds_t
 
	mtv_u£c
;

	@/usr/include/sys/_types.h

29 #iâdeà
_SYS__TYPES_H_


30 
	#_SYS__TYPES_H_


	)

32 
	~<sys/cdefs.h
>

33 
	~<machše/_ty³s.h
>

38 
__ušt32_t
 
	t__blksize_t
;

39 
__št64_t
 
	t__blkút_t
;

40 
__št32_t
 
	t__şockid_t
;

41 
__ušt32_t
 
	t__fæags_t
;

42 
__ušt64_t
 
	t__fsblkút_t
;

43 
__ušt64_t
 
	t__fsfút_t
;

44 
__ušt32_t
 
	t__gid_t
;

45 
__št64_t
 
	t__id_t
;

46 
__ušt32_t
 
	t__šo_t
;

47 
	t__key_t
;

48 
__št32_t
 
	t__lwpid_t
;

49 
__ušt16_t
 
	t__mode_t
;

50 
	t__Æ_™em
;

51 
__ušt16_t
 
	t__Æšk_t
;

52 
__št64_t
 
	t__off_t
;

53 
__št32_t
 
	t__pid_t
;

54 
__št64_t
 
	t__¾im_t
;

57 
__ušt8_t
 
	t__§_çmy_t
;

58 
__ušt32_t
 
	t__sockËn_t
;

59 
	t__su£cÚds_t
;

60 
__tim”
 *
	t__tim”_t
;

61 
__mq
 *
	t__mqd_t
;

62 
__ušt32_t
 
	t__uid_t
;

63 
	t__u£cÚds_t
;

83 
	t__ù_ruÃ_t
;

84 
__ù_ruÃ_t
 
	t__ruÃ_t
;

85 
__ù_ruÃ_t
 
	t__wch¬_t
;

86 
__ù_ruÃ_t
 
	t__wšt_t
;

88 
__ušt32_t
 
	t__dev_t
;

90 
__ušt32_t
 
	t__fix±_t
;

97 
	m__mb¡©e8
[128];

98 
__št64_t
 
	m_mb¡©eL
;

99 } 
	t__mb¡©e_t
;

	@/usr/include/sys/cdefs.h

36 #iâdef 
_SYS_CDEFS_H_


37 
	#_SYS_CDEFS_H_


	)

39 #ià
defšed
(
__ılu¥lus
)

40 
	#__BEGIN_DECLS
 "C" {

	)

41 
	#__END_DECLS
 }

	)

43 
	#__BEGIN_DECLS


	)

44 
	#__END_DECLS


	)

53 #ià
defšed
(
__GNUC__
è|| defšed(
__INTEL_COMPILER
)

55 #ià
__GNUC__
 >ğ3 || 
defšed
(
__INTEL_COMPILER
)

56 
	#__GNUCLIKE_ASM
 3

	)

57 
	#__GNUCLIKE_MATH_BUILTIN_CONSTANTS


	)

59 
	#__GNUCLIKE_ASM
 2

	)

61 
	#__GNUCLIKE___TYPEOF
 1

	)

62 
	#__GNUCLIKE___OFFSETOF
 1

	)

63 
	#__GNUCLIKE___SECTION
 1

	)

65 
	#__GNUCLIKE_ATTRIBUTE_MODE_DI
 1

	)

67 #iâdeà
__INTEL_COMPILER


68 
	#__GNUCLIKE_CTOR_SECTION_HANDLING
 1

	)

71 
	#__GNUCLIKE_BUILTIN_CONSTANT_P
 1

	)

72 #ià
defšed
(
__INTEL_COMPILER
è&& defšed(
__ılu¥lus
) \

73 && 
__INTEL_COMPILER
 < 800

74 #undeà
__GNUCLIKE_BUILTIN_CONSTANT_P


77 #ià(
__GNUC_MINOR__
 > 95 || 
__GNUC__
 >ğ3è&& !
defšed
(
__INTEL_COMPILER
)

78 
	#__GNUCLIKE_BUILTIN_VARARGS
 1

	)

79 
	#__GNUCLIKE_BUILTIN_STDARG
 1

	)

80 
	#__GNUCLIKE_BUILTIN_VAALIST
 1

	)

83 #ià
defšed
(
__GNUC__
)

84 
	#__GNUC_VA_LIST_COMPATIBILITY
 1

	)

87 #iâdeà
__INTEL_COMPILER


88 
	#__GNUCLIKE_BUILTIN_NEXT_ARG
 1

	)

89 
	#__GNUCLIKE_MATH_BUILTIN_RELOPS


	)

92 
	#__GNUCLIKE_BUILTIN_MEMCPY
 1

	)

95 
	#__CC_SUPPORTS_INLINE
 1

	)

96 
	#__CC_SUPPORTS___INLINE
 1

	)

97 
	#__CC_SUPPORTS___INLINE__
 1

	)

99 
	#__CC_SUPPORTS___FUNC__
 1

	)

100 
	#__CC_SUPPORTS_WARNING
 1

	)

102 
	#__CC_SUPPORTS_VARADIC_XXX
 1

	)

104 
	#__CC_SUPPORTS_DYNAMIC_ARRAY_INIT
 1

	)

107 
	#__CC_INT_IS_32BIT
 1

	)

114 #ià
defšed
(
__GNUC__
è&& !defšed(
__INTEL_COMPILER
)

115 
	#__GNUC_PREREQ__
(
ma
, 
mi
) \

116 (
__GNUC__
 > (
ma
è|| __GNUC__ =ğ(maè&& 
__GNUC_MINOR__
 >ğ(
mi
))

	)

118 
	#__GNUC_PREREQ__
(
ma
, 
mi
è0

	)

133 #ià
defšed
(
__STDC__
è|| defšed(
__ılu¥lus
)

134 
	#__P
(
´Ùos
è´Ùo 

	)

135 
	#__CONCAT1
(
x
,
y
èx ## 
	)
y

136 
	#__CONCAT
(
x
,
y
è
	`__CONCAT1
(x,y)

	)

137 
	#__STRING
(
x
è#x

	)

138 
	#__XSTRING
(
x
è
	`__STRING
(xè

	)

140 
	#__cÚ¡
 cÚ¡

	)

141 
	#__sigÃd
 sigÃd

	)

142 
	#__vŞ©e
 vŞ©e

	)

143 #ià
defšed
(
__ılu¥lus
)

144 
	#__šlše
 
šlše


	)

146 #ià!(
defšed
(
__CC_SUPPORTS___INLINE
))

147 
	#__šlše


	)

152 
	#__P
(
´Ùos
è(è

	)

153 
	#__CONCAT
(
x
,
y
èx 
	)
y

154 
	#__STRING
(
x
è"x"

	)

156 #ià!
defšed
(
__CC_SUPPORTS___INLINE
)

157 
	#__cÚ¡


	)

158 
	#__šlše


	)

159 
	#__sigÃd


	)

160 
	#__vŞ©e


	)

169 #iâdef 
NO_ANSI_KEYWORDS


170 cÚ¡

	)

171 
	#šlše


	)

172 sigÃd

	)

173 vŞ©e

	)

187 #ifdeà
lšt


188 
	#__d—d2


	)

189 
	#__pu»2


	)

190 
	#__unu£d


	)

191 
	#__·cked


	)

192 
	#__®igÃd
(
x
)

	)

193 
	#__£ùiÚ
(
x
)

	)

195 #ià!
__GNUC_PREREQ__
(2, 5è&& !
defšed
(
__INTEL_COMPILER
)

196 
	#__d—d2


	)

197 
	#__pu»2


	)

198 
	#__unu£d


	)

200 #ià
__GNUC__
 =ğ2 && 
__GNUC_MINOR__
 >ğ5 && __GNUC_MINOR__ < 7 && !
defšed
(
__INTEL_COMPILER
)

201 
	#__d—d2
 
	`__©Œibu‹__
((
__nÜ‘uº__
))

	)

202 
	#__pu»2
 
	`__©Œibu‹__
((
__cÚ¡__
))

	)

203 
	#__unu£d


	)

206 #ià
__GNUC_PREREQ__
(2, 7)

207 
	#__d—d2
 
	`__©Œibu‹__
((
__nÜ‘uº__
))

	)

208 
	#__pu»2
 
	`__©Œibu‹__
((
__cÚ¡__
))

	)

209 
	#__unu£d
 
	`__©Œibu‹__
((
__unu£d__
))

	)

210 
	#__u£d
 
	`__©Œibu‹__
((
__u£d__
))

	)

211 
	#__·cked
 
	`__©Œibu‹__
((
__·cked__
))

	)

212 
	#__®igÃd
(
x
è
	`__©Œibu‹__
((
	`__®igÃd__
(x)))

	)

213 
	#__£ùiÚ
(
x
è
	`__©Œibu‹__
((
	`__£ùiÚ__
(x)))

	)

215 #ià
defšed
(
__INTEL_COMPILER
)

216 
	#__d—d2
 
	`__©Œibu‹__
((
__nÜ‘uº__
))

	)

217 
	#__pu»2
 
	`__©Œibu‹__
((
__cÚ¡__
))

	)

218 
	#__unu£d
 
	`__©Œibu‹__
((
__unu£d__
))

	)

219 
	#__u£d
 
	`__©Œibu‹__
((
__u£d__
))

	)

220 
	#__·cked
 
	`__©Œibu‹__
((
__·cked__
))

	)

221 
	#__®igÃd
(
x
è
	`__©Œibu‹__
((
	`__®igÃd__
(x)))

	)

222 
	#__£ùiÚ
(
x
è
	`__©Œibu‹__
((
	`__£ùiÚ__
(x)))

	)

226 #ià
__GNUC_PREREQ__
(2, 96)

227 
	#__pu»
 
	`__©Œibu‹__
((
__pu»__
))

	)

229 
	#__pu»


	)

232 #ià
__GNUC_PREREQ__
(3, 1è|| (
defšed
(
__INTEL_COMPILER
) && __INTEL_COMPILER >= 800)

233 
	#__®ways_šlše
 
	`__©Œibu‹__
((
__®ways_šlše__
))

	)

235 
	#__®ways_šlše


	)

238 #ià
__GNUC_PREREQ__
(3, 3)

239 
	#__nÚnuÎ
(
x
è
	`__©Œibu‹__
((
	`__nÚnuÎ__
(x)))

	)

241 
	#__nÚnuÎ
(
x
)

	)

245 #ià!
__GNUC_PREREQ__
(2, 7è&& !
defšed
(
__INTEL_COMPILER
)

246 
	#__func__
 
NULL


	)

249 #ià(
defšed
(
__INTEL_COMPILER
è|| (defšed(
__GNUC__
è&& __GNUC__ >ğ2)è&& !defšed(
__STRICT_ANSI__
è|| 
__STDC_VERSION__
 >= 199901

250 
	#__LONG_LONG_SUPPORTED


	)

259 #ià!(
__GNUC__
 =ğ2 && 
__GNUC_MINOR__
 == 95)

260 #ià!
defšed
(
__STDC_VERSION__
) || __STDC_VERSION__ < 199901

261 
	#__»¡riù


	)

263 
	#__»¡riù
 
»¡riù


	)

295 #ià
__GNUC_PREREQ__
(2, 96)

296 
	#__´ediù_Œue
(
exp
è
	`__butš_ex³ù
(Óxp), 1)

	)

297 
	#__´ediù_çl£
(
exp
è
	`__butš_ex³ù
(Óxp), 0)

	)

299 
	#__´ediù_Œue
(
exp
èÓxp)

	)

300 
	#__´ediù_çl£
(
exp
èÓxp)

	)

307 #ià
__GNUC_PREREQ__
(4, 1)

308 
	#__off£tof
(
ty³
, 
f›ld
è
	`__butš_off£tof
Ñy³, f›ld)

	)

310 #iâdeà
__ılu¥lus


311 
	#__off£tof
(
ty³
, 
f›ld
è((
size_t
)(&(Ñy³ *)0)->f›ld))

	)

313 
	#__off£tof
(
ty³
, 
f›ld
) \

314 (
	`__off£tof__
 (
»š‹½»t_ÿ¡
 <
size_t
> \

315 (&
»š‹½»t_ÿ¡
 <const volatile &> \

316 (
¡©ic_ÿ¡
<
ty³
 *> (0)->
f›ld
))))

	)

319 
	#__¿ngeof
(
ty³
, 
¡¬t
, 
’d
) \

320 (
	`__off£tof
(
ty³
, 
’d
è- __off£tofÑy³, 
¡¬t
))

	)

328 #ià!
__GNUC_PREREQ__
(2, 7è&& !
defšed
(
__INTEL_COMPILER
)

329 
	#__´štæike
(
fmrg
, 
fœ¡v¬¬g
)

	)

330 
	#__sÿnæike
(
fmrg
, 
fœ¡v¬¬g
)

	)

331 
	#__fÜm©_¬g
(
fmrg
)

	)

333 
	#__´štæike
(
fmrg
, 
fœ¡v¬¬g
) \

334 
	`__©Œibu‹__
((
	`__fÜm©__
 (
__´štf__
, 
fmrg
, 
fœ¡v¬¬g
)))

	)

335 
	#__sÿnæike
(
fmrg
, 
fœ¡v¬¬g
) \

336 
	`__©Œibu‹__
((
	`__fÜm©__
 (
__sÿnf__
, 
fmrg
, 
fœ¡v¬¬g
)))

	)

337 
	#__fÜm©_¬g
(
fmrg
è
	`__©Œibu‹__
((
	`__fÜm©_¬g__
 (fmrg)))

	)

341 #ià
__F»eBSD_cc_v”siÚ
 >ğ300001 && 
defšed
(
__GNUC__
è&& !defšed(
__INTEL_COMPILER
)

342 
	#__´štf0like
(
fmrg
, 
fœ¡v¬¬g
) \

343 
	`__©Œibu‹__
((
	`__fÜm©__
 (
__´štf0__
, 
fmrg
, 
fœ¡v¬¬g
)))

	)

345 
	#__´štf0like
(
fmrg
, 
fœ¡v¬¬g
)

	)

348 #ià
defšed
(
__GNUC__
è|| defšed(
__INTEL_COMPILER
)

349 #iâdeà
__INTEL_COMPILER


350 
	#__¡rÚg_»ã»nû
(
sym
,
®Ÿssym
) \

351 
	`__ty³of
 (
sym
è
®Ÿssym
 
	`__©Œibu‹__
 ((
	`__®Ÿs__
 (#sym)))

	)

353 #ifdeà
__STDC__


354 
	#__w—k_»ã»nû
(
sym
,
®Ÿs
) \

355 
	`__asm__
(".weak " #alias); \

356 
	`__asm__
(".equ " #®Ÿ ", " #sym)

	)

357 
	#__w¬n_»ã»nûs
(
sym
,
msg
) \

358 
	`__asm__
(".section .gnu.warning." #sym); \

359 
	`__asm__
(".asciz \"" 
msg
 "\""); \

360 
	`__asm__
(".´evious")

	)

361 
	#__sym_com·t
(
sym
,
im¶
,
v”id
) \

362 
	`__asm__
(".symv” " #im¶ ", " #sym "@" #v”id)

	)

363 
	#__sym_deçuÉ
(
sym
,
im¶
,
v”id
) \

364 
	`__asm__
(".symv” " #im¶ ", " #sym "@@" #v”id)

	)

366 
	#__w—k_»ã»nû
(
sym
,
®Ÿs
) \

367 
	`__asm__
(".weak‡lias"); \

368 
	`__asm__
(".equ‡lŸs, sym")

	)

369 
	#__w¬n_»ã»nûs
(
sym
,
msg
) \

370 
	`__asm__
(".section .gnu.warning.sym"); \

371 
	`__asm__
(".asciz \"msg\""); \

372 
	`__asm__
(".´evious")

	)

373 
	#__sym_com·t
(
sym
,
im¶
,
v”id
) \

374 
	`__asm__
(".symv” im¶, sym@v”id")

	)

375 
	#__sym_deçuÉ
(
im¶
,
sym
,
v”id
) \

376 
	`__asm__
(".symv” im¶, sym@@v”id")

	)

380 #ià
defšed
(
__GNUC__
è|| defšed(
__INTEL_COMPILER
)

381 
	#__IDSTRING
(
Çme
,
¡ršg
è
	`__asm__
(".id’t\t\"" sŒšg "\"")

	)

389 
	#__IDSTRING
(
Çme
,
¡ršg
ècÚ¡ Çme[] 
__unu£d
 = 
	)
string

398 #iâdef 
__FBSDID


399 #ià!
defšed
(
lšt
è&& !defšed(
STRIP_FBSDID
)

400 
	#__FBSDID
(
s
è
	`__IDSTRING
(
	`__CONCAT
(
__rcsid_
,
__LINE__
),s)

	)

402 
	#__FBSDID
(
s
è
__hack


	)

406 #iâdef 
__RCSID


407 #iâdef 
NO__RCSID


408 
	#__RCSID
(
s
è
	`__IDSTRING
(
	`__CONCAT
(
__rcsid_
,
__LINE__
),s)

	)

410 
	#__RCSID
(
s
è
__hack


	)

414 #iâdef 
__RCSID_SOURCE


415 #iâdef 
NO__RCSID_SOURCE


416 
	#__RCSID_SOURCE
(
s
è
	`__IDSTRING
(
	`__CONCAT
(
__rcsid_sourû_
,
__LINE__
),s)

	)

418 
	#__RCSID_SOURCE
(
s
è
__hack


	)

422 #iâdef 
__SCCSID


423 #iâdef 
NO__SCCSID


424 
	#__SCCSID
(
s
è
	`__IDSTRING
(
	`__CONCAT
(
__sccsid_
,
__LINE__
),s)

	)

426 
	#__SCCSID
(
s
è
__hack


	)

430 #iâdef 
__COPYRIGHT


431 #iâdef 
NO__COPYRIGHT


432 
	#__COPYRIGHT
(
s
è
	`__IDSTRING
(
	`__CONCAT
(
__cİyright_
,
__LINE__
),s)

	)

434 
	#__COPYRIGHT
(
s
è
__hack


	)

438 #iâdef 
__DECONST


439 
	#__DECONST
(
ty³
, 
v¬
è(Ñy³)(
ušŒ_t
)(cÚ¡ *)(v¬))

	)

442 #iâdef 
__DEVOLATILE


443 
	#__DEVOLATILE
(
ty³
, 
v¬
è(Ñy³)(
ušŒ_t
)(vŞ©*)(v¬))

	)

446 #iâdef 
__DEQUALIFY


447 
	#__DEQUALIFY
(
ty³
, 
v¬
è(Ñy³)(
ušŒ_t
)(cÚ¡ vŞ©*)(v¬))

	)

473 #ià
defšed
(
_POSIX_C_SOURCE
) && _POSIX_C_SOURCE == 1

474 #undeà
_POSIX_C_SOURCE


475 
	#_POSIX_C_SOURCE
 199009

	)

479 #ià
defšed
(
_POSIX_C_SOURCE
) && _POSIX_C_SOURCE == 2

480 #undeà
_POSIX_C_SOURCE


481 
	#_POSIX_C_SOURCE
 199209

	)

485 #ifdeà
_XOPEN_SOURCE


486 #ià
_XOPEN_SOURCE
 - 0 >= 600

487 
	#__XSI_VISIBLE
 600

	)

488 #undeà
_POSIX_C_SOURCE


489 
	#_POSIX_C_SOURCE
 200112

	)

490 #–ià
_XOPEN_SOURCE
 - 0 >= 500

491 
	#__XSI_VISIBLE
 500

	)

492 #undeà
_POSIX_C_SOURCE


493 
	#_POSIX_C_SOURCE
 199506

	)

501 #ià
defšed
(
_POSIX_SOURCE
è&& !defšed(
_POSIX_C_SOURCE
)

502 
	#_POSIX_C_SOURCE
 198808

	)

504 #ifdeà
_POSIX_C_SOURCE


505 #ià
_POSIX_C_SOURCE
 >= 200112

506 
	#__POSIX_VISIBLE
 200112

	)

507 
	#__ISO_C_VISIBLE
 1999

	)

508 #–ià
_POSIX_C_SOURCE
 >= 199506

509 
	#__POSIX_VISIBLE
 199506

	)

510 
	#__ISO_C_VISIBLE
 1990

	)

511 #–ià
_POSIX_C_SOURCE
 >= 199309

512 
	#__POSIX_VISIBLE
 199309

	)

513 
	#__ISO_C_VISIBLE
 1990

	)

514 #–ià
_POSIX_C_SOURCE
 >= 199209

515 
	#__POSIX_VISIBLE
 199209

	)

516 
	#__ISO_C_VISIBLE
 1990

	)

517 #–ià
_POSIX_C_SOURCE
 >= 199009

518 
	#__POSIX_VISIBLE
 199009

	)

519 
	#__ISO_C_VISIBLE
 1990

	)

521 
	#__POSIX_VISIBLE
 198808

	)

522 
	#__ISO_C_VISIBLE
 0

	)

537 #ià
defšed
(
_ANSI_SOURCE
)

538 
	#__POSIX_VISIBLE
 0

	)

539 
	#__XSI_VISIBLE
 0

	)

540 
	#__BSD_VISIBLE
 0

	)

541 
	#__ISO_C_VISIBLE
 1990

	)

542 #–ià
defšed
(
_C99_SOURCE
)

543 
	#__POSIX_VISIBLE
 0

	)

544 
	#__XSI_VISIBLE
 0

	)

545 
	#__BSD_VISIBLE
 0

	)

546 
	#__ISO_C_VISIBLE
 1999

	)

548 
	#__POSIX_VISIBLE
 200112

	)

549 
	#__XSI_VISIBLE
 600

	)

550 
	#__BSD_VISIBLE
 1

	)

551 
	#__ISO_C_VISIBLE
 1999

	)

	@/usr/include/sys/select.h

32 #iâdeà
_SYS_SELECT_H_


33 
	#_SYS_SELECT_H_


	)

35 
	~<sys/cdefs.h
>

36 
	~<sys/_ty³s.h
>

38 
	~<sys/_sig£t.h
>

39 
	~<sys/_timev®.h
>

40 
	~<sys/time¥ec.h
>

42 
	t__fd_mask
;

43 #ià
__BSD_VISIBLE


44 
__fd_mask
 
	tfd_mask
;

47 #iâdeà
_SIGSET_T_DECLARED


48 
	#_SIGSET_T_DECLARED


	)

49 
__sig£t_t
 
	tsig£t_t
;

58 #iâdef 
FD_SETSIZE


59 
	#FD_SETSIZE
 1024U

	)

62 
	#_NFDBITS
 ((
__fd_mask
è* 8è

	)

63 #ià
__BSD_VISIBLE


64 
	#NFDBITS
 
_NFDBITS


	)

67 #iâdeà
_howmªy


68 
	#_howmªy
(
x
, 
y
è(((xè+ ((yè- 1)è/ (y))

	)

71 
	sfd_£t
 {

72 
__fd_mask
 
	m__fds_b™s
[
_howmªy
(
FD_SETSIZE
, 
_NFDBITS
)];

73 } 
	tfd_£t
;

74 #ià
__BSD_VISIBLE


75 
	#fds_b™s
 
__fds_b™s


	)

78 
	#__fd£t_mask
(
n
è((
__fd_mask
)1 << (Òè% 
_NFDBITS
))

	)

79 
	#FD_CLR
(
n
, 
p
è(Õ)->
__fds_b™s
[Ò)/
_NFDBITS
] &ğ~
	`__fd£t_mask
Ò))

	)

80 #ià
__BSD_VISIBLE


81 
	#FD_COPY
(
f
, 
t
è()(*Ñèğ*(f))

	)

83 
	#FD_ISSET
(
n
, 
p
è((Õ)->
__fds_b™s
[Ò)/
_NFDBITS
] & 
	`__fd£t_mask
Ò)è!ğ0)

	)

84 
	#FD_SET
(
n
, 
p
è(Õ)->
__fds_b™s
[Ò)/
_NFDBITS
] |ğ
	`__fd£t_mask
Ò))

	)

85 
	#FD_ZERO
(
p
) do { \

86 
fd_£t
 *
_p
; \

87 
__size_t
 
_n
; \

89 
_p
 = (
p
); \

90 
_n
 = 
	`_howmªy
(
FD_SETSIZE
, 
_NFDBITS
); \

91 
_n
 > 0) \

92 
_p
->
__fds_b™s
[--
_n
] = 0; \

93 } 0)

	)

95 #iâdeà
_KERNEL


97 
__BEGIN_DECLS


98 
p£Ëù
(, 
fd_£t
 *
__»¡riù
, fd_set *__restrict, fd_set *__restrict,

99 cÚ¡ 
time¥ec
 *
__»¡riù
, cÚ¡ 
sig£t_t
 *__restrict);

100 #iâdeà
_SELECT_DECLARED


101 
	#_SELECT_DECLARED


	)

103 
£Ëù
(, 
fd_£t
 *, fd_£ˆ*, fd_£ˆ*, 
timev®
 *);

105 
	g__END_DECLS


	@/usr/include/sys/timespec.h

38 #iâdeà
_SYS_TIMESPEC_H_


39 
	#_SYS_TIMESPEC_H_


	)

41 #iâdeà
_TIME_T_DECLARED


42 
__time_t
 
	ttime_t
;

43 
	#_TIME_T_DECLARED


	)

46 
	stime¥ec
 {

47 
time_t
 
	mtv_£c
;

48 
	mtv_n£c
;

51 #ià
__BSD_VISIBLE


52 
	#TIMEVAL_TO_TIMESPEC
(
tv
, 
ts
) \

54 (
ts
)->
tv_£c
 = (
tv
)->tv_sec; \

55 (
ts
)->
tv_n£c
 = (
tv
)->
tv_u£c
 * 1000; \

56 } 0)

	)

57 
	#TIMESPEC_TO_TIMEVAL
(
tv
, 
ts
) \

59 (
tv
)->
tv_£c
 = (
ts
)->tv_sec; \

60 (
tv
)->
tv_u£c
 = (
ts
)->
tv_n£c
 / 1000; \

61 } 0)

	)

69 
	s™im”¥ec
 {

70 
time¥ec
 
	m™_š‹rv®
;

71 
time¥ec
 
	m™_v®ue
;

	@/usr/include/sys/unistd.h

33 #iâdeà
_SYS_UNISTD_H_


34 
	#_SYS_UNISTD_H_


	)

36 
	~<sys/cdefs.h
>

52 
	#_POSIX_ADVISORY_INFO
 -1

	)

53 
	#_POSIX_ASYNCHRONOUS_IO
 0

	)

54 
	#_POSIX_CHOWN_RESTRICTED
 1

	)

55 
	#_POSIX_CLOCK_SELECTION
 -1

	)

56 
	#_POSIX_CPUTIME
 -1

	)

57 
	#_POSIX_FSYNC
 200112L

	)

58 
	#_POSIX_IPV6
 0

	)

59 
	#_POSIX_JOB_CONTROL
 1

	)

60 
	#_POSIX_MAPPED_FILES
 200112L

	)

61 
	#_POSIX_MEMLOCK
 -1

	)

62 
	#_POSIX_MEMLOCK_RANGE
 200112L

	)

63 
	#_POSIX_MEMORY_PROTECTION
 200112L

	)

64 
	#_POSIX_MESSAGE_PASSING
 200112L

	)

65 
	#_POSIX_MONOTONIC_CLOCK
 200112L

	)

66 
	#_POSIX_NO_TRUNC
 1

	)

67 
	#_POSIX_PRIORITIZED_IO
 -1

	)

68 
	#_POSIX_PRIORITY_SCHEDULING
 200112L

	)

69 
	#_POSIX_RAW_SOCKETS
 200112L

	)

70 
	#_POSIX_REALTIME_SIGNALS
 200112L

	)

71 
	#_POSIX_SEMAPHORES
 -1

	)

72 
	#_POSIX_SHARED_MEMORY_OBJECTS
 200112L

	)

73 
	#_POSIX_SPORADIC_SERVER
 -1

	)

74 
	#_POSIX_SYNCHRONIZED_IO
 -1

	)

75 
	#_POSIX_TIMEOUTS
 200112L

	)

76 
	#_POSIX_TIMERS
 200112L

	)

77 
	#_POSIX_TYPED_MEMORY_OBJECTS
 -1

	)

78 
	#_POSIX_VDISABLE
 0xff

	)

80 #ià
__XSI_VISIBLE


81 
	#_XOPEN_SHM
 1

	)

82 
	#_XOPEN_STREAMS
 -1

	)

92 #ifdef 
_NOT_AVAILABLE


93 
	#_POSIX_SAVED_IDS
 1

	)

97 
	#_POSIX_VERSION
 200112L

	)

100 
	#F_OK
 0

	)

101 
	#X_OK
 0x01

	)

102 
	#W_OK
 0x02

	)

103 
	#R_OK
 0x04

	)

106 #iâdeà
SEEK_SET


107 
	#SEEK_SET
 0

	)

108 
	#SEEK_CUR
 1

	)

109 
	#SEEK_END
 2

	)

111 #ià
__BSD_VISIBLE


112 
	#SEEK_DATA
 3

	)

113 
	#SEEK_HOLE
 4

	)

116 #iâdeà
_POSIX_SOURCE


118 
	#L_SET
 
SEEK_SET


	)

119 
	#L_INCR
 
SEEK_CUR


	)

120 
	#L_XTND
 
SEEK_END


	)

124 
	#_PC_LINK_MAX
 1

	)

125 
	#_PC_MAX_CANON
 2

	)

126 
	#_PC_MAX_INPUT
 3

	)

127 
	#_PC_NAME_MAX
 4

	)

128 
	#_PC_PATH_MAX
 5

	)

129 
	#_PC_PIPE_BUF
 6

	)

130 
	#_PC_CHOWN_RESTRICTED
 7

	)

131 
	#_PC_NO_TRUNC
 8

	)

132 
	#_PC_VDISABLE
 9

	)

134 #ià
__POSIX_VISIBLE
 >= 199309

135 
	#_PC_ASYNC_IO
 53

	)

136 
	#_PC_PRIO_IO
 54

	)

137 
	#_PC_SYNC_IO
 55

	)

140 #ià
__POSIX_VISIBLE
 >= 200112

141 
	#_PC_ALLOC_SIZE_MIN
 10

	)

142 
	#_PC_FILESIZEBITS
 12

	)

143 
	#_PC_REC_INCR_XFER_SIZE
 14

	)

144 
	#_PC_REC_MAX_XFER_SIZE
 15

	)

145 
	#_PC_REC_MIN_XFER_SIZE
 16

	)

146 
	#_PC_REC_XFER_ALIGN
 17

	)

147 
	#_PC_SYMLINK_MAX
 18

	)

150 #ià
__BSD_VISIBLE


151 
	#_PC_ACL_EXTENDED
 59

	)

152 
	#_PC_ACL_PATH_MAX
 60

	)

153 
	#_PC_CAP_PRESENT
 61

	)

154 
	#_PC_INF_PRESENT
 62

	)

155 
	#_PC_MAC_PRESENT
 63

	)

159 
	#_PC_MIN_HOLE_SIZE
 21

	)

161 #ià
__BSD_VISIBLE


167 
	#RFNAMEG
 (1<<0è

	)

168 
	#RFENVG
 (1<<1è

	)

169 
	#RFFDG
 (1<<2è

	)

170 
	#RFNOTEG
 (1<<3è

	)

171 
	#RFPROC
 (1<<4è

	)

172 
	#RFMEM
 (1<<5è

	)

173 
	#RFNOWAIT
 (1<<6è

	)

174 
	#RFCNAMEG
 (1<<10è

	)

175 
	#RFCENVG
 (1<<11è

	)

176 
	#RFCFDG
 (1<<12è

	)

177 
	#RFTHREAD
 (1<<13è

	)

178 
	#RFSIGSHARE
 (1<<14è

	)

179 
	#RFLINUXTHPN
 (1<<16è

	)

180 
	#RFSTOPPED
 (1<<17è

	)

181 
	#RFHIGHPID
 (1<<18è

	)

182 
	#RFPPWAIT
 (1<<31è

	)

183 
	#RFKERNELONLY
 (
RFSTOPPED
 | 
RFHIGHPID
 | 
RFPPWAIT
)

	)

	@/usr/include/time.h

45 #iâdeà
_TIME_H_


46 
	#_TIME_H_


	)

48 
	~<sys/cdefs.h
>

49 
	~<sys/_nuÎ.h
>

50 
	~<sys/_ty³s.h
>

52 #ià
__POSIX_VISIBLE
 > 0 && __POSIX_VISIBLE < 200112 || 
__BSD_VISIBLE


57 
	#CLK_TCK
 128

	)

61 
	#CLOCKS_PER_SEC
 128

	)

63 #iâdeà
_CLOCK_T_DECLARED


64 
__şock_t
 
	tşock_t
;

65 
	#_CLOCK_T_DECLARED


	)

68 #iâdeà
_TIME_T_DECLARED


69 
__time_t
 
	ttime_t
;

70 
	#_TIME_T_DECLARED


	)

73 #iâdeà
_SIZE_T_DECLARED


74 
__size_t
 
	tsize_t
;

75 
	#_SIZE_T_DECLARED


	)

78 #ià
__POSIX_VISIBLE
 >= 199309

82 #iâdeà
_CLOCKID_T_DECLARED


83 
__şockid_t
 
	tşockid_t
;

84 
	#_CLOCKID_T_DECLARED


	)

87 #iâdeà
_TIMER_T_DECLARED


88 
__tim”_t
 
	ttim”_t
;

89 
	#_TIMER_T_DECLARED


	)

92 
	~<sys/time¥ec.h
>

96 #ià!
defšed
(
CLOCK_REALTIME
è&& 
__POSIX_VISIBLE
 >= 200112

97 
	#CLOCK_REALTIME
 0

	)

98 #ifdeà
__BSD_VISIBLE


99 
	#CLOCK_VIRTUAL
 1

	)

100 
	#CLOCK_PROF
 2

	)

102 
	#CLOCK_MONOTONIC
 4

	)

103 
	#CLOCK_UPTIME
 5

	)

104 
	#CLOCK_UPTIME_PRECISE
 7

	)

105 
	#CLOCK_UPTIME_FAST
 8

	)

106 
	#CLOCK_REALTIME_PRECISE
 9

	)

107 
	#CLOCK_REALTIME_FAST
 10

	)

108 
	#CLOCK_MONOTONIC_PRECISE
 11

	)

109 
	#CLOCK_MONOTONIC_FAST
 12

	)

110 
	#CLOCK_SECOND
 13

	)

113 #ià!
defšed
(
TIMER_ABSTIME
è&& 
__POSIX_VISIBLE
 >= 200112

114 #ià
__BSD_VISIBLE


115 
	#TIMER_RELTIME
 0x0

	)

117 
	#TIMER_ABSTIME
 0x1

	)

120 
	stm
 {

121 
	mtm_£c
;

122 
	mtm_mš
;

123 
	mtm_hour
;

124 
	mtm_mday
;

125 
	mtm_mÚ
;

126 
	mtm_y—r
;

127 
	mtm_wday
;

128 
	mtm_yday
;

129 
	mtm_isd¡
;

130 
	mtm_gmtoff
;

131 *
	mtm_zÚe
;

134 #ià
__POSIX_VISIBLE


135 *
tzÇme
[];

138 
__BEGIN_DECLS


139 *
asùime
(cÚ¡ 
tm
 *);

140 
şock_t
 
şock
();

141 *
ùime
(cÚ¡ 
time_t
 *);

142 
difáime
(
time_t
,ime_t);

144 
tm
 *
gmtime
(cÚ¡ 
time_t
 *);

145 
tm
 *
loÿÉime
(cÚ¡ 
time_t
 *);

146 
time_t
 
mktime
(
tm
 *);

147 
size_t
 
¡ráime
(* 
__»¡riù
, size_t, const * __restrict,

148 cÚ¡ 
tm
 * 
__»¡riù
);

149 
time_t
 
time
(time_t *);

150 #ià
__POSIX_VISIBLE
 >= 200112

151 
	gsigev’t
;

152 
tim”_ü—‹
(
şockid_t
, 
sigev’t
 *
__»¡riù
, 
tim”_t
 *__restrict);

153 
tim”_d–‘e
(
tim”_t
);

154 
tim”_g‘time
(
tim”_t
, 
™im”¥ec
 *);

155 
tim”_g‘ov”run
(
tim”_t
);

156 
tim”_£‰ime
(
tim”_t
, , cÚ¡ 
™im”¥ec
 *
__»¡riù
,

157 
™im”¥ec
 *
__»¡riù
);

159 #ià
__POSIX_VISIBLE


160 
tz£t
();

163 #ià
__POSIX_VISIBLE
 >= 199309

164 
şock_g‘»s
(
şockid_t
, 
time¥ec
 *);

165 
şock_g‘time
(
şockid_t
, 
time¥ec
 *);

166 
şock_£‰ime
(
şockid_t
, cÚ¡ 
time¥ec
 *);

168 
Çno¦“p
(cÚ¡ 
time¥ec
 *, timespec *);

171 #ià
__POSIX_VISIBLE
 >= 199506

172 *
asùime_r
(cÚ¡ 
tm
 *, *);

173 *
ùime_r
(cÚ¡ 
time_t
 *, *);

174 
tm
 *
gmtime_r
(cÚ¡ 
time_t
 *, tm *);

175 
tm
 *
loÿÉime_r
(cÚ¡ 
time_t
 *, tm *);

178 #ià
__XSI_VISIBLE


179 *
¡½time
(cÚ¡ * 
__»¡riù
, const * __restrict,

180 
tm
 * 
__»¡riù
);

183 #ià
__BSD_VISIBLE


184 *
timezÚe
(, );

185 
tz£tw®l
();

186 
time_t
 
tim–oÿl
(
tm
 * const);

187 
time_t
 
timegm
(
tm
 * const);

189 
	g__END_DECLS


	@/usr/include/machine/_types.h

39 #iâdeà
_MACHINE__TYPES_H_


40 
	#_MACHINE__TYPES_H_


	)

42 #iâdeà
_SYS_CDEFS_H_


43 #”rÜ 
this
 
fe
 
Ãeds
 
sys
/
cdefs
.
h
 
as
 
a
 
´”equis™e


46 
	#__NO_STRICT_ALIGNMENT


	)

51 
__sigÃd
 
	t__št8_t
;

52 
	t__ušt8_t
;

53 
	t__št16_t
;

54 
	t__ušt16_t
;

55 
	t__št32_t
;

56 
	t__ušt32_t
;

58 #ià
defšed
(
lšt
)

60 
	t__št64_t
;

62 
	t__ušt64_t
;

63 #–ià
defšed
(
__GNUCLIKE_ATTRIBUTE_MODE_DI
)

64 
	t__©Œibu‹__
((
	t__mode__
(
	t__DI__
))è
	t__št64_t
;

65 
	t__©Œibu‹__
((
	t__mode__
(
	t__DI__
))è
	t__ušt64_t
;

68 
	t__št64_t
;

70 
	t__ušt64_t
;

76 
	t__şock_t
;

77 
	t__ıumask_t
;

78 
__št32_t
 
	t__ü™iÿl_t
;

79 
	t__doubË_t
;

80 
	t__æßt_t
;

81 
__št32_t
 
	t__štåŒ_t
;

82 
__št64_t
 
	t__štmax_t
;

83 
__št32_t
 
	t__šŒ_t
;

84 
__št32_t
 
	t__št_ç¡8_t
;

85 
__št32_t
 
	t__št_ç¡16_t
;

86 
__št32_t
 
	t__št_ç¡32_t
;

87 
__št64_t
 
	t__št_ç¡64_t
;

88 
__št8_t
 
	t__št_Ëa¡8_t
;

89 
__št16_t
 
	t__št_Ëa¡16_t
;

90 
__št32_t
 
	t__št_Ëa¡32_t
;

91 
__št64_t
 
	t__št_Ëa¡64_t
;

92 
__št32_t
 
	t__±rdiff_t
;

93 
__št32_t
 
	t__»gi¡”_t
;

94 
__št32_t
 
	t__£gsz_t
;

95 
__ušt32_t
 
	t__size_t
;

96 
__št32_t
 
	t__ssize_t
;

97 
__št32_t
 
	t__time_t
;

98 
__ušt32_t
 
	t__uštåŒ_t
;

99 
__ušt64_t
 
	t__uštmax_t
;

100 
__ušt32_t
 
	t__ušŒ_t
;

101 
__ušt32_t
 
	t__ušt_ç¡8_t
;

102 
__ušt32_t
 
	t__ušt_ç¡16_t
;

103 
__ušt32_t
 
	t__ušt_ç¡32_t
;

104 
__ušt64_t
 
	t__ušt_ç¡64_t
;

105 
__ušt8_t
 
	t__ušt_Ëa¡8_t
;

106 
__ušt16_t
 
	t__ušt_Ëa¡16_t
;

107 
__ušt32_t
 
	t__ušt_Ëa¡32_t
;

108 
__ušt64_t
 
	t__ušt_Ëa¡64_t
;

109 
__ušt32_t
 
	t__u_»gi¡”_t
;

110 
__ušt32_t
 
	t__vm_off£t_t
;

111 
__št64_t
 
	t__vm_ooff£t_t
;

112 #ifdeà
PAE


113 
__ušt64_t
 
	t__vm_·ddr_t
;

115 
__ušt32_t
 
	t__vm_·ddr_t
;

117 
__ušt64_t
 
	t__vm_pšdex_t
;

118 
__ušt32_t
 
	t__vm_size_t
;

123 #ifdeà
__GNUCLIKE_BUILTIN_VARARGS


124 
__butš_va_li¡
 
	t__va_li¡
;

126 * 
	t__va_li¡
;

128 #ià
	`defšed
(
__GNUC_VA_LIST_COMPATIBILITY
è&& !defšed(
__GNUC_VA_LIST
) \

129 && !
	$defšed
(
__NO_GNUC_VA_LIST
)

130 
	#__GNUC_VA_LIST


	)

131 
__va_li¡
 
	t__gnuc_va_li¡
;

	@/usr/include/stdint.h

29 #iâdeà
_SYS_STDINT_H_


30 
	#_SYS_STDINT_H_


	)

32 
	~<sys/cdefs.h
>

33 
	~<sys/_ty³s.h
>

35 
	~<machše/_¡dšt.h
>

37 #iâdeà
_INT8_T_DECLARED


38 
__št8_t
 
	tšt8_t
;

39 
	#_INT8_T_DECLARED


	)

42 #iâdeà
_INT16_T_DECLARED


43 
__št16_t
 
	tšt16_t
;

44 
	#_INT16_T_DECLARED


	)

47 #iâdeà
_INT32_T_DECLARED


48 
__št32_t
 
	tšt32_t
;

49 
	#_INT32_T_DECLARED


	)

52 #iâdeà
_INT64_T_DECLARED


53 
__št64_t
 
	tšt64_t
;

54 
	#_INT64_T_DECLARED


	)

57 #iâdeà
_UINT8_T_DECLARED


58 
__ušt8_t
 
	tušt8_t
;

59 
	#_UINT8_T_DECLARED


	)

62 #iâdeà
_UINT16_T_DECLARED


63 
__ušt16_t
 
	tušt16_t
;

64 
	#_UINT16_T_DECLARED


	)

67 #iâdeà
_UINT32_T_DECLARED


68 
__ušt32_t
 
	tušt32_t
;

69 
	#_UINT32_T_DECLARED


	)

72 #iâdeà
_UINT64_T_DECLARED


73 
__ušt64_t
 
	tušt64_t
;

74 
	#_UINT64_T_DECLARED


	)

77 
__št_Ëa¡8_t
 
	tšt_Ëa¡8_t
;

78 
__št_Ëa¡16_t
 
	tšt_Ëa¡16_t
;

79 
__št_Ëa¡32_t
 
	tšt_Ëa¡32_t
;

80 
__št_Ëa¡64_t
 
	tšt_Ëa¡64_t
;

82 
__ušt_Ëa¡8_t
 
	tušt_Ëa¡8_t
;

83 
__ušt_Ëa¡16_t
 
	tušt_Ëa¡16_t
;

84 
__ušt_Ëa¡32_t
 
	tušt_Ëa¡32_t
;

85 
__ušt_Ëa¡64_t
 
	tušt_Ëa¡64_t
;

87 
__št_ç¡8_t
 
	tšt_ç¡8_t
;

88 
__št_ç¡16_t
 
	tšt_ç¡16_t
;

89 
__št_ç¡32_t
 
	tšt_ç¡32_t
;

90 
__št_ç¡64_t
 
	tšt_ç¡64_t
;

92 
__ušt_ç¡8_t
 
	tušt_ç¡8_t
;

93 
__ušt_ç¡16_t
 
	tušt_ç¡16_t
;

94 
__ušt_ç¡32_t
 
	tušt_ç¡32_t
;

95 
__ušt_ç¡64_t
 
	tušt_ç¡64_t
;

97 
__štmax_t
 
	tštmax_t
;

98 
__uštmax_t
 
	tuštmax_t
;

100 #iâdeà
_INTPTR_T_DECLARED


101 
__šŒ_t
 
	tšŒ_t
;

102 
__ušŒ_t
 
	tušŒ_t
;

103 
	#_INTPTR_T_DECLARED


	)

	@/usr/include/sys/_sigset.h

38 #iâdeà
_SYS__SIGSET_H_


39 
	#_SYS__SIGSET_H_


	)

44 
	#_SIG_WORDS
 4

	)

45 
	#_SIG_MAXSIG
 128

	)

46 
	#_SIG_IDX
(
sig
è((sigè- 1)

	)

47 
	#_SIG_WORD
(
sig
è(
	`_SIG_IDX
(sigè>> 5)

	)

48 
	#_SIG_BIT
(
sig
è(1 << (
	`_SIG_IDX
(sigè& 31))

	)

49 
	#_SIG_VALID
(
sig
è((sigè<ğ
_SIG_MAXSIG
 && (sigè> 0)

	)

51 
	s__sig£t
 {

52 
__ušt32_t
 
	m__b™s
[
_SIG_WORDS
];

53 } 
	t__sig£t_t
;

55 #ià
defšed
(
_KERNEL
è&& defšed(
COMPAT_43
)

56 
	tosig£t_t
;

	@/usr/include/machine/_stdint.h

40 #iâdeà
_MACHINE__STDINT_H_


41 
	#_MACHINE__STDINT_H_


	)

43 #ià!
defšed
(
__ılu¥lus
è|| defšed(
__STDC_CONSTANT_MACROS
)

45 
	#INT8_C
(
c
è(c)

	)

46 
	#INT16_C
(
c
è(c)

	)

47 
	#INT32_C
(
c
è(c)

	)

48 
	#INT64_C
(
c
è(ø## 
LL
)

	)

50 
	#UINT8_C
(
c
è(c)

	)

51 
	#UINT16_C
(
c
è(c)

	)

52 
	#UINT32_C
(
c
è(ø## 
U
)

	)

53 
	#UINT64_C
(
c
è(ø## 
ULL
)

	)

55 
	#INTMAX_C
(
c
è(ø## 
LL
)

	)

56 
	#UINTMAX_C
(
c
è(ø## 
ULL
)

	)

60 #ià!
defšed
(
__ılu¥lus
è|| defšed(
__STDC_LIMIT_MACROS
)

67 
	#INT8_MIN
 (-0x7f-1)

	)

68 
	#INT16_MIN
 (-0x7fff-1)

	)

69 
	#INT32_MIN
 (-0x7fffffff-1)

	)

70 
	#INT64_MIN
 (-0x7fffffffffffffffLL-1)

	)

73 
	#INT8_MAX
 0x7f

	)

74 
	#INT16_MAX
 0x7fff

	)

75 
	#INT32_MAX
 0x7fffffff

	)

76 
	#INT64_MAX
 0x7fffffffffffffffLL

	)

79 
	#UINT8_MAX
 0xff

	)

80 
	#UINT16_MAX
 0xffff

	)

81 
	#UINT32_MAX
 0xffffffffU

	)

82 
	#UINT64_MAX
 0xffffffffffffffffULL

	)

89 
	#INT_LEAST8_MIN
 
INT8_MIN


	)

90 
	#INT_LEAST16_MIN
 
INT16_MIN


	)

91 
	#INT_LEAST32_MIN
 
INT32_MIN


	)

92 
	#INT_LEAST64_MIN
 
INT64_MIN


	)

95 
	#INT_LEAST8_MAX
 
INT8_MAX


	)

96 
	#INT_LEAST16_MAX
 
INT16_MAX


	)

97 
	#INT_LEAST32_MAX
 
INT32_MAX


	)

98 
	#INT_LEAST64_MAX
 
INT64_MAX


	)

101 
	#UINT_LEAST8_MAX
 
UINT8_MAX


	)

102 
	#UINT_LEAST16_MAX
 
UINT16_MAX


	)

103 
	#UINT_LEAST32_MAX
 
UINT32_MAX


	)

104 
	#UINT_LEAST64_MAX
 
UINT64_MAX


	)

111 
	#INT_FAST8_MIN
 
INT32_MIN


	)

112 
	#INT_FAST16_MIN
 
INT32_MIN


	)

113 
	#INT_FAST32_MIN
 
INT32_MIN


	)

114 
	#INT_FAST64_MIN
 
INT64_MIN


	)

117 
	#INT_FAST8_MAX
 
INT32_MAX


	)

118 
	#INT_FAST16_MAX
 
INT32_MAX


	)

119 
	#INT_FAST32_MAX
 
INT32_MAX


	)

120 
	#INT_FAST64_MAX
 
INT64_MAX


	)

123 
	#UINT_FAST8_MAX
 
UINT32_MAX


	)

124 
	#UINT_FAST16_MAX
 
UINT32_MAX


	)

125 
	#UINT_FAST32_MAX
 
UINT32_MAX


	)

126 
	#UINT_FAST64_MAX
 
UINT64_MAX


	)

132 
	#INTPTR_MIN
 
INT32_MIN


	)

133 
	#INTPTR_MAX
 
INT32_MAX


	)

134 
	#UINTPTR_MAX
 
UINT32_MAX


	)

140 
	#INTMAX_MIN
 
INT64_MIN


	)

141 
	#INTMAX_MAX
 
INT64_MAX


	)

142 
	#UINTMAX_MAX
 
UINT64_MAX


	)

149 
	#PTRDIFF_MIN
 
INT32_MIN


	)

150 
	#PTRDIFF_MAX
 
INT32_MAX


	)

153 
	#SIG_ATOMIC_MIN
 
INT32_MIN


	)

154 
	#SIG_ATOMIC_MAX
 
INT32_MAX


	)

157 
	#SIZE_MAX
 
UINT32_MAX


	)

159 #iâdeà
WCHAR_MIN


161 
	#WCHAR_MIN
 
INT32_MIN


	)

162 
	#WCHAR_MAX
 
INT32_MAX


	)

166 
	#WINT_MIN
 
INT32_MIN


	)

167 
	#WINT_MAX
 
INT32_MAX


	)

	@
1
.
1
/usr/include
60
1088
asap.c
asap.h
backend.c
backend.h
callbacks.c
callbacks.h
cblib.c
cblib.h
checksum.c
checksum.h
debug.c
debug.h
enrp.c
enrp.h
main.c
main.h
parameters.c
parameters.h
policy.c
policy.h
poolelement.c
poolelement.h
registrarserver.c
registrarserver.h
serverpool.c
serverpool.h
takeover.c
takeover.h
util.c
util.h
/usr/include/arpa/inet.h
/usr/include/assert.h
/usr/include/netinet/in.h
/usr/include/netinet/sctp.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/strings.h
/usr/include/sys/socket.h
/usr/include/sys/time.h
/usr/include/sys/types.h
/usr/include/unistd.h
/usr/include/machine/endian.h
/usr/include/machine/param.h
/usr/include/netinet/sctp_uio.h
/usr/include/netinet6/in6.h
/usr/include/sys/_iovec.h
/usr/include/sys/_null.h
/usr/include/sys/_pthreadtypes.h
/usr/include/sys/_timeval.h
/usr/include/sys/_types.h
/usr/include/sys/cdefs.h
/usr/include/sys/select.h
/usr/include/sys/timespec.h
/usr/include/sys/unistd.h
/usr/include/time.h
/usr/include/machine/_types.h
/usr/include/stdint.h
/usr/include/sys/_sigset.h
/usr/include/machine/_stdint.h
